(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{265:function(e,t,a){},326:function(e,t,a){e.exports=a(456)},331:function(e,t,a){},456:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(22),o=a.n(i),l=(a(331),a(19)),c=a.n(l),s=a(29),m=a(8),u=a(295),d=a(31),p=a(296),g=a(556),f=a(557),h=a(18),E=a(566),b=a(517),v=a(571);var y=function(e){var t=r.a.useState(""),a=Object(m.a)(t,2),n=a[0],i=a[1],o=r.a.useState(""),l=Object(m.a)(o,2),c=l[0],s=l[1],u=r.a.useState(!1),d=Object(m.a)(u,2),p=d[0],g=d[1];return r.a.useEffect((function(){if(e.config["network.topology"]){var t;(t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_TactileButtonNotification"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_TactileButtonNotification"+Math.random())).connect({onSuccess:function(){t.subscribe(["pioreactor","+","$experiment","monitor","button_down"].join("/"),{qos:1})},timeout:180,reconnect:!0}),t.onMessageArrived=function(t){if("1"===t.payloadString){var a=t.topic.split("/")[1];i(a);try{s(e.config["ui.rename"][a])}catch(n){}g(!0)}else g(!1)}}}),[e.config]),r.a.createElement(v.a,{open:p,autoHideDuration:null,onClose:function(){},anchorOrigin:{vertical:"bottom",horizontal:"center"},key:"button-tactile-snackbar",transitionDuration:{enter:10}},r.a.createElement(E.a,{severity:"info",variant:"filled",icon:!1},r.a.createElement(b.a,{style:{fontSize:25}},n+(c?" / "+c:"")),"Holding ",r.a.createElement("b",null,n),"'s button down"))},x=a(535),w=a(526),C=a(12),O=a(68),S=a(69),j=a(42),_=a(72),k=a(71),N=a(3),T=a(46),D=a.n(T),A=a(458),P=a(518),L=a(519),B=a(75),F=a(560),M=a(521),z=a(525),R=a(524),I=a(520),W=a(522),U=a(523),H={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4,CRITICAL:5},Y=function(e){Object(_.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(O.a)(this,a),(n=t.call(this,e)).state={listOfLogs:[]},n.onConnect=n.onConnect.bind(Object(j.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(j.a)(n)),n}return Object(S.a)(a,[{key:"getData",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.experiment){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("/recent_logs/"+encodeURIComponent(this.props.experiment)+"?"+new URLSearchParams({min_level:this.props.config.logging.ui_log_level})).then((function(e){return e.json()})).then((function(e){t.setState({listOfLogs:e})})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getData(),this.props.config.remote&&this.props.config.remote.ws_url?this.client=new h.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_LogTable"+Math.random()):this.client=new h.Client("".concat(this.props.config["network.topology"].leader_address),9001,"webui_LogTable"+Math.random()),this.client.connect({timeout:180,onSuccess:this.onConnect,reconnect:!0}),this.client.onMessageArrived=this.onMessageArrived}},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getData()}},{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,"logs","+"].join("/"))}},{key:"onMessageArrived",value:function(e){this.state.listOfLogs.length>50&&this.state.listOfLogs.pop();var t=e.topic.split("/")[1],a=JSON.parse(e.payloadString);H[a.level]<H[this.props.config.logging.ui_log_level]||(this.state.listOfLogs.unshift({timestamp:D.a.utc().format("YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]"),pioreactor_unit:t,message:a.message,task:a.task,is_error:"ERROR"===a.level,is_warning:"WARNING"===a.level}),this.setState({listOfLogs:this.state.listOfLogs}))}},{key:"renameUnit",value:function(e){return this.props.config["ui.rename"]&&this.props.config["ui.rename"][e]||e}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(P.a,null,r.a.createElement(L.a,null,r.a.createElement(B.a,{variant:"h6",component:"h2"},r.a.createElement(F.a,{fontWeight:"fontWeightRegular"},"Event Logs")),r.a.createElement(I.a,{style:{height:"700px",width:"100%",overflowY:"scroll"}},r.a.createElement(M.a,{stickyHeader:!0,size:"small","aria-label":"log table"},r.a.createElement(W.a,null,r.a.createElement(U.a,null,r.a.createElement(R.a,{className:Object(N.a)(t.headerCell)},"Timestamp"),r.a.createElement(R.a,{className:Object(N.a)(t.headerCell)},"Message"),r.a.createElement(R.a,{className:Object(N.a)(t.headerCell)},"Pioreactor"))),r.a.createElement(z.a,null,this.state.listOfLogs.map((function(a,n){var i,o,l;return r.a.createElement(U.a,{key:n},r.a.createElement(R.a,{className:Object(N.a)(t.tightCell,t.smallText,(i={},Object(C.a)(i,t.errorLog,a.is_error),Object(C.a)(i,t.warningLog,a.is_warning),i))},r.a.createElement("span",{title:D.a.utc(a.timestamp,"YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("YYYY-MM-DD HH:mm:sss")},D.a.utc(a.timestamp,"YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("HH:mm:ss")," ")),r.a.createElement(R.a,{className:Object(N.a)(t.tightCell,t.smallText,(o={},Object(C.a)(o,t.errorLog,a.is_error),Object(C.a)(o,t.warningLog,a.is_warning),o))}," ","[".concat(a.task,"] ").concat(a.message)," "),r.a.createElement(R.a,{className:Object(N.a)(t.tightCell,t.smallText,(l={},Object(C.a)(l,t.errorLog,a.is_error),Object(C.a)(l,t.warningLog,a.is_warning),l))}," ",e.renameUnit(a.pioreactor_unit)))})))))))}}]),a}(r.a.Component),J=Object(A.a)((function(e){return{tightCell:{padding:"8px 2px 6px 4px",fontSize:13},smallText:{fontSize:12},headerCell:{backgroundColor:"white",padding:"8px 6px 6px 6px"},tightRight:{textAlign:"right"},errorLog:{backgroundColor:"#ff7961"},warningLog:{backgroundColor:"#FFEA8A"}}}))(Y),V=a(300),$=a(533),q=a(269),G=a.n(q),K=a(271),Z=a.n(K),Q=a(272),X=a.n(Q),ee=a(270),te=a.n(ee),ae=a(172),ne=a.n(ae),re=a(170),ie=a.n(re),oe=a(529),le=a(527),ce=a(530),se=a(532),me=a(531),ue=Object(V.a)({title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"}}),de=function(e){Object(_.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(O.a)(this,a),(n=t.call(this,e)).handleChange=function(e){return n.setState({desc:e.target.value}),fetch("update_experiment_desc",{method:"POST",body:JSON.stringify({experiment:n.props.experiment,description:e.target.value}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){200!==e.status&&console.log("didn't save")}))},n.render=function(){return r.a.createElement("div",{style:{padding:"0px 5px 0px 5px"}},r.a.createElement(F.a,{fontWeight:"fontWeightBold"},"Description:"),r.a.createElement(G.a,{innerRef:n.contentEditable,html:n.state.desc,disabled:!1,onChange:n.handleChange,onBlur:n.onBlur,tagName:"p",style:{padding:"3px 3px 3px 2px",outline:"none"}}))},n.contentEditable=r.a.createRef(),n.state={desc:""},n}return Object(S.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.description!==e.description&&this.setState({desc:this.props.description})}}]),a}(r.a.Component);function pe(){var e=ue(),t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=function(){i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},color:"primary",onClick:function(){i(!0)}},r.a.createElement(ie.a,{className:e.textIcon})," New experiment"),r.a.createElement(le.a,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(oe.a,{id:"alert-dialog-title"},"Starting a new experiment"),r.a.createElement(ce.a,null,r.a.createElement(me.a,{id:"alert-dialog-description"},"Starting a new experiment will stop data collection for the current experiment. Do you wish to proceed?")),r.a.createElement(se.a,null,r.a.createElement(w.a,{href:"/start-new-experiment",color:"primary"},"Confirm"),r.a.createElement(w.a,{onClick:o,color:"secondary",autoFocus:!0},"Cancel"))))}function ge(){var e=ue(),t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=function(){i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},color:"primary",onClick:function(){i(!0)}},r.a.createElement(ne.a,{className:e.textIcon})," End experiment"),r.a.createElement(le.a,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(oe.a,{id:"alert-dialog-title"},"End experiment?"),r.a.createElement(ce.a,null,r.a.createElement(me.a,{id:"alert-dialog-description"},"This will halt all activies (stirring, dosing, optical density reading, etc.) in all Pioreactor units. You can manually start them again later. Do you wish to end the experiment?")),r.a.createElement(se.a,null,r.a.createElement(w.a,{onClick:function(){fetch("/stop_all",{method:"POST"}),o()},color:"primary"},"Confirm"),r.a.createElement(w.a,{onClick:o,color:"secondary",autoFocus:!0},"Cancel"))))}var fe=function(e){var t=ue(),a=e.experimentMetadata.experiment||"",n=e.experimentMetadata.timestamp||D()(),i=e.experimentMetadata.description||"",o=e.experimentMetadata.delta_hours||0;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement(B.a,{variant:"h5",component:"h1"},r.a.createElement(F.a,{fontWeight:"fontWeightBold"},a)),r.a.createElement("div",null,r.a.createElement(w.a,{href:"/export-data",style:{textTransform:"none",marginRight:"0px",float:"right"},color:"primary"},r.a.createElement(te.a,{className:t.textIcon})," Export experiment data"),r.a.createElement(ge,null),r.a.createElement(pe,null))),r.a.createElement($.a,null),r.a.createElement(B.a,{variant:"subtitle2"},r.a.createElement(F.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(Z.a,{style:{fontSize:12,verticalAlign:"middle"}})," Experiment started:"),r.a.createElement(F.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},r.a.createElement("span",{title:D()(n).format("YYYY-MM-DD HH:mm:ss")},D()(n).format("dddd, MMMM D, YYYY"))),r.a.createElement(F.a,{fontWeight:"fontWeightBold",style:{display:"inline-block",margin:"10px 2px 10px 0px"}},r.a.createElement(X.a,{style:{fontSize:12,verticalAlign:"middle"}}),"Time elapsed:"),r.a.createElement(F.a,{fontWeight:"fontWeightRegular",style:{display:"inline-block"}},o,"h"))),r.a.createElement(P.a,{className:t.root},r.a.createElement(P.a,{className:t.cardContent},r.a.createElement(de,{experiment:a,description:i}))))},he=a(98),Ee=a(26),be=a(273),ve=a(558),ye=a(561),xe=a(565),we=a(575),Ce=a(584),Oe=a(574),Se=a(586),je=a(568),_e=[{primary:"#9C6ADE",0:"#9C6ADE",1:"#E3D0FF",2:"#50248F",3:"#ecdffb"},{primary:"#F49342",0:"#F49342",1:"#FFC58B",2:"#C05717",3:"#4A1504"},{primary:"#47C1BF",0:"#47C1BF",1:"#B7ECEC",2:"#00848E",3:"#003135"},{primary:"#50B83C",0:"#50B83C",1:"#BBE5B3",2:"#108043",3:"#E3F1DF"},{primary:"#DE3618",0:"#DE3618",1:"#FEAD9A",2:"#BF0711",3:"#FBEAE5"},{primary:"#EEC200",0:"#EEC200",1:"#FFEA8A",2:"#8A6116",3:"#573B00"},{primary:"#006FBB",0:"#006FBB",1:"#B4E1FA",2:"#084E8A",3:"#001429"},{primary:"#43467F",0:"#43467F",1:"#B3B5CB",2:"#1C2260",3:"#00044C"}],ke={};function Ne(e){if(e in ke)return ke[e];var t=/(.*)-[0123]/;if(t.test(e))return Ne(e.match(t)[1]);var a=_e.shift();return ke[e]=a.primary,ke[e+"-0"]=a[0],ke[e+"-1"]=a[1],ke[e+"-2"]=a[2],ke[e+"-3"]=a[3],Ne(e)}var Te=function(e){Object(_.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(O.a)(this,a),(n=t.call(this,e)).createToolTip=function(e){return"".concat(e.datum.x.format("MMM DD HH:mm"),"\n").concat(n.renameAndFormatSeries(e.datum.childName),": ").concat(Math.round(1e3*e.datum.y)/1e3)},n.state={seriesMap:{},hiddenSeries:new Set,names:[],legendEvents:[],fetched:!1},n.onConnect=n.onConnect.bind(Object(j.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(j.a)(n)),n.selectLegendData=n.selectLegendData.bind(Object(j.a)(n)),n.selectVictoryLines=n.selectVictoryLines.bind(Object(j.a)(n)),n}return Object(S.a)(a,[{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,this.props.topic].join("/"))}},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getData()}},{key:"componentDidMount",value:function(){this.getData(),this.props.config.remote&&this.props.config.remote.ws_url?this.client=new h.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_Chart"+Math.random()):this.client=new h.Client("".concat(this.props.config["network.topology"].leader_address),9001,"webui_Chart"+Math.random()),this.client.connect({onSuccess:this.onConnect,reconnect:!0}),this.client.onMessageArrived=this.onMessageArrived}},{key:"getData",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.experiment){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("/time_series/"+this.props.dataSource+"/"+this.props.experiment+"?"+new URLSearchParams({filter_mod_N:Math.max(Math.floor(1.25*Math.min(this.props.deltaHours,this.props.lookback)),1),lookback:this.props.lookback})).then((function(e){return e.json()})).then((function(e){var a,n={},r=Object(be.a)(e.series.entries());try{for(r.s();!(a=r.n()).done;){var i=Object(m.a)(a.value,2),o=i[0],l=i[1];e.data[o].length>0&&(n[l]={data:e.data[o].map((function(e){return{y:e.y,x:D.a.utc(e.x,"YYYY-MM-DDTHH:mm:ss.SSSSS").local()}})),name:l,color:Ne(l)})}}catch(s){r.e(s)}finally{r.f()}var c=Object.keys(n);t.setState({seriesMap:n,legendEvents:t.createLegendEvents(c),names:c,fetched:!0})})).catch((function(e){console.log(e),t.setState({fetched:!0})}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createLegendEvents",value:function(e){var t=this;return e.map((function(e,a){return{childName:["legend"],target:"data",eventKey:String(a),eventHandlers:{onClick:function(){return[{childName:["line-"+e],target:"data",mutation:function(){return t.state.hiddenSeries.delete(e)||t.state.hiddenSeries.add(e),t.setState({hiddenSeries:new Set(t.state.hiddenSeries)}),null}}]}}}}))}},{key:"onMessageArrived",value:function(e){if(this.state.fetched&&!e.retained&&e.payloadString){var t=D()().local(),a=this.props.isODReading?e.topic.split("/")[1]+"-"+e.topic.split("/")[5]:e.topic.split("/")[1];try{if(a in this.state.seriesMap)this.state.seriesMap[a].data.push({x:t,y:parseFloat(e.payloadString)}),this.setState({seriesMap:this.state.seriesMap});else{var n=Object(Ee.a)(Object(Ee.a)({},this.state.seriesMap),{},Object(C.a)({},a,{data:[{x:t,y:parseFloat(e.payloadString)}],name:a,color:Ne(a)}));this.setState({seriesMap:n}),this.setState({names:[].concat(Object(he.a)(this.state.names),[a])})}}catch(r){console.log(r)}}}},{key:"breakString",value:function(e){return e.length>11?e.slice(0,5)+"..."+e.slice(e.length-2,e.length):e}},{key:"renameAndFormatSeries",value:function(e){if(!this.props.config["ui.rename"])return e;if(e.match(/(.*)-([0123])/g)){var t=e.match(/(.*)-([0123])/),a=t[1],n=t[2];return this.breakString(this.props.config["ui.rename"][a]||a)+"-"+n}return this.breakString(this.props.config["ui.rename"][e]||e)}},{key:"filterDataPoints",value:function(e){return function(t,a){return e<600||(0===a||a===e-1||a%Math.round(e/600)===0)}}},{key:"selectLegendData",value:function(e){if(!this.state.seriesMap)return{};var t=this.state.seriesMap[e],a={name:this.renameAndFormatSeries(t.name),symbol:{fill:t.color}};return this.state.hiddenSeries.has(e)?Object(Ee.a)(Object(Ee.a)({},a),{},{symbol:{fill:"white"}}):a}},{key:"selectVictoryLines",value:function(e){if(!this.state.hiddenSeries.has(e))return r.a.createElement(ve.a,{interpolation:this.props.interpolation,key:"line-"+e+this.props.title,name:e,style:{labels:{fill:this.state.seriesMap[e].color},data:{stroke:this.state.seriesMap[e].color,strokeWidth:2},parent:{border:"1px solid #ccc"}},data:this.state.seriesMap[e].data,x:"x",y:"y"})}},{key:"render",value:function(){var e=Object(ye.a)("voronoi");return r.a.createElement(P.a,{style:{maxHeight:"100%"}},r.a.createElement(xe.a,{title:this.props.title,domainPadding:10,padding:{left:70,right:50,bottom:80,top:50},events:this.state.legendEvents,responsive:!0,width:600,height:315,scale:{x:"time"},theme:we.a.material,containerComponent:r.a.createElement(e,{voronoiBlacklist:["parent"],labels:this.createToolTip,labelComponent:r.a.createElement(Ce.a,{cornerRadius:0,flyoutStyle:{fill:"white",stroke:"#90a4ae",strokeWidth:1.5}})})},r.a.createElement(Oe.a,{text:this.props.title,x:300,y:30,textAnchor:"middle",style:{fontSize:16,fontFamily:"inherit"}}),r.a.createElement(Se.a,{style:{tickLabels:{fontSize:14,padding:5,fontFamily:"inherit"}},offsetY:80,orientation:"bottom"}),r.a.createElement(Se.a,{crossAxis:!1,dependentAxis:!0,domain:this.props.yAxisDomain,tickFormat:this.props.yAxisTickFormat,label:this.props.yAxisLabel,axisLabelComponent:r.a.createElement(Oe.a,{dy:-40,style:{fontSize:15,padding:10,fontFamily:"inherit"}}),style:{tickLabels:{fontSize:14,padding:5,fontFamily:"inherit"}}}),r.a.createElement(je.a,{x:65,y:270,symbolSpacer:6,itemsPerRow:5,name:"legend",borderPadding:{right:8},orientation:"horizontal",cursor:"pointer",gutter:15,rowGutter:5,style:{labels:{fontSize:13},data:{stroke:"#485157",strokeWidth:.5,size:6.5}},data:this.state.names.map(this.selectLegendData)}),Object.keys(this.state.seriesMap).map(this.selectVictoryLines)))}}]),a}(r.a.Component),De=a(168);var Ae=function(e){return r.a.createElement(De.a,e,r.a.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:e.fillColor||"none",fillRule:"evenodd"},r.a.createElement("g",{id:"Experiment-Page-1",transform:"translate(-728.000000, -1502.000000)",stroke:"currentColor",strokeWidth:"1.8"},r.a.createElement("g",{id:"pioreactor",transform:"translate(729.000000, 1503.000000)"},r.a.createElement("path",{d:"M1.4,18.9 L1.4,14.7 L0,14.7 L0,11.2 L2.799,11.2 L2.8,0 L14,0 L13.999,11.2 L16.8,11.2 L16.8,14.7 L15.399,14.7 L15.4,18.9 L1.4,18.9 Z",id:"Combined-Shape"}),r.a.createElement("circle",{id:"Oval",cx:"8.4",cy:"13.3",r:"2.1"})))))},Pe=function(e){Object(_.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(O.a)(this,a),(n=t.call(this,e)).state={mediaThroughputPerUnit:{},altMediaThroughputPerUnit:{},mediaThroughput:0,altMediaThroughput:0,rates:{all:{mediaRate:0,altMediaRate:0}},activeUnits:[]},n.onConnect=n.onConnect.bind(Object(j.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(j.a)(n)),n}return Object(S.a)(a,[{key:"getRecentRates",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.experiment){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("/recent_media_rates/"+encodeURIComponent(this.props.experiment)).then((function(e){return e.json()})).then((function(e){t.setState((function(t){return Object(Ee.a)(Object(Ee.a)({},t),{},{rates:e})}))}));case 4:return e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getRecentRates()}},{key:"componentDidMount",value:function(){this.props.config.remote&&this.props.config.remote.ws_url?this.client=new h.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_MediaCard"+Math.random()):this.client=new h.Client("".concat(this.props.config["network.topology"].leader_address),9001,"webui_MediaCard"+Math.random()),this.client.connect({timeout:180,onSuccess:this.onConnect}),this.client.onMessageArrived=this.onMessageArrived,this.setState({activeUnits:Object.entries(this.props.config["network.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]}))}),this.getRecentRates()}},{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,"throughput_calculating","alt_media_throughput"].join("/")),this.client.subscribe(["pioreactor","+",this.props.experiment,"throughput_calculating","media_throughput"].join("/"))}},{key:"addOrUpdate",value:function(e,t,a){return Object.hasOwnProperty(e)?t[e]=a+t[e]:t[e]=a,t}},{key:"onMessageArrived",value:function(e){var t=e.destinationName.split("/"),a=parseFloat(e.payloadString),n=t[1],r="alt_media_throughput"===t.slice(-1)[0]?"altMediaThroughputPerUnit":"mediaThroughputPerUnit",i="alt_media_throughput"===t.slice(-1)[0]?"altMediaThroughput":"mediaThroughput";this.setState(Object(C.a)({},r,this.addOrUpdate(n,this.state[r],a)));var o=Object.values(this.state[r]).reduce((function(e,t){return e+t}),0);this.setState(Object(C.a)({},i,o))}},{key:"render",value:function(){var e=this;return r.a.createElement(P.a,null,r.a.createElement(L.a,null,r.a.createElement(B.a,{variant:"h6",component:"h2"},r.a.createElement(F.a,{fontWeight:"fontWeightRegular"},"Dosing")),r.a.createElement(I.a,{style:{width:"100%"}},r.a.createElement(M.a,{size:"small","aria-label":"media throughput"},r.a.createElement(W.a,null,r.a.createElement(U.a,null,r.a.createElement(R.a,{style:{padding:"6px 0px"}}),r.a.createElement(R.a,{style:{padding:"6px 0px"},align:"right"},"Media"),r.a.createElement(R.a,{style:{padding:"6px 0px"},align:"right"},"Alt. Media"))),r.a.createElement(z.a,null,r.a.createElement(U.a,{key:"all"},r.a.createElement(R.a,{style:{padding:"6px 0px"},component:"th",scope:"row"},"All Pioreactors"),r.a.createElement(R.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},this.state.mediaThroughput.toFixed(1),"mL (~",this.state.rates.all.mediaRate.toFixed(1),"mL/h)"),r.a.createElement(R.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},this.state.altMediaThroughput.toFixed(1),"mL (~",this.state.rates.all.altMediaRate.toFixed(1),"mL/h)")),this.state.activeUnits.map((function(t){return r.a.createElement(U.a,{key:t},r.a.createElement(R.a,{style:{padding:"6px 0px"},component:"th",scope:"row"},r.a.createElement(Ae,{style:{fontSize:14,verticalAlign:"middle"},color:"inherit"})," ",r.a.createElement("span",{className:"underlineSpan",title:t},e.props.config["ui.rename"]&&e.props.config["ui.rename"][t]?e.props.config["ui.rename"][t]:t)),r.a.createElement(R.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},(e.state.mediaThroughputPerUnit[t]||0).toFixed(1),"mL (~",e.state.rates[t]?e.state.rates[t].mediaRate.toFixed(1):"0.0","mL/h)"),r.a.createElement(R.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},(e.state.altMediaThroughputPerUnit[t]||0).toFixed(1),"mL (~",e.state.rates[t]?e.state.rates[t].altMediaRate.toFixed(1):"0.0","mL/h)"))})))))))}}]),a}(r.a.Component),Le=Object(A.a)((function(e){return{tightCell:{padding:"8px 2px 6px 4px",fontSize:13},smallText:{fontSize:12},headerCell:{backgroundColor:"white",padding:"8px 6px 6px 6px"},tightRight:{textAlign:"right"}}}))(Pe);var Be=function(e){var t=r.a.useState({}),a=Object(m.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){function t(){return(t=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){i(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}document.title=e.title,function(){t.apply(this,arguments)}()}),[e.title]),r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{container:!0,spacing:2,justify:"space-between"},r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(fe,{experimentMetadata:n})),r.a.createElement(x.a,{item:!0,xs:12,md:7,container:!0,spacing:2,justify:"flex-start",style:{height:"100%"}},e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].implied_growth_rate&&r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,dataSource:"growth_rates",title:"Implied growth rate",topic:"growth_rate",yAxisLabel:"Growth rate, h\u207b\xb9",experiment:n.experiment,deltaHours:n.delta_hours,interpolation:"stepAfter",yAxisDomain:[-.02,.1],lookback:1e5,yAxisTickFormat:function(e){return"".concat(e.toFixed(2))}})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].fraction_of_volume_that_is_alternative_media&&r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,yAxisDomain:[0,.05],dataSource:"alt_media_fraction",interpolation:"stepAfter",title:"Fraction of volume that is alternative media",topic:"alt_media_calculating/alt_media_fraction",yAxisLabel:"Fraction",experiment:n.experiment,deltaHours:1,yAxisTickFormat:function(e){return"".concat(e.toFixed(3))},lookback:1e5})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].normalized_optical_density&&r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,isODReading:!0,dataSource:"od_readings_filtered",title:"Normalized optical density",topic:"od_filtered/+/+",yAxisLabel:"Current OD / initial OD",experiment:n.experiment,deltaHours:n.delta_hours,interpolation:"stepAfter",lookback:parseInt(e.config["ui.overview.settings"].filtered_od_lookback_hours),yAxisTickFormat:function(e){return"".concat(e.toFixed(2))}})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].raw_optical_density&&r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,isODReading:!0,dataSource:"od_readings_raw",title:"Optical density",topic:"od_raw/+/+",yAxisLabel:"Voltage",experiment:n.experiment,deltaHours:n.delta_hours,interpolation:"stepAfter",lookback:parseInt(e.config["ui.overview.settings"].raw_od_lookback_hours),yAxisTickFormat:function(e){return"".concat(e.toFixed(4))}})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].temperature&&r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,dataSource:"temperature_readings",title:"Temperature of vials",topic:"temperature_control/temperature",yAxisLabel:"temperature, \u2103",experiment:n.experiment,interpolation:"stepAfter",lookback:1e4,yAxisDomain:[10,50],deltaHours:n.delta_hours,yAxisTickFormat:function(e){return"".concat(e.toFixed(1))}}))),r.a.createElement(x.a,{item:!0,xs:12,md:5,container:!0,spacing:2,justify:"flex-end",style:{height:"100%"}},e.config["ui.overview.cards"]&&"1"===e.config["ui.overview.cards"].dosings&&r.a.createElement(x.a,{item:!0,xs:12,style:{padding:"10px 0px"}},r.a.createElement(Le,{experiment:n.experiment,config:e.config}),r.a.createElement(w.a,{href:"/pioreactors",color:"primary",style:{textTransform:"none",verticalAlign:"middle",margin:"0px 3px"}}," ",r.a.createElement(Ae,{style:{fontSize:17},color:"primary"})," See all Pioreactor details ")),e.config["ui.overview.cards"]&&"1"===e.config["ui.overview.cards"].event_logs&&r.a.createElement(x.a,{item:!0,xs:12,style:{padding:"10px 0px"}},r.a.createElement(J,{experiment:n.experiment,config:e.config})))),e.config["ui.rename"]?r.a.createElement(y,{config:e.config}):null)},Fe=a(536),Me=a(538),ze=a(537),Re=a(542),Ie=a(543),We=a(569),Ue=a(563),He=a(544),Ye=Object(Fe.a)((function(e){return{root:{marginTop:"15px"},formControl:{margin:e.spacing(3)},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},caption:{marginLeft:"30px",maxWidth:"650px"}}}));function Je(e){var t=Ye(),a=r.a.useState([{experiment:"<All experiments>"}]),n=Object(m.a)(a,2),i=n[0],o=n[1];r.a.useEffect((function(){function t(){return(t=Object(s.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/get_experiments").then((function(e){return e.json()})).then((function(t){o((function(e){return[].concat(Object(he.a)(t),Object(he.a)(e))})),e.handleChange(t[0].experiment)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);return r.a.createElement("div",{className:t.root},r.a.createElement(ze.a,{component:"fieldset",className:t.formControl},r.a.createElement(Me.a,{component:"legend"},"Experiment"),r.a.createElement(Ue.a,{native:!0,value:e.ExperimentSelection,onChange:function(t){e.handleChange(t.target.value)},inputProps:{name:"experiment",id:"experiment"}},i.map((function(e){return r.a.createElement("option",{value:e.experiment},e.experiment+(e.timestamp?" (started ".concat(D()(e.timestamp).format("MMMM D, YYYY"),")"):""))})))))}var Ve=function(e){var t=Ye();return r.a.createElement("div",{className:t.root},r.a.createElement(ze.a,{component:"fieldset",className:t.formControl},r.a.createElement(Me.a,{component:"legend"},"Datasets"),r.a.createElement(Re.a,null,r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.growth_rates,onChange:e.handleChange,name:"growth_rates"}),label:"Implied growth rate"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of the calculated (implied) growth rate. Same data as presented in the "Implied growth rate" chart in the Experiment Overview.'),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.od_readings_raw,onChange:e.handleChange,name:"od_readings_raw"}),label:"Raw optical density"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of raw voltages provided by the senors, the inputs for growth calculations and normalized optical densities. Same data as presented in the "Raw optical density" chart in the Experiment Overview.'),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.od_readings_filtered,onChange:e.handleChange,name:"od_readings_filtered"}),label:"Normalized optical density"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of normalized optical densities. Same data as presented in the "Normalized optical density" chart in the Experiment Overview.'),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.temperature_readings,onChange:e.handleChange,name:"temperature_readings"}),label:"Temperature readings"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of temperature readings from the Pioreactors. Same data as presented in the "Temperature of vials" chart in the Experiment Overview.'),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.experiments,onChange:e.handleChange,name:"experiments"}),label:"Experiment metadata"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"The description and other metadata from the experiment."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.alt_media_fraction,onChange:e.handleChange,name:"alt_media_fraction"}),label:"Alternative media fraction"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},'A time series of how much alternative media is in each Pioreactor. Same data as presented in the "Fraction of volume that is alternative media" chart in the Experiment Overview.'),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.dosing_events,onChange:e.handleChange,name:"dosing_events"}),label:"Dosing event log"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"A detailed log table of all dosing events, including the volume exchanged, and the source of who or what triggered the event."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.dosing_automation_settings,onChange:e.handleChange,name:"dosing_automation_settings"}),label:"Dosing automation changelog"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Whenever a dosing automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the dosing automation states from this dataset."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.led_events,onChange:e.handleChange,name:"led_events"}),label:"LED event log"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"A detailed log table of all LED events, including the channel, intensity, and the source of who or what triggered the event."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.led_automation_settings,onChange:e.handleChange,name:"led_automation_settings"}),label:"LED automation changelog"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Whenever a LED automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the LED automation states from this dataset."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.temperature_automation_settings,onChange:e.handleChange,name:"temperature_automation_settings"}),label:"Temperature automation changelog"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Whenever a temperature automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the temperature automation states from this dataset."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.kalman_filter_outputs,onChange:e.handleChange,name:"kalman_filter_outputs"}),label:"Kalman Filter outputs"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},"An internal Kalman filter produces the normalized optical densities, growth rates, an acceleration term, and variances (and covariances) between the estimates."),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:e.isChecked.logs,onChange:e.handleChange,name:"logs"}),label:"Pioreactor logs"}),r.a.createElement(B.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The append-only collection of logs from all Pioreactors. A subset of the these logs are displayed in the Log Table in the Experiment Overview. These are the logs that should be provided to get assistance when troubleshooting, but choose "<All experiments>" above.'))))};function $e(){var e=Ye(),t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),l=Object(m.a)(o,2),c=l[0],s=l[1],u=r.a.useState(""),d=Object(m.a)(u,2),p=d[0],g=d[1],f=r.a.useState({experimentSelection:"",datasetCheckbox:{growth_rates:!1,dosing_events:!1,led_events:!1,experiments:!1,od_readings_raw:!1,od_readings_filtered:!1,logs:!1,alt_media_fraction:!1,dosing_automation_settings:!1,led_automation_settings:!1,temperature_automation_settings:!1,kalman_filter_outputs:!1,temperature_readings:!1}}),h=Object(m.a)(f,2),E=h[0],b=h[1];var v=n?r.a.createElement(He.a,{color:"white",size:24}):"Export",y=c?r.a.createElement(F.a,{color:"error.main"},p):"Querying large tables may take up to a minute or so.";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(B.a,{variant:"h5",component:"h1"},r.a.createElement(F.a,{fontWeight:"fontWeightBold"},"Export Experiment Data")))),r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement("form",null,r.a.createElement(x.a,{container:!0,spacing:1},r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(Je,{experimentSelection:E.experimentSelection,handleChange:function(e){b((function(t){return Object(Ee.a)(Object(Ee.a)({},t),{},{experimentSelection:e})}))}})),r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(Ve,{isChecked:E.datasetCheckbox,handleChange:function(e){b((function(t){return Object(Ee.a)(Object(Ee.a)({},t),{},{datasetCheckbox:Object(Ee.a)(Object(Ee.a)({},E.datasetCheckbox),{},Object(C.a)({},e.target.name,e.target.checked))})}))}})),r.a.createElement(x.a,{item:!0,xs:0}),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(w.a,{type:"submit",variant:"contained",color:"primary",onClick:function(e){if(e.preventDefault(),!Object.values(E.datasetCheckbox).some((function(e){return e})))return s(!0),void g("At least one dataset must be selected.");i(!0),fetch("export_datasets",{method:"POST",body:JSON.stringify(E),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=document.createElement("a"),a=e.filename.replace(/%/g,"%25");t.setAttribute("export",a),t.href="/static/exports/"+a,document.body.appendChild(t),t.click(),t.remove(),i(!1)})).catch((function(e){i(!1),s(!0),g("Server error occurred. Check logs.")}))},style:{width:"120px",marginLeft:24}},v),r.a.createElement("p",{style:{marginLeft:24}},y)),r.a.createElement(x.a,{item:!0,xs:12}))))))}var qe=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(x.a,{container:!0,spacing:2},r.a.createElement(x.a,{item:!0,md:12,xs:12},r.a.createElement($e,null)))},Ge=a(297),Ke=a(576),Ze=a(572),Qe=a(547),Xe=a(573),et=a(545),tt=a(564),at=a(546),nt=a(287),rt=a.n(nt),it=a(140),ot=a.n(it),lt=a(289),ct=a.n(lt);function st(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},a={},n=e.split(/[\r\n]+/),r=null;return n.forEach((function(e){if(!t.comment.test(e))if(t.param.test(e)){var n=e.match(t.param);r?a[r][n[1]]=n[2]:a[n[1]]=n[2]}else if(t.section.test(e)){n=e.match(t.section);a[n[1]]={},r=n[1]}else 0===e.length&&r&&(r=null)})),a}var mt=Object(V.a)((function(e){return{textFieldCompact:{marginTop:e.spacing(3),marginRight:e.spacing(2),marginBottom:e.spacing(0),width:"30ch"},formControl:{marginTop:e.spacing(2)},unitTitle:{fontSize:17,color:"rgba(0, 0, 0, 0.87)"},unitTitleDialog:{fontSize:20,color:"rgba(0, 0, 0, 0.87)"},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"}}}));function ut(e){var t=mt(),a={duration:60};Object(n.useEffect)((function(){e.updateParent(a)}),[]);return r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onChange:function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))},className:t.textFieldCompact})}function dt(e){var t=mt(),a={duration:30,volume:.75,target_od:1.5,skip_first_run:!1};Object(n.useEffect)((function(){e.updateParent(a)}),[]);var i=function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))};return r.a.createElement("div",null,r.a.createElement(Ze.a,{size:"small",id:"duration",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onChange:i,className:t.textFieldCompact,label:"Duration between events"}),r.a.createElement(Ze.a,{size:"small",id:"volume",label:"Max volume",defaultValue:a.volume,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"mL")},variant:"outlined",onChange:i,className:t.textFieldCompact}),r.a.createElement(Ze.a,{size:"small",id:"target_od",label:"Target OD",defaultValue:a.target_od,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"AU")},variant:"outlined",onChange:i,className:t.textFieldCompact}))}function pt(e){var t=mt(),a={duration:60,target_growth_rate:.1,target_od:1.5};Object(n.useEffect)((function(){e.updateParent(a)}),[]);var i=function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))};return r.a.createElement("div",null,r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onChange:i,className:t.textFieldCompact}),r.a.createElement(Ze.a,{size:"small",id:"target_od",label:"Target OD",defaultValue:a.target_od,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"AU")},variant:"outlined",onChange:i,className:t.textFieldCompact}),r.a.createElement(Ze.a,{size:"small",id:"target_growth_rate",label:"Target growth rate",defaultValue:a.target_growth_rate,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"h\u207b\xb9")},variant:"outlined",onChange:i,className:t.textFieldCompact}))}function gt(e){var t=mt(),a={duration:20,volume:.5};Object(n.useEffect)((function(){e.updateParent(a)}),[]);var i=function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))};return r.a.createElement("div",null,r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onChange:i,className:t.textFieldCompact}),r.a.createElement(Ze.a,{size:"small",id:"volume",label:"Volume",defaultValue:a.volume,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"mL")},variant:"outlined",onChange:i,className:t.textFieldCompact}))}function ft(e){var t=mt(),a={duration:.17,volume:.25,skip_first_run:!0};Object(n.useEffect)((function(){e.updateParent(a)}),[]);var i=function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))};return r.a.createElement("div",null,r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onChange:i,className:t.textFieldCompact}),r.a.createElement(Ze.a,{size:"small",id:"volume",label:"Volume",defaultValue:a.volume,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"mL")},variant:"outlined",onChange:i,className:t.textFieldCompact}))}var ht=function(e){var t=mt(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)({dosing_automation:"silent",skip_first_run:!1}),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),g=Object(m.a)(p,2),f=g[0],E=g[1],b=Object(n.useState)(null),v=Object(m.a)(b,2),y=v[0],x=v[1];Object(n.useEffect)((function(){var t;e.config["network.topology"]&&((t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ButtonChangeDosingDialog"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_ButtonChangeDosingDialog"+Math.random())).connect({timeout:180}),x(t))}),[e.config]);var C=function(e){d((function(t){return Object(Ee.a)(Object(Ee.a)({},t),e)}))};return r.a.createElement("div",null,r.a.createElement(w.a,{style:{marginTop:"10px"},size:"small",color:"primary",disabled:!e.currentDosingAutomation,onClick:function(){l(!0)}},"Change dosing automation"),r.a.createElement(le.a,{open:o,onClose:function(){l(!1)},"aria-labelledby":"form-dialog-title",PaperProps:{style:{height:"100%"}}},r.a.createElement(oe.a,null,r.a.createElement(B.a,{className:t.suptitle},r.a.createElement(Ae,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.title||(e.config["ui.rename"]&&e.config["ui.rename"][e.unit]?"".concat(e.config["ui.rename"][e.unit]," (").concat(e.unit,")"):"".concat(e.unit))),r.a.createElement(B.a,{className:t.unitTitleDialog},"Dosing automation")),r.a.createElement(ce.a,null,r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Dosing automations control when and how much media to add to the Pioreactor. The settings below can be changed later. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/Dosing-automations"},"dosing automations"),"."),r.a.createElement("form",null,r.a.createElement(ze.a,{component:"fieldset",className:t.formControl},r.a.createElement(Me.a,{component:"legend"},"Automation"),r.a.createElement(Ue.a,{native:!0,value:u.mode,onChange:function(e){d({dosing_automation:e.target.value,skip_first_run:u.skip_first_run})},style:{maxWidth:"200px"}},[{name:"Silent",key:"silent"},{name:"Chemostat",key:"chemostat"},{name:"PID Morbidostat",key:"pid_morbidostat"},{name:"PID Turbidostat",key:"pid_turbidostat"},{name:"Continuous Cycle",key:"continuous_cycle"}].map((function(e){return r.a.createElement("option",{id:e.key,value:e.key,key:"change-io"+e.key},e.name)}))),function(){switch(u.dosing_automation){case"silent":return r.a.createElement(ut,{updateParent:C});case"pid_turbidostat":return r.a.createElement(dt,{updateParent:C});case"pid_morbidostat":return r.a.createElement(pt,{updateParent:C});case"chemostat":return r.a.createElement(gt,{updateParent:C});case"continuous_cycle":return r.a.createElement(ft,{updateParent:C});default:return r.a.createElement("div",null)}}(),r.a.createElement(Ie.a,{control:r.a.createElement(We.a,{checked:u.skip_first_run,color:"primary",onChange:function(e){d(Object(Ee.a)(Object(Ee.a)({},u),{},{skip_first_run:e.target.checked}))},size:"small"}),label:"Skip first run"}),r.a.createElement(w.a,{type:"submit",variant:"contained",color:f?"default":"primary",onClick:function(t){t.preventDefault(),E(!0);var a=new h.Message(JSON.stringify(u));a.destinationName=["pioreactor",e.unit,e.experiment,"dosing_control","dosing_automation","set"].join("/"),a.qos=2;try{y.publish(a)}catch(n){console.log(n)}l(!1)},style:{width:"120px",marginTop:"20px"}},"Submit"))))))},Et=Object(V.a)((function(e){return{textFieldCompact:{marginTop:e.spacing(3),marginRight:e.spacing(2),marginBottom:e.spacing(0),width:"30ch"},formControl:{marginTop:e.spacing(2)},unitTitle:{fontSize:17,color:"rgba(0, 0, 0, 0.87)"},unitTitleDialog:{fontSize:20,color:"rgba(0, 0, 0, 0.87)"},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"}}}));function bt(e){var t=Et(),a={duration:60};Object(n.useEffect)((function(){e.updateParent(a)}),[]);return r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onChange:function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))},className:t.textFieldCompact})}var vt=function(e){var t=Et(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)({led_automation:"silent"}),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),g=Object(m.a)(p,2),f=g[0],E=g[1],b=Object(n.useState)(null),v=Object(m.a)(b,2),y=v[0],x=v[1];Object(n.useEffect)((function(){var t;e.config["network.topology"]&&((t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ButtonChangeLEDDialog"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_ButtonChangeLEDDialog"+Math.random())).connect({timeout:180}),x(t))}),[e.config]);var C=function(e){d((function(t){return Object(Ee.a)(Object(Ee.a)({},t),e)}))};return r.a.createElement("div",null,r.a.createElement(w.a,{style:{marginTop:"10px"},size:"small",color:"primary",disabled:!e.currentLEDAutomation,onClick:function(){l(!0)}},"Change LED automation"),r.a.createElement(le.a,{open:o,onClose:function(){l(!1)},"aria-labelledby":"form-dialog-title",PaperProps:{style:{height:"100%"}}},r.a.createElement(oe.a,null,r.a.createElement(B.a,{className:t.suptitle},r.a.createElement(Ae,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.title||(e.config["ui.rename"]&&e.config["ui.rename"][e.unit]?"".concat(e.config["ui.rename"][e.unit]," (").concat(e.unit,")"):"".concat(e.unit))),r.a.createElement(B.a,{className:t.unitTitleDialog},"LED automation")),r.a.createElement(ce.a,null,r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"LED automations control how and when to provide light to the Pioreactor. The settings below can be changed later. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/LED-automations"},"LED automations"),"."),r.a.createElement("form",null,r.a.createElement(ze.a,{component:"fieldset",className:t.formControl},r.a.createElement(Me.a,{component:"legend"},"automation"),r.a.createElement(Ue.a,{native:!0,value:u.mode,onChange:function(e){d({led_automation:e.target.value})},style:{maxWidth:"200px"}},[{name:"Silent",key:"silent"}].map((function(e){return r.a.createElement("option",{id:e.key,value:e.key,key:"change-io"+e.key},e.name)}))),function(){switch(u.led_automation){case"silent":return r.a.createElement(bt,{updateParent:C});default:return r.a.createElement("div",null)}}(),r.a.createElement(w.a,{type:"submit",variant:"contained",color:f?"default":"primary",onClick:function(t){t.preventDefault(),E(!0);var a=new h.Message(JSON.stringify(u));a.destinationName=["pioreactor",e.unit,e.experiment,"led_control","led_automation","set"].join("/"),a.qos=2;try{y.publish(a)}catch(n){console.log(n)}l(!1)},style:{width:"120px",marginTop:"20px"}},"Submit"))))))},yt=Object(V.a)((function(e){return{textFieldCompact:{marginTop:e.spacing(3),marginRight:e.spacing(2),marginBottom:e.spacing(0),width:"30ch"},formControl:{marginTop:e.spacing(2)},unitTitle:{fontSize:17,color:"rgba(0, 0, 0, 0.87)"},unitTitleDialog:{fontSize:20,color:"rgba(0, 0, 0, 0.87)"},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"}}}));function xt(e){var t=yt(),a={duration:10};Object(n.useEffect)((function(){e.updateParent(a)}),[]);return r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"sec")},variant:"outlined",onChange:function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))},className:t.textFieldCompact})}function wt(e){var t=yt(),a={duration:10,target_temperature:25};Object(n.useEffect)((function(){e.updateParent(a)}),[]);var i=function(t){e.updateParent(Object(C.a)({},t.target.id,t.target.value))};return r.a.createElement("div",null,r.a.createElement(Ze.a,{size:"small",id:"duration",label:"Duration between events",defaultValue:a.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"sec")},variant:"outlined",onChange:i,className:t.textFieldCompact}),r.a.createElement(Ze.a,{size:"small",id:"target_temperature",defaultValue:a.target_temperature,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"\u2103")},variant:"outlined",onChange:i,className:t.textFieldCompact,label:"Target temperature"}))}var Ct=function(e){var t=yt(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)({temperature_automation:"silent"}),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),g=Object(m.a)(p,2),f=g[0],E=g[1],b=Object(n.useState)(null),v=Object(m.a)(b,2),y=v[0],x=v[1];Object(n.useEffect)((function(){var t;e.config["network.topology"]&&((t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ButtonChangeTemperatureDialog"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_ButtonChangeTemperatureDialog"+Math.random())).connect({timeout:180}),x(t))}),[e.config]);var C=function(e){d((function(t){return Object(Ee.a)(Object(Ee.a)({},t),e)}))};return r.a.createElement("div",null,r.a.createElement(w.a,{style:{marginTop:"10px"},size:"small",color:"primary",disabled:!e.currentTemperatureAutomation,onClick:function(){l(!0)}},"Change temperature automation"),r.a.createElement(le.a,{open:o,onClose:function(){l(!1)},"aria-labelledby":"form-dialog-title",PaperProps:{style:{height:"100%"}}},r.a.createElement(oe.a,null,r.a.createElement(B.a,{className:t.suptitle},r.a.createElement(Ae,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.title||(e.config["ui.rename"]&&e.config["ui.rename"][e.unit]?"".concat(e.config["ui.rename"][e.unit]," (").concat(e.unit,")"):"".concat(e.unit))),r.a.createElement(B.a,{className:t.unitTitleDialog},"Temperature automation")),r.a.createElement(ce.a,null,r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Temperature automations control the temperature of the Pioreactor's vial. The settings below can be changed later. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/temperature-automations"},"temperature automations"),"."),r.a.createElement("form",null,r.a.createElement(ze.a,{component:"fieldset",className:t.formControl},r.a.createElement(Me.a,{component:"legend"},"automation"),r.a.createElement(Ue.a,{native:!0,value:u.mode,onChange:function(e){d({temperature_automation:e.target.value})},style:{maxWidth:"200px"}},[{name:"Silent",key:"silent"},{name:"PIDStable",key:"pid_stable"}].map((function(e){return r.a.createElement("option",{id:e.key,value:e.key,key:"change-io"+e.key},e.name)}))),function(){switch(u.temperature_automation){case"silent":return r.a.createElement(xt,{updateParent:C});case"pid_stable":return r.a.createElement(wt,{updateParent:C});default:return r.a.createElement("div",null)}}(),r.a.createElement(w.a,{type:"submit",variant:"contained",color:f?"default":"primary",onClick:function(t){t.preventDefault(),E(!0);var a=new h.Message(JSON.stringify(u));a.destinationName=["pioreactor",e.unit,e.experiment,"temperature_control","temperature_automation","set"].join("/"),a.qos=2;try{y.publish(a)}catch(n){console.log(n)}l(!1)},style:{width:"120px",marginTop:"20px"}},"Submit"))))))},Ot=Object(V.a)({actionTextField:{padding:"0px 10px 0px 0px",width:"175px"},actionForm:{padding:"20px 0px 0px 0px"}}),St={remove_waste:"Removing waste",add_media:"Adding media",add_alt_media:"Adding alt. media"};function jt(e){var t=Ot(),a=Object(n.useState)(""),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)(""),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),g=Object(m.a)(p,2),f=g[0],h=g[1],E=Object(n.useState)(!1),b=Object(m.a)(E,2),y=b[0],x=b[1],C=Object(n.useState)(!1),O=Object(m.a)(C,2),S=O[0],j=O[1];return r.a.createElement("form",{id:e.action,className:t.actionForm},r.a.createElement(Ze.a,{name:"mL",value:o,size:"small",id:e.action+"_mL",label:"mL",variant:"outlined",disabled:f,onChange:function(e){l(e.target.value),x(!0),""===e.target.value&&x(!1)},className:t.actionTextField}),r.a.createElement(Ze.a,{name:"duration",value:u,size:"small",id:e.action+"_duration",label:"seconds",variant:"outlined",disabled:y,onChange:function(e){d(e.target.value),h(!0),""===e.target.value&&h(!1)},className:t.actionTextField}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(w.a,{type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),""!==o||""!==u){var a=""!==o?{ml:o,source_of_event:"UI"}:{duration:u,source_of_event:"UI"};fetch("/run/".concat(e.action,"/").concat(e.unit),{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}),j(!0)}}},e.action.replace(/_/g," ")),r.a.createElement(w.a,{size:"small",color:"secondary",onClick:function(t){fetch("/stop/".concat(e.action,"/").concat(e.unit),{method:"POST"})}},"Interrupt")),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:S,onClose:function(){j(!1)},message:St[e.action]+(""!==u?" for "+u+" seconds.":" until "+o+"mL."),autoHideDuration:7e3,key:"snackbar"+e.unit+e.action}))}var _t=Object(V.a)({actionTextField:{padding:"0px 10px 0px 0px"},actionForm:{padding:"10px 0px 0px 0px"}});function kt(e){var t=_t(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)(""),s=Object(m.a)(c,2),u=s[0],d=s[1];return r.a.createElement("form",{id:e.action,className:t.actionForm},r.a.createElement(Ze.a,{name:"intensity",value:u,size:"small",id:e.channel+"_intensity_edit",label:"new intensity",variant:"outlined",onChange:function(e){d(e.target.value)},InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"%")},className:t.actionTextField}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(w.a,{type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),""!==u){var a={intensity:u,channel:e.channel,source_of_event:"UI"};fetch("/run/led_intensity/".concat(e.unit),{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}),l(!0)}}},"Submit"),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:o,onClose:function(){l(!1)},message:"Updating Channel ".concat(e.channel," to ").concat(u,"%."),autoHideDuration:7e3,key:"snackbar"+e.unit+e.channel}))}var Nt=Object(Fe.a)((function(e){return{textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"},pioreactorCard:{marginTop:"0px",marginBottom:"20px"},cardContent:{padding:"10px 20px 20px 20px"},unitTitle:{fontSize:20,color:"rgba(0, 0, 0, 0.87)",fontWeight:500},unitTitleDialog:{fontSize:20,color:"rgba(0, 0, 0, 0.87)"},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"},disabledText:{color:"rgba(0, 0, 0, 0.38)"},textbox:{width:"127px",marginTop:"10px"},textboxLabel:{width:"100px",marginTop:"10px",marginRight:"5px"},footnote:{marginBottom:0,fontSize:12},textField:{marginTop:"15px",maxWidth:"180px"},textFieldWide:{marginTop:"15px",maxWidth:"220px"},textFieldCompact:{marginTop:e.spacing(3),marginRight:e.spacing(2),marginBottom:e.spacing(0),width:"30ch"},slider:{width:"70%",margin:"40px auto 0px auto"},divider:{marginTop:15,marginBottom:10},jobButton:{paddingRight:"15px",paddingLeft:"15px"},unitSettingsSubtext:{fontSize:"11px"},unitSettingsSubtextEmpty:{minHeight:"15px"}}}));function Tt(e){var t=e.children,a=e.value,n=e.index,i=Object(Ge.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),key:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},i),a===n&&r.a.createElement("div",null,t))}function Dt(e){var t=Nt(),a={init:{display:"Starting",color:"#4caf50"},ready:{display:"On",color:"#4caf50"},sleeping:{display:"Paused",color:"grey"},disconnected:{display:"Off",color:"grey"},lost:{display:"Lost",color:"#DE3618"},NA:{display:"Not available",color:"grey"}},n=e.value||"";if(e.isStateSetting){if(e.isUnitActive){var i=a[n];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:i.color,fontWeight:500}},i.display),e.subtext&&r.a.createElement("div",{className:t.unitSettingsSubtext},r.a.createElement("code",null,e.subtext)),!e.subtext&&r.a.createElement("div",{className:t.unitSettingsSubtextEmpty}))}return r.a.createElement("div",{className:Object(N.a)(Object(C.a)({},t.disabledText,!e.isUnitActive))}," ",a[n].display," ")}if(e.isLEDIntensity){if(e.isUnitActive&&"\u2014"!==n&&""!==n){var o=JSON.parse(n);return r.a.createElement("div",{style:{fontSize:"13px"}},r.a.createElement("div",null,r.a.createElement("span",{style:{width:"55px",display:"inline-block"}},"A: ",o.A,"%"),r.a.createElement("span",{style:{width:"55px",display:"inline-block"}},"B: ",o.B,"% ")),r.a.createElement("div",null,r.a.createElement("span",{style:{width:"55px",display:"inline-block"}},"C: ",o.C,"%"),r.a.createElement("span",{style:{width:"55px",display:"inline-block"}},"D: ",o.D,"% ")))}return r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," ")}return e.isUnitActive&&"\u2014"!==n&&""!==n?r.a.createElement("div",{style:{fontSize:"13px"}},("string"===typeof n?n:+n.toFixed(e.precision))+(e.measurementUnit?e.measurementUnit:"")):r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," ")}function At(){var e=Nt(),t=Object(n.useState)(!1),a=Object(m.a)(t,2),i=a[0],o=a[1],l=function(){o(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},color:"secondary",onClick:function(){o(!0)}},r.a.createElement(ne.a,{className:e.textIcon})," Stop all activity"),r.a.createElement(le.a,{open:i,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(oe.a,{id:"alert-dialog-title"},"Stop all Pioreactor activity?"),r.a.createElement(ce.a,null,r.a.createElement(me.a,{id:"alert-dialog-description"},"This will stop all activies (stirring, dosing, optical density reading, etc.) in ",r.a.createElement("b",null,"all")," Pioreactor units. Do you wish to stop all activities?")),r.a.createElement(se.a,null,r.a.createElement(w.a,{onClick:function(){fetch("/stop_all",{method:"POST"}),l()},color:"primary"},"Confirm"),r.a.createElement(w.a,{onClick:l,color:"secondary",autoFocus:!0},"Cancel"))))}function Pt(e){var t=Nt(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)(!1),s=Object(m.a)(c,2),u=s[0],d=s[1],p=r.a.useState(""),g=Object(m.a)(p,2),f=g[0],h=g[1],E=r.a.useState(!1),b=Object(m.a)(E,2),y=b[0],x=b[1],C=r.a.useState(""),O=Object(m.a)(C,2),S=O[0],j=O[1],_=r.a.useState(""),k=Object(m.a)(_,2),N=k[0],T=k[1],D=y?r.a.createElement(He.a,{color:"inherit",size:24}):"Install and connect";return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{onClick:function(){l(!0)},style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(ie.a,{className:t.textIcon})," Add new Pioreactor"),r.a.createElement(le.a,{open:o,onClose:function(){l(!1)},"aria-labelledby":"form-dialog-title"},r.a.createElement(oe.a,null,r.a.createElement(B.a,{className:t.unitTitleDialog},"Add new Pioreactor")),r.a.createElement(ce.a,null,r.a.createElement("p",null," To add a new Pioreactor, you'll need the following: "),r.a.createElement("ul",null,r.a.createElement("li",null,"A RaspberryPi, with power cord"),r.a.createElement("li",null,"A blank microSD card"),r.a.createElement("li",null,"A computer with the ",r.a.createElement("a",{href:"https://www.raspberrypi.org/software/"},"RaspberryPi Imager")," installed and that can read & write to the microSD card"),r.a.createElement("li",null,"The Pioreactor hardware hat")),r.a.createElement("p",null," With that all ready, let's begin: "),r.a.createElement("ol",null,r.a.createElement("li",null,"Insert your microSD card into your computer."),r.a.createElement("li",null,"Open the ",r.a.createElement("a",{href:"https://www.raspberrypi.org/software/"},"RaspberryPi Imager"),', and hold "ctrl-shift-x" to bring up the settings menu'),r.a.createElement("li",null,'Check "Enable SSH", with password ',r.a.createElement("code",null,"raspberry"),". ",r.a.createElement("b",null,"This is important"),"."),r.a.createElement("li",null,'Check "Configure wifi", and add your credentials.'),r.a.createElement("li",null,' Click "Save".'),r.a.createElement("li",null,'Choose the "Raspberry Pi OS Lite" and your storage, and click "write". '),r.a.createElement("li",null,"When done, unmount the microSD, insert it into the RaspberryPi, and attach the Pioreactor hat to the RaspberryPi."),r.a.createElement("li",null,"Turn on the RaspberryPi by inserting the power cord.")),r.a.createElement("p",null,"Below, provide a unique name for your new Pioreactor (letters and digits only), and your existing Pioreactors will automatically install the required software and connect it to the cluster."),r.a.createElement("p",null,"It may take up to 5 minutes to install the software. When finished, the new Pioreactor will show up on this page. You don't need to stay on this page while it's installing."),r.a.createElement("div",null,r.a.createElement(Ze.a,{size:"small",id:"new-pioreactor-name",label:"Provide a name",variant:"outlined",className:t.textFieldWide,onChange:function(e){h(e.target.value)},InputProps:{startAdornment:r.a.createElement(et.a,{position:"start"},r.a.createElement(Ae,{style:{fontSize:"1.1em"}}))}})),r.a.createElement("div",{style:{minHeight:"50px"}},N?r.a.createElement("p",null,r.a.createElement(F.a,{color:"error.main"},S)):r.a.createElement("p",null),y?r.a.createElement("p",null,"Installation is occuring in the background. You may navigate away from this page, including adding more Pioreactors. "):r.a.createElement("p",null," ")),r.a.createElement(w.a,{variant:"contained",color:"primary",style:{marginTop:"15px"},onClick:function(e){if(e.preventDefault(),!f)return T(!0),void j("Provide a name for the new Pioreactor");T(!1),x(!0),fetch("add_new_pioreactor",{method:"POST",body:JSON.stringify({newPioreactorName:f}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){e.ok||(T(!0),x(!1),e.json().then((function(e){return j("Unable to complete installation. ".concat(e.stderr))})))}))},type:"submit"},D))),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:u,onClose:function(){d(!1)},message:"Installing new Pioreactor",autoHideDuration:7e3,key:"snackbar-add-new"}))}function Lt(e){return r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement(B.a,{variant:"h5",component:"h1"},r.a.createElement(F.a,{fontWeight:"fontWeightBold"},"Pioreactors")),r.a.createElement("div",null,r.a.createElement(Mt,{unit:"$broadcast",config:e.config,experiment:e.experiment}),r.a.createElement(Pt,{config:e.config}),r.a.createElement(At,null))),r.a.createElement($.a,null))}function Bt(e){var t=Object(n.useState)(e.buttonText),a=Object(m.a)(t,2),i=a[0],o=a[1];return Object(n.useEffect)((function(){o(e.buttonText)}),[e.buttonText]),r.a.createElement(w.a,{disableElevation:!0,style:{width:"70px",marginTop:"5px"},color:e.color,variant:e.variant,size:"small",onClick:function(){o(r.a.createElement(He.a,{color:"inherit",size:22})),e.onClick()}},i)}function Ft(e){var t=Nt(),a=Object(n.useState)(0),i=Object(m.a)(a,2),o=i[0],l=i[1],u=Object(n.useState)(!1),d=Object(m.a)(u,2),p=d[0],g=d[1],f=Object(n.useState)(!1),E=Object(m.a)(f,2),b=E[0],y=E[1],x=Object(n.useState)(""),C=Object(m.a)(x,2),O=C[0],S=C[1],j=r.a.useState(0),_=Object(m.a)(j,2),k=_[0],T=_[1];function D(t,a){return function n(){var r=new h.Message(String(a));r.destinationName=["pioreactor",e.unit,e.experiment,t,"$state","set"].join("/"),r.qos=1;try{e.client.publish(r)}catch(i){console.log(i),setTimeout((function(){n()}),750)}}}function A(t){return function(){fetch("/run/"+t+"/"+e.unit,{method:"POST"}).then((function(e){}))}}function P(t,a){var n=new h.Message(String(a));n.destinationName=["pioreactor",e.unit,e.experiment,t,"set"].join("/"),n.qos=1;try{e.client.publish(n)}catch(r){console.log(r),e.client.connect({onSuccess:function(){return P(t,a)}})}}function L(e){"Enter"===e.key&&(P(e.target.id,e.target.value),S("Updated to ".concat(e.target.value,".")),y(!0))}Object(n.useEffect)((function(){function t(){return(t=Object(s.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/get_config/config_"+e.unit+".ini").then((function(e){if(e.ok)return e.text();throw new Error("Something went wrong")})).then((function(e){e=st(e),l(e.stirring.duty_cycle)})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.disabled||function(){t.apply(this,arguments)}()}),[e.disabled,e.unit]);function F(e,t){switch(e){case"lost":return r.a.createElement("div",null,r.a.createElement(Bt,{color:"secondary",variant:"contained",onClick:A(t),buttonText:"Start"}),r.a.createElement(Bt,{color:"secondary",onClick:D(t,"disconnected"),buttonText:"Stop"}));case"disconnected":return r.a.createElement("div",null,r.a.createElement(Bt,{color:"primary",variant:"contained",onClick:A(t),buttonText:"Start"}));case"init":case"ready":return r.a.createElement("div",null,r.a.createElement(Bt,{color:"secondary",variant:"contained",onClick:D(t,"sleeping"),buttonText:"Pause"}),r.a.createElement(Bt,{color:"secondary",onClick:D(t,"disconnected"),buttonText:"Stop"}));case"sleeping":return r.a.createElement("div",null,r.a.createElement(Bt,{color:"primary",variant:"contained",onClick:D(t,"ready"),buttonText:"Resume"}),r.a.createElement(Bt,{color:"secondary",onClick:D(t,"disconnected"),buttonText:"Stop"}));default:return r.a.createElement("div",null)}}var M=F(e.stirringJobState,"stirring"),z=F(e.ODReadingJobState,"od_reading"),R=F(e.growthRateJobState,"growth_rate_calculating"),I=F(e.dosingControlJobState,"dosing_control"),W=F(e.ledControlJobState,"led_control"),U=F(e.temperatureControlJobState,"temperature_control"),H=Object.fromEntries(Object.entries(e.config.leds|{}).map((function(e){var t=Object(m.a)(e,2),a=t[0];return[t[1],a]})));return r.a.createElement("div",null,r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},disabled:e.disabled,onClick:function(){g(!0)},color:"primary"},r.a.createElement(ot.a,{color:e.disabled?"disabled":"primary",className:t.textIcon})," Manage"),r.a.createElement(le.a,{open:p,onClose:function(){T(0),g(!1)},"aria-labelledby":"form-dialog-title"},r.a.createElement(oe.a,null,r.a.createElement(B.a,{className:t.suptitle},r.a.createElement(Ae,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.config["ui.rename"]&&e.config["ui.rename"][e.unit]?"".concat(e.config["ui.rename"][e.unit]," / ").concat(e.unit):"".concat(e.unit)),r.a.createElement(tt.a,{value:k,onChange:function(e,t){T(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},r.a.createElement(at.a,{label:"Activities"}),r.a.createElement(at.a,{label:"Settings"}),r.a.createElement(at.a,{label:"Dosing"}),r.a.createElement(at.a,{label:"LEDs"}))),r.a.createElement(ce.a,null,r.a.createElement(Tt,{value:k,index:2},r.a.createElement(B.a,{gutterBottom:!0},"Add media"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Run the media pump",e.isPlural?"s":""," for a set duration (seconds), or a set volume (mL)."),r.a.createElement(jt,{action:"add_media",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Add alternative media"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Run the alternative media pump",e.isPlural?"s":""," for a set duration (seconds), or a set volume (mL)."),r.a.createElement(jt,{action:"add_alt_media",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Remove waste"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Run the waste pump",e.isPlural?"s":""," for a set duration (seconds), or a set volume (mL)."),r.a.createElement(jt,{action:"remove_waste",unit:e.unit}),r.a.createElement($.a,{className:t.divider})),r.a.createElement(Tt,{value:k,index:3},r.a.createElement(B.a,{className:Object(N.a)(t.suptitle),color:"textSecondary"},H.A?"Channel A":""),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},H.A?H.A.replace("_"," ").replace("led","LED"):"Channel A"),r.a.createElement(kt,{channel:"A",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{className:Object(N.a)(t.suptitle),color:"textSecondary"},H.B?"Channel B":""),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},H.B?H.B.replace("_"," ").replace("led","LED"):"Channel B"),r.a.createElement(kt,{channel:"B",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{className:Object(N.a)(t.suptitle),color:"textSecondary"},H.C?"Channel C":""),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},H.C?H.C.replace("_"," ").replace("led","LED"):"Channel C"),r.a.createElement(kt,{channel:"C",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{className:Object(N.a)(t.suptitle),color:"textSecondary"},H.D?"Channel D":""),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},H.D?H.D.replace("_"," ").replace("led","LED"):"Channel D"),r.a.createElement(kt,{channel:"D",unit:e.unit}),r.a.createElement($.a,{className:t.divider})),r.a.createElement(Tt,{value:k,index:1},r.a.createElement(B.a,{gutterBottom:!0},"Stirring speed"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Modify the stirring speed (arbitrary units). This will effect the optical density reading. Too low and the fan may completely stop."),r.a.createElement("div",{className:t.slider},r.a.createElement(Ke.a,{defaultValue:parseInt(e.stirringDC),"aria-labelledby":"discrete-slider-custom",step:1,valueLabelDisplay:"on",id:"stirring/duty_cycle_"+e.unit,key:"stirring/duty_cycle_"+e.unit,onChangeCommitted:function(e,t){P("stirring/duty_cycle",t)},marks:[{value:0,label:"0",key:"slider-0"},{value:o,label:"Default: "+o,key:"slider-default"},{value:100,label:"100",key:"slider-100"}]})),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Dynamic stirring adjustments"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Enable adjusting of stirring speed when not taking optical density measurements. Turning this on increases the oxygen transfer rate."),r.a.createElement("div",{style:{marginLeft:"20px"}},r.a.createElement(Ie.a,{control:r.a.createElement(Qe.a,{checked:e.stirringDynamic,onChange:function(e,t){P("stirring/dc_increase_between_adc_readings",t?1:0)},color:"primary"})})),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Volume / dosing"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the volume per dilution. Typical values are between 0.0mL and 1.0mL."),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/volume",label:"Volume / dosing",defaultValue:e.volume,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"mL")},variant:"outlined",onKeyPress:L,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Target OD"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the target optical density. Typical values are between 1.0 and 2.5 (arbitrary units)"),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/target_od",label:"Target optical density",defaultValue:e.targetOD,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"AU")},variant:"outlined",onKeyPress:L,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Duration between dosing events"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change how long to wait between dilutions. Typically between 5 and 90 minutes. Changing this will immediately trigger a dosing event."),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/duration",label:"Duration",defaultValue:e.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onKeyPress:L,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Target growth rate"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the target hourly growth rate - only applicable in"," ",r.a.createElement("code",null,"morbidostat")," mode. Typical values are between 0.05h\u207b\xb9 and 0.4h\u207b\xb9."),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/target_growth_rate",label:"Target growth rate",defaultValue:e.targetGrowthRate,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"h\u207b\xb9")},variant:"outlined",onKeyPress:L,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Target Temperature"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the target temperature. Lower bound is the ambient temperature, and upperbound is 50\u2103."),r.a.createElement(Ze.a,{size:"small",id:"temperature_automation/target_temperature",label:"Target temperature",defaultValue:e.targetTemperature,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"\u2103")},variant:"outlined",onKeyPress:L,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Dosing automation"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"disconnected"!==e.dosingControlJobState&&r.a.createElement(r.a.Fragment,null,"Currently running dosing automation ",r.a.createElement("code",null,e.dosingAutomation),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/dosing-automations"},"dosing automations"),"."),"disconnected"===e.dosingControlJobState&&r.a.createElement(r.a.Fragment,null,"You can change the dosing automation after starting the Dosing control activity.")),r.a.createElement(ht,{unit:e.unit,config:e.config,experiment:e.experiment,currentDosingAutomation:e.dosingAutomation}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"LED automation"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"disconnected"!==e.ledControlJobState&&r.a.createElement(r.a.Fragment,null,"Currently running LED automation ",r.a.createElement("code",null,e.ledAutomation),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/led-automations"},"LED automations"),"."),"disconnected"===e.ledControlJobState&&r.a.createElement(r.a.Fragment,null,"You can change the LED automation after starting the LED control activity.")),r.a.createElement(vt,{unit:e.unit,config:e.config,experiment:e.experiment,currentLEDAutomation:e.ledAutomation}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Temperature automation"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"disconnected"!==e.temperatureControlJobState&&r.a.createElement(r.a.Fragment,null,"Currently running temperature automation ",r.a.createElement("code",null,e.tempAutomation),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/temperature-automations"},"temperature automations"),"."),"disconnected"===e.temperatureControlJobState&&r.a.createElement(r.a.Fragment,null,"You can change the temperature automation after starting the Temperature control activity.")),r.a.createElement(Ct,{unit:e.unit,config:e.config,experiment:e.experiment,currentTemperatureAutomation:e.tempAutomation}),r.a.createElement($.a,{className:t.divider})),r.a.createElement(Tt,{value:k,index:0},r.a.createElement(B.a,{gutterBottom:!0},"Stirring"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Start, stop or pause the stirring on the Pioreactor. Stirring is needed for homogenous mixing."),M,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Optical density"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Pausing the optical density readings will also pause downstream activities that rely on optical density readings, like growth rates."),z,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Growth rate"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Pausing the growth rate calculating will also pause downstream activities that rely on it, like dosing events."),R,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Dosing control"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"disconnected"!==e.dosingControlJobState&&r.a.createElement(r.a.Fragment,null,"Currently running dosing automation ",r.a.createElement("code",null,e.dosingAutomation),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/dosing-automations"},"dosing automations"),"."),"disconnected"===e.dosingControlJobState&&r.a.createElement(r.a.Fragment,null,"Dosing events will initially start in ",r.a.createElement("span",{className:"underlineSpan",title:"silent mode performs no dosing operations."},r.a.createElement("code",null,"silent"))," mode, and can be changed after. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/dosing-automations"},"dosing automations"),".")),I,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"LED control"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"disconnected"!==e.ledControlJobState&&r.a.createElement(r.a.Fragment,null,"Currently running LED automation ",r.a.createElement("code",null,e.ledAutomation),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/led-automations"},"LED automations"),"."),"disconnected"===e.ledControlJobState&&r.a.createElement(r.a.Fragment,null,"LED controls will initially start in ",r.a.createElement("span",{className:"underlineSpan",title:"silent mode performs no dosing operations."},r.a.createElement("code",null,"silent"))," mode, and can be changed after. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/led-automations"},"LED automations"),".")),W,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Temperature control"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"disconnected"!==e.temperatureControlJobState&&r.a.createElement(r.a.Fragment,null,"Currently running temperature automation ",r.a.createElement("code",null,e.tempAutomation),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/temperature-automations"},"temperature automations"),"."),"disconnected"===e.temperatureControlJobState&&r.a.createElement(r.a.Fragment,null,"Temperature controls will initially start in ",r.a.createElement("span",{className:"underlineSpan",title:"silent mode performs no dosing operations."},r.a.createElement("code",null,"silent"))," mode, and can be changed after. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/temperature-automations"},"temperature automations"),".")),U,r.a.createElement($.a,{className:t.divider})))),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:b,onClose:function(){y(!1)},message:O,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar"+e.unit+"settings"}))}function Mt(e){var t=Nt(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],c=Object(n.useState)(null),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),g=Object(m.a)(p,2),f=g[0],E=g[1],b=Object(n.useState)(""),y=Object(m.a)(b,2),x=y[0],C=y[1],O=r.a.useState(0),S=Object(m.a)(O,2),j=S[0],_=S[1],k={od_reading:"optical density reading",growth_rate_calculating:"growth rate activity",stirring:"stirring",dosing_automation:"dosing control",dosing_control:"dosing control",led_control:"LED control",led_automation:"LED control",temperature_control:"temperature control",temperature_automation:"temperature control"};function N(t,a){return function n(){var r=new h.Message(String(a));r.destinationName=["pioreactor",e.unit,e.experiment,t,"$state","set"].join("/"),r.qos=1;try{u.publish(r)}catch(i){console.log(i),setTimeout((function(){n()}),750)}finally{C("".concat({sleeping:"Pausing",disconnected:"Stopping",ready:"Resuming"}[a]," ").concat(k[t]," on all active Pioreactors")),E(!0)}}}function T(t){return function(){C("Starting ".concat(k[t]," on all active Pioreactors")),E(!0),fetch("/run/"+t+"/"+e.unit,{method:"POST"})}}function D(t){"Enter"===t.key&&(!function a(n,r){var i=new h.Message(String(r));i.destinationName=["pioreactor",e.unit,e.experiment,n,"set"].join("/"),i.qos=1;try{u.publish(i),E(!0)}catch(t){console.log(t),u.connect({onSuccess:function(){return a(n,r)}})}}(t.target.id,t.target.value),C("Updated to ".concat(t.target.value,".")),E(!0))}Object(n.useEffect)((function(){var t;e.config["network.topology"]&&((t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_SettingsActionsDialogAll"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_SettingsActionsDialogAll"+Math.random())).connect({timeout:180,reconnect:!0}),d(t))}),[e.config]);function A(e){return r.a.createElement("div",null,r.a.createElement(w.a,{className:t.jobButton,disableElevation:!0,color:"primary",onClick:T(e)},"Start"),r.a.createElement(w.a,{className:t.jobButton,disableElevation:!0,color:"primary",onClick:N(e,"sleeping")},"Pause"),r.a.createElement(w.a,{className:t.jobButton,disableElevation:!0,color:"primary",onClick:N(e,"ready")},"Resume"),r.a.createElement(w.a,{className:t.jobButton,disableElevation:!0,color:"secondary",onClick:N(e,"disconnected")},"Stop"))}var P=A("od_reading"),L=A("growth_rate_calculating"),F=A("dosing_control"),M=A("led_control"),z=A("temperature_control"),R=A("stirring");return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},onClick:function(){l(!0)},color:"primary"},r.a.createElement(ot.a,{className:t.textIcon})," Manage all Pioreactors"),r.a.createElement(le.a,{open:o,onClose:function(){_(0),l(!1)},"aria-labelledby":"form-dialog-title"},r.a.createElement(oe.a,{style:{backgroundColor:"#edeaf9"}},r.a.createElement(B.a,{className:t.suptitle},"All active Pioreactors"),r.a.createElement(tt.a,{value:j,onChange:function(e,t){_(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},r.a.createElement(at.a,{label:"Activities"}),r.a.createElement(at.a,{label:"Settings"}),r.a.createElement(at.a,{label:"Dosing"}),r.a.createElement(at.a,{label:"LEDs"}))),r.a.createElement(ce.a,null,r.a.createElement(Tt,{value:j,index:3},r.a.createElement(B.a,{style:{textTransform:"capitalize"}},"Channel A"),r.a.createElement(kt,{channel:"A",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},"Channel B"),r.a.createElement(kt,{channel:"B",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},"Channel C"),r.a.createElement(kt,{channel:"C",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{style:{textTransform:"capitalize"}},"Channel D"),r.a.createElement(kt,{channel:"D",unit:e.unit}),r.a.createElement($.a,{className:t.divider})),r.a.createElement(Tt,{value:j,index:1},r.a.createElement(B.a,{gutterBottom:!0},"Volume / dosing"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the volume per dilution. Typical values are between 0.0mL and 1.0mL."),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/volume",label:"Volume / dosing",defaultValue:e.volume,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"mL")},variant:"outlined",onKeyPress:D,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Target Temperature"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the target temperature. Lower bound is the ambient temperature, and upperbound is 50\u2103."),r.a.createElement(Ze.a,{size:"small",id:"temperature_automation/target_temperature",label:"Target temperature",defaultValue:e.targetTemperature,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"\u2103")},variant:"outlined",onKeyPress:D,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Duration between dosing events"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change how long to wait between dilutions. Typically between 15 and 90 minutes. Changing this will immediately trigger a dosing event."),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/duration",label:"Duration",defaultValue:e.duration,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"min")},variant:"outlined",onKeyPress:D,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Target growth rate"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Change the target hourly growth rate - only applicable in"," ",r.a.createElement("code",null,"morbidostat")," mode. Typical values are between 0.05h\u207b\xb9 and 0.4h\u207b\xb9."),r.a.createElement(Ze.a,{size:"small",id:"dosing_automation/target_growth_rate",label:"Target growth rate",defaultValue:e.targetGrowthRate,InputProps:{endAdornment:r.a.createElement(et.a,{position:"end"},"h\u207b\xb9")},variant:"outlined",onKeyPress:D,className:t.textFieldWide}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Dosing automation"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/Dosing-automations"},"dosing automations"),"."),r.a.createElement(ht,{unit:e.unit,config:e.config,experiment:e.experiment,currentDosingAutomation:!0,title:"All active Pioreactors"}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"LED automation"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/LED-automations"},"LED automations"),"."),r.a.createElement(vt,{unit:e.unit,config:e.config,experiment:e.experiment,currentLEDAutomation:!0,title:"All active Pioreactors"}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Temperature automation"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/temperature-automations"},"temperature automations"),"."),r.a.createElement(Ct,{unit:e.unit,config:e.config,experiment:e.experiment,currentTemperatureAutomation:!0,title:"All active Pioreactors"}),r.a.createElement($.a,{className:t.divider})),r.a.createElement(Tt,{value:j,index:0},r.a.createElement(B.a,{gutterBottom:!0},"Stirring"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Start, stop or pause the stirring on all the Pioreactors. Stirring is needed for homogenous mixing."),R,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Optical density"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Pausing the optical density readings will also pause downstream activities that rely on optical density readings, like growth rates."),P,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Growth rate"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Pausing the growth rate calculating will also pause downstream activities that rely on it, like dosing events."),L,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Dosing control"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Dosing events will initially start in ",r.a.createElement("span",{className:"underlineSpan",title:"silent mode performs no IO operations."},r.a.createElement("code",null,"silent"))," mode, and can be changed after. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/dosing-automations"},"dosing automations"),"."),F,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"LED control"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"LED control will initially start in ",r.a.createElement("span",{className:"underlineSpan",title:"silent mode performs no IO operations."},r.a.createElement("code",null,"silent"))," mode, and can be changed after. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/led-automations"},"LED automations"),"."),M,r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Temperature control"),r.a.createElement(B.a,{variant:"body2",component:"p",gutterBottom:!0},"Temperature control will initially start in ",r.a.createElement("span",{className:"underlineSpan",title:"silent mode performs no IO operations."},r.a.createElement("code",null,"silent"))," mode, and can be changed after. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/temperature-automations"},"temperature automations"),"."),z,r.a.createElement($.a,{className:t.divider})),r.a.createElement(Tt,{value:j,index:2},r.a.createElement(B.a,{gutterBottom:!0},"Add media"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Run the media pump",e.isPlural?"s":""," for a set duration (seconds), or a set volume (mL)."),r.a.createElement(jt,{action:"add_media",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Add alternative media"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Run the alternative media pump",e.isPlural?"s":""," for a set duration (seconds), or a set volume (mL)."),r.a.createElement(jt,{action:"add_alt_media",unit:e.unit}),r.a.createElement($.a,{className:t.divider}),r.a.createElement(B.a,{gutterBottom:!0},"Remove waste"),r.a.createElement(B.a,{variant:"body2",component:"p"},"Run the waste pump",e.isPlural?"s":""," for a set duration (seconds), or a set volume (mL)."),r.a.createElement(jt,{action:"remove_waste",unit:e.unit}),r.a.createElement($.a,{className:t.divider})))),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:f,onClose:function(){E(!1)},message:x,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar"+e.unit+"settings"}))}function zt(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",marginTop:"15px"}},r.a.createElement(B.a,{variant:"h5",component:"h2"},r.a.createElement(F.a,{fontWeight:"fontWeightRegular"},"Active Pioreactors")),r.a.createElement("div",null)),e.units.map((function(t){return r.a.createElement(It,{isUnitActive:!0,key:t,unit:t,config:e.config,experiment:e.experiment})})))}function Rt(e){var t=Nt(),a=Object(n.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1];return r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},className:Object(N.a)({blinkled:o}),disabled:e.disabled,onClick:function(){l(!0);!function t(){var a=new h.Message("1");a.destinationName=["pioreactor",e.unit,"$experiment","monitor","flicker_led"].join("/"),a.qos=0;try{e.client.publish(a)}catch(n){console.log(n),setTimeout((function(){t()}),1e3)}}(),setTimeout((function(){l(!1)}),3600)},color:"primary"},r.a.createElement(rt.a,{color:e.disabled?"disabled":"primary",className:t.textIcon})," ",r.a.createElement("span",null,"  Blink  "))}function It(e){var t,a=Nt(),i=e.unit,o=e.isUnitActive,l=e.experiment,c=Object(n.useState)(null),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)("disconnected"),g=Object(m.a)(p,2),f=g[0],E=g[1],b=Object(n.useState)("disconnected"),v=Object(m.a)(b,2),y=v[0],x=v[1],O=Object(n.useState)("disconnected"),S=Object(m.a)(O,2),j=S[0],_=S[1],k=Object(n.useState)("disconnected"),T=Object(m.a)(k,2),D=T[0],A=T[1],L=Object(n.useState)("disconnected"),M=Object(m.a)(L,2),z=M[0],R=M[1],I=Object(n.useState)("disconnected"),W=Object(m.a)(I,2),U=W[0],H=W[1],Y=Object(n.useState)("disconnected"),J=Object(m.a)(Y,2),V=J[0],q=J[1],G=Object(n.useState)(0),K=Object(m.a)(G,2),Z=K[0],Q=K[1],X=Object(n.useState)(0),ee=Object(m.a)(X,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(0),re=Object(m.a)(ne,2),ie=re[0],oe=re[1],le=Object(n.useState)(0),ce=Object(m.a)(le,2),se=ce[0],me=ce[1],ue=Object(n.useState)(0),de=Object(m.a)(ue,2),pe=de[0],ge=de[1],fe=Object(n.useState)(0),he=Object(m.a)(fe,2),Ee=he[0],be=he[1],ve=Object(n.useState)(0),ye=Object(m.a)(ve,2),xe=ye[0],we=ye[1],Ce=Object(n.useState)(null),Oe=Object(m.a)(Ce,2),Se=Oe[0],je=Oe[1],_e=Object(n.useState)(null),ke=Object(m.a)(_e,2),Ne=ke[0],Te=ke[1],De=Object(n.useState)(null),Pe=Object(m.a)(De,2),Le=Pe[0],Be=Pe[1],Fe=Object(n.useState)(""),Me=Object(m.a)(Fe,2),ze=Me[0],Re=Me[1],Ie=(t={},Object(C.a)(t,["pioreactor",i,l,"led_control/$state"].join("/"),q),Object(C.a)(t,["pioreactor",i,l,"stirring/$state"].join("/"),E),Object(C.a)(t,["pioreactor",i,l,"od_reading/$state"].join("/"),x),Object(C.a)(t,["pioreactor",i,l,"dosing_control/$state"].join("/"),A),Object(C.a)(t,["pioreactor",i,l,"growth_rate_calculating/$state"].join("/"),_),Object(C.a)(t,["pioreactor",i,l,"temperature_control/$state"].join("/"),H),Object(C.a)(t,["pioreactor",i,"$experiment","monitor/$state"].join("/"),R),Object(C.a)(t,["pioreactor",i,l,"stirring/duty_cycle"].join("/"),Q),Object(C.a)(t,["pioreactor",i,l,"stirring/dc_increase_between_adc_readings"].join("/"),ae),Object(C.a)(t,["pioreactor",i,l,"dosing_automation/target_od"].join("/"),oe),Object(C.a)(t,["pioreactor",i,l,"temperature_automation/target_temperature"].join("/"),me),Object(C.a)(t,["pioreactor",i,l,"dosing_automation/duration"].join("/"),ge),Object(C.a)(t,["pioreactor",i,l,"dosing_automation/target_growth_rate"].join("/"),be),Object(C.a)(t,["pioreactor",i,l,"dosing_automation/volume"].join("/"),we),Object(C.a)(t,["pioreactor",i,l,"dosing_control/dosing_automation"].join("/"),je),Object(C.a)(t,["pioreactor",i,l,"led_control/led_automation"].join("/"),Te),Object(C.a)(t,["pioreactor",i,l,"temperature_control/temperature_automation"].join("/"),Be),Object(C.a)(t,["pioreactor",i,"$experiment","leds/intensity"].join("/"),Re),t);Object(n.useEffect)((function(){var t;e.config["network.topology"]&&(o&&l&&((t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui"+Math.random())).onMessageArrived=function(e){var t=parseFloat(e.payloadString),a=isNaN(t)?e.payloadString:t;Ie[e.topic](a)},t.connect({onSuccess:function(){for(var e=0,a=Object.keys(Ie);e<a.length;e++){var n=a[e];t.subscribe(n)}},reconnect:!0}),d(t)))}),[e.config,e.experiment]);var We="disconnected"===z?"grey":"lost"===z?"#DE3618":"#4caf50",Ue="disconnected"===z?0:6,He="disconnected"===z?o?"Offline, need to power up":"Offline, change inventory status in config.ini":"lost"===z?"Lost, something went wrong...":"Online";return r.a.createElement(P.a,{className:a.pioreactorCard,id:i},r.a.createElement(P.a,{className:a.cardContent},r.a.createElement("div",{className:"fixme"},r.a.createElement(B.a,{className:Object(N.a)(a.suptitle),color:"textSecondary"},e.config["ui.rename"]&&e.config["ui.rename"][i]?i:""),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"left"}},r.a.createElement(B.a,{className:Object(N.a)(a.unitTitle,Object(C.a)({},a.disabledText,!o)),gutterBottom:!0},r.a.createElement(Ae,{color:o?"inherit":"disabled",style:{verticalAlign:"middle"}}),e.config["ui.rename"]&&e.config["ui.rename"][i]?e.config["ui.rename"][i]:i),r.a.createElement(Xe.a,{title:He,placement:"right"},r.a.createElement("div",null,r.a.createElement("div",{"aria-label":He,className:"indicator-dot",style:{boxShadow:"0 0 ".concat(Ue,"px ").concat(We,", inset 0 0 12px  ").concat(We)}})))),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"row",flexWrap:"wrap"}},r.a.createElement("div",null,r.a.createElement(w.a,{style:{textTransform:"none",float:"right"},disabled:!0,color:"primary"},r.a.createElement(ct.a,{color:"disabled",className:a.textIcon})," Calibrate")),r.a.createElement("div",null,r.a.createElement(Rt,{client:u,disabled:!o,config:e.config,unit:i})),r.a.createElement(Ft,{config:e.config,client:u,stirringJobState:f,ODReadingJobState:y,growthRateJobState:j,dosingControlJobState:D,ledControlJobState:V,temperatureControlJobState:U,stirringDC:Z,stirringDynamic:te,targetGrowthRate:Ee,volume:xe,duration:pe,targetOD:ie,targetTemperature:se,dosingAutomation:Se,ledAutomation:Ne,tempAutomation:Le,experiment:l,unit:i,disabled:!o})))),r.a.createElement("div",{style:{display:"flex",margin:"15px 20px 20px 0px",flexDirection:"row"}},r.a.createElement("div",{className:a.textboxLabel},r.a.createElement(B.a,{variant:"body2"},r.a.createElement(F.a,{fontWeight:"fontWeightBold",className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Activities:"))),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"stretch",alignContent:"stretch"}},r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Stirring"),r.a.createElement(Dt,{value:f,isUnitActive:o,default:"disconnected",isStateSetting:!0})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Optical density"),r.a.createElement(Dt,{value:y,isUnitActive:o,default:"disconnected",isStateSetting:!0})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Growth rate"),r.a.createElement(Dt,{value:j,isUnitActive:o,default:"disconnected",isStateSetting:!0})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Dosing control"),r.a.createElement(Dt,{value:D,isUnitActive:o,default:"disconnected",subtext:Se,isStateSetting:!0})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"LED control"),r.a.createElement(Dt,{value:V,isUnitActive:o,default:"disconnected",subtext:Ne,isStateSetting:!0})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Temperature control"),r.a.createElement(Dt,{value:U,isUnitActive:o,subtext:Le,default:"NA",isStateSetting:!0})))),r.a.createElement($.a,null),r.a.createElement("div",{style:{display:"flex",margin:"15px 20px 20px 0px",flexDirection:"row"}},r.a.createElement("div",{className:a.textboxLabel},r.a.createElement(B.a,{variant:"body2"},r.a.createElement(F.a,{fontWeight:"fontWeightBold",className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Settings:"))),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"stretch",alignContent:"stretch"}},r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Stirring speed"),r.a.createElement(Dt,{value:Z,isUnitActive:o,default:"\u2014",className:a.alignRight})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Volume / dosing"),r.a.createElement(Dt,{precision:2,measurementUnit:"mL",value:xe,isUnitActive:o,default:"\u2014",className:a.alignRight})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Target OD"),r.a.createElement(Dt,{precision:2,value:ie,measurementUnit:" AU",isUnitActive:o,default:"\u2014",className:a.alignRight})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Target growth rate"),r.a.createElement(Dt,{precision:2,measurementUnit:"h\u207b\xb9",value:Ee,isUnitActive:o,default:"\u2014",className:a.alignRight})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Time between dosing events"),r.a.createElement(Dt,{precision:0,measurementUnit:"m",value:pe,isUnitActive:o,default:"\u2014",className:a.alignRight})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"LED intensity"),r.a.createElement(Dt,{value:ze,isUnitActive:o,default:"\u2014",className:a.alignRight,isLEDIntensity:!0})),r.a.createElement("div",{className:a.textbox},r.a.createElement(B.a,{variant:"body2",style:{fontSize:"0.82rem"},className:Object(N.a)(Object(C.a)({},a.disabledText,!o))},"Target temperature"),r.a.createElement(Dt,{precision:2,value:se,measurementUnit:"\u2103",isUnitActive:o,default:"\u2014",className:a.alignRight}))))))}function Wt(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",marginTop:"15px"}},r.a.createElement(B.a,{variant:"h5",component:"h2"},r.a.createElement(F.a,{fontWeight:"fontWeightRegular"},"Inactive Pioreactors"))),e.units.map((function(t){return r.a.createElement(It,{isUnitActive:!1,key:t,unit:t,config:e.config,experiment:e.experiment})})))}var Ut=function(e){var t=r.a.useState({}),a=Object(m.a)(t,2),n=a[0],i=a[1];r.a.useEffect((function(){function t(){return(t=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){i(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}document.title=e.title,function(){t.apply(this,arguments)}()}),[e.title]);var o=function(e){return Object.entries(e)};return r.a.createElement(x.a,{container:!0,spacing:2},r.a.createElement(x.a,{item:!0,md:12,xs:12},r.a.createElement(Lt,{config:e.config,experiment:n.experiment}),r.a.createElement(zt,{experiment:n.experiment,config:e.config,units:e.config["network.inventory"]?o(e.config["network.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]})):[]}),r.a.createElement(Wt,{experiment:n.experiment,config:e.config,units:e.config["network.inventory"]?o(e.config["network.inventory"]).filter((function(e){return"0"===e[1]})).map((function(e){return e[0]})):[]})),e.config["ui.rename"]?r.a.createElement(y,{config:e.config}):null)},Ht=a(577),Yt=a(548),Jt=a(570),Vt=a(580),$t=a(215),qt=Object(Fe.a)((function(e){return{root:{width:"100%"},button:{marginTop:e.spacing(1),marginRight:e.spacing(1)},actionsContainer:{marginBottom:e.spacing(2)},resetContainer:{padding:e.spacing(3)},divInstructions:{marginBottom:e.spacing(3)}}}));function Gt(e){var t=qt(),a=e.liquid,n=r.a.useState(!1),i=Object(m.a)(n,2),o=i[0],l=i[1];return r.a.createElement("div",{className:t.divInstructions},r.a.createElement("p",null,e.additionalMsg),r.a.createElement("p",null,"Add ",r.a.createElement("b",null,a)," to the non-waste containers. We will cycle this solution through our system. Click the button below once the ",a," is in place."),r.a.createElement(w.a,{className:t.button,variant:"contained",color:o?"default":"primary",onClick:function(){fetch("/run/remove_waste/$broadcast",{method:"POST",body:JSON.stringify({duration:90,duty_cycle:100}),headers:{Accept:"application/json","Content-Type":"application/json"}}),fetch("/run/add_media/$broadcast",{method:"POST",body:JSON.stringify({duration:50,duty_cycle:55}),headers:{Accept:"application/json","Content-Type":"application/json"}}),fetch("/run/add_alt_media/$broadcast",{method:"POST",body:JSON.stringify({duration:50,duty_cycle:55}),headers:{Accept:"application/json","Content-Type":"application/json"}}),l(!0)}},"Cycle ",a))}function Kt(e){var t=qt(),a=e.altMedia,n=r.a.useState(!1),i=Object(m.a)(n,2),o=i[0],l=i[1];return r.a.createElement("div",{className:t.divInstructions},r.a.createElement("p",null,"Next, we will prime the ",a?"alt-":"","media tubes with our ",a?"alt-":"","media."),r.a.createElement("p",null,"Replace the container attached to the ",a?"alt-":"","media outflow tubes with the sterlized ",a?"alt-":"","media container. Remember to use proper sanitation techniques!"),r.a.createElement(w.a,{className:t.button,variant:"contained",color:o?"default":"primary",onClick:function(){fetch("/run/remove_waste/$broadcast",{method:"POST",body:JSON.stringify({duration:90,duty_cycle:100}),headers:{Accept:"application/json","Content-Type":"application/json"}}),a?fetch("/run/add_alt_media/$broadcast",{method:"POST",body:JSON.stringify({duration:50,duty_cycle:66}),headers:{Accept:"application/json","Content-Type":"application/json"}}):fetch("/run/add_media/$broadcast",{method:"POST",body:JSON.stringify({duration:50,duty_cycle:55}),headers:{Accept:"application/json","Content-Type":"application/json"}}),l(!0)}},"Run ",a?"alt-":"","media and waste pumps"))}function Zt(e){var t=qt(),a=r.a.useState(!1),n=Object(m.a)(a,2),i=n[0],o=n[1];return r.a.createElement("div",{className:t.divInstructions},r.a.createElement("p",null," Finally, we will add fresh media to our vials "),r.a.createElement(w.a,{className:t.button,variant:"contained",color:i?"default":"primary",onClick:function(){fetch("/run/add_media/$broadcast",{method:"POST",body:JSON.stringify({ml:12}),headers:{Accept:"application/json","Content-Type":"application/json"}}),o(!0)}},"Add 12mL of media"))}function Qt(){var e=qt(),t=r.a.useState(0),a=Object(m.a)(t,2),n=a[0],i=a[1],o=["Setup inflow and outflow tubes","10% bleach cycling","70% alcohol cycling","Distilled water cycling","Media preparation","Alt media preparation","Replace vials","Add initial media to vials"],l=function(){i((function(e){return e+1}))},c=function(){i((function(e){return e-1}))};return r.a.createElement("div",{className:e.root},r.a.createElement(Ht.a,{activeStep:n,orientation:"vertical"},o.map((function(t,a){return r.a.createElement(Yt.a,{key:t},r.a.createElement(Jt.a,null,t),r.a.createElement(Vt.a,null,r.a.createElement(B.a,null,function(e){switch(e){case 0:return"For each pioreactor unit, connect the media inflow, alt-media inflow, and waste out flow tubes to an empty\n      vial with hat. Connect the all the media outflow tubes to a single empty container, all the alt-media outflow tubes to a single empty container, and\n      all the waste inflow tubes to a single, empty, large container.";case 1:return r.a.createElement(Gt,{liquid:"10% bleach solution"});case 2:return r.a.createElement(Gt,{additionalMsg:"Remove any excess bleach from the containers, and empty the waste container. Bleach and alcohol should not mix.",liquid:"70% alcohol"});case 3:return r.a.createElement(Gt,{liquid:"distilled water"});case 4:return r.a.createElement(Kt,null);case 5:return r.a.createElement(Kt,{altMedia:!0});case 6:return"Using proper sanitation techniques, replace the pioreactor vials - now full of water and media - with the empty-but-innocculated vials";case 7:return r.a.createElement(Zt,null);default:return"Unknown step"}}(a)),r.a.createElement("div",{className:e.actionsContainer},r.a.createElement(w.a,{disabled:0===n,onClick:c,className:e.button},"Back"),r.a.createElement(w.a,{variant:"contained",onClick:l,className:e.button},n===o.length-1?"Finish":"Next"))))}))),n===o.length&&r.a.createElement($t.a,{square:!0,elevation:0,className:e.resetContainer},r.a.createElement(B.a,null,"All cleaning and preparation steps completed!"),r.a.createElement(w.a,{onClick:function(){i(0)},className:e.button},"Reset")))}function Xt(e){var t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),l=Object(m.a)(o,2),c=l[0],s=l[1];return r.a.createElement("div",null,r.a.createElement("p",null," To get an accurate reading, we need to start start the stirring. This also provides gas transfer and keeps the cells in suspension."),r.a.createElement(w.a,{variant:"contained",color:"primary",disabled:!!n,onClick:function(e){i(!0),fetch("/run/stirring/$broadcast",{method:"POST"}).then((function(e){200===e.status&&s(!0)}))}}," Start stirring "),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:c,onClose:function(){s(!1)},message:"Stirring starting",autoHideDuration:7e3,key:"snackbarStirring"}))}function ea(e){var t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),l=Object(m.a)(o,2),c=l[0],s=l[1];return r.a.createElement("div",null,r.a.createElement("p",null," Next, we will turn on the optical density reading. We also call this ",r.a.createElement("em",null,"OD readings"),". This will provide us with a measure of cell density. After a minute or so, you should see the data in the chart below. "),r.a.createElement(w.a,{variant:"contained",color:"primary",disabled:!!n,onClick:function(e){i(!0),fetch("/run/od_reading/$broadcast",{method:"POST"}).then((function(e){200===e.status&&s(!0)}))}}," Start OD readings "),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:c,onClose:function(){s(!1)},message:"OD reading starting",autoHideDuration:7e3,key:"snackbarOD"}))}var ta=function(e){return r.a.createElement(x.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"center",spacing:2},r.a.createElement(x.a,{item:!0,xs:2}),r.a.createElement(x.a,{item:!0,xs:10},r.a.createElement(Xt,null)),r.a.createElement(x.a,{item:!0,xs:10},r.a.createElement(ea,null)),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,isODReading:!0,fontScale:1,interpolation:"stepAfter",title:"Optical density",topic:"od_raw/+/+",yAxisLabel:"Voltage",experiment:"+"})),r.a.createElement(x.a,{item:!0,xs:2}))};function aa(e){var t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=r.a.useState(""),l=Object(m.a)(o,2),c=l[0],s=l[1],u=r.a.useState(!1),d=Object(m.a)(u,2),p=d[0],g=d[1];return r.a.createElement("div",null,r.a.createElement("p",null,"Because of the varying strength & quality of the electronics, not all readings look the same - even for the same density of cells. So we compute a baseline measurement from the OD readings, and measure all growth against that baseline. "),r.a.createElement("p",null,"From the (normalized) OD readings, we can calculate the ",r.a.createElement("em",null,"implied hourly growth rate"),", which is our measure of growth. "),r.a.createElement("p",null,"Let's start the growth rate calculations. This first computes the normalization constants, ",r.a.createElement("b",null,"which can take up to two minutes to complete"),". After that, the graph below should start to populate."),r.a.createElement(w.a,{variant:"contained",color:"primary",disabled:!!p,onClick:function(e){fetch("/run/growth_rate_calculating/$broadcast",{method:"POST"}).then((function(e){s("Growth rate calculating starting"),i(!0),g(!0)}))}}," Start growth rate calculations "),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:function(){i(!1)},message:c,autoHideDuration:7e3,key:"snackbarGR"}))}var na=function(e){var t=r.a.useState("null_exp"),a=Object(m.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){function e(){return(e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){i(e.experiment)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(x.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"center",spacing:2},r.a.createElement(x.a,{item:!0,xs:2}),r.a.createElement(x.a,{item:!0,xs:10},r.a.createElement(aa,{experiment:n})),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(Te,{config:e.config,interpolation:"stepAfter",fontScale:1,title:"Implied growth rate",topic:"growth_rate",yAxisLabel:"Growth rate, h\u207b\xb9",experiment:n})),r.a.createElement(x.a,{item:!0,xs:2}))};var ra=function(e,t){var a;a=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ClearChartButton"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_ClearChartButton"+Math.random()),t&&(a.onMessageDelivered=t),a.connect({onSuccess:function(){for(var t=0,n=["od_raw","od_filtered","growth_rate","alt_media_fraction"];t<n.length;t++){var r=n[t],i=new h.Message("");i.destinationName=["pioreactor",e.config["network.topology"].leader_hostname,"$experiment","".concat(r,"_time_series_aggregating"),"aggregated_time_series","set"].join("/"),a.publish(i)}}})},ia=Object(Fe.a)((function(e){return{root:{marginTop:"15px"},cardContent:{padding:"10px"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(2),marginBottom:e.spacing(4),marginLeft:"auto",marginRight:"auto",width:"60%"},textField:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},formControl:{margin:e.spacing(3)},halfTextField:{width:"95%"}}}));function oa(e){var t=ia(),a=r.a.useState(!1),n=Object(m.a)(a,2),i=n[0],o=n[1],l=r.a.useState(""),c=Object(m.a)(l,2),s=c[0],u=c[1],d=r.a.useState(""),p=Object(m.a)(d,2),g=p[0],f=p[1],E=r.a.useState(D.a.utc()),b=Object(m.a)(E,2),v=b[0],y=b[1],C=r.a.useState(""),O=Object(m.a)(C,2),S=O[0],j=O[1];return r.a.createElement("div",{className:t.root},r.a.createElement(Re.a,null,r.a.createElement(x.a,{container:!0,spacing:1},r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(Ze.a,{error:i,id:"expName",label:"Experiment name",required:!0,className:"".concat(t.halfTextField," ").concat(t.textField),onChange:function(e){f(e.target.value.trim())},helperText:s})),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(Ze.a,{id:"datetime",label:"Start time",type:"datetime-local",defaultValue:v.local().format("YYYY-MM-DDTHH:mm:ss"),className:"".concat(t.halfTextField," ").concat(t.textField),onChange:function(e){y(e.target.value)},InputLabelProps:{shrink:!0}})),r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(Ze.a,{label:"Description",rowsMax:4,placeholder:"Add a description: what microbe are you using? What is the media composition? This description can always be changed later.",multiline:!0,className:t.textField,onChange:function(e){j(e.target.value)},fullWidth:!0})),r.a.createElement(x.a,{item:!0,xs:12,md:10}),r.a.createElement(x.a,{item:!0,xs:12,md:2},r.a.createElement(w.a,{variant:"contained",color:"primary",onClick:function(t){if(t.preventDefault(),""===g)return o(!0),void u("Can't be blank");fetch("create_experiment",{method:"POST",body:JSON.stringify({experiment:g,timestamp:v.toISOString(),description:S}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){200===t.status?(!function(){var t;(t=e.config.remote&&e.config.remote.ws_url?new h.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_publishExpNameToMQTT"+Math.random()):new h.Client("".concat(e.config["network.topology"].leader_address),9001,"webui_publishExpNameToMQTT"+Math.random())).connect({onSuccess:function(){var e=new h.Message(g);e.destinationName="pioreactor/latest_experiment",e.qos=1,e.retained=!0,t.publish(e)},timeout:180})}(),u(""),o(!1),fetch("/stop_all",{method:"POST"}),ra(e),e.handleNext()):(o(!0),u("Experiment name already used."))}))}}," Create ")))))}function la(e){var t=ia(),a=r.a.useState(0),n=Object(m.a)(a,2),i=n[0],o=n[1],l=r.a.useState(new Set),c=Object(m.a)(l,2),s=c[0],u=c[1],d=function(e){return f[e].optional},p=function(e){return s.has(e)},g=function(){if(i===f.length-1)window.location.href="/overview";else{var e=s;p(i)&&(e=new Set(e.values())).delete(i),o((function(e){return e+1})),u(e),window.scrollTo({top:0})}},f=[{title:"Experiment summary",content:r.a.createElement(oa,{config:e.config,handleNext:g}),optional:!0},{title:"Cleaning and preparation",content:r.a.createElement(Qt,{config:e.config}),optional:!0},{title:"Start sensors",content:r.a.createElement(ta,{config:e.config}),optional:!0},{title:"Start calculations",content:r.a.createElement(na,{config:e.config}),optional:!1}];return r.a.createElement(P.a,{className:t.root},r.a.createElement(P.a,{className:t.cardContent},r.a.createElement(B.a,{variant:"h5",component:"h1"},"Start a new experiment"),r.a.createElement(Ht.a,{activeStep:i},f.map((function(e,t){var a={},n={};return e.optional&&(n.optional=r.a.createElement(B.a,{variant:"caption"},"Optional")),p(t)&&(a.completed=!1),r.a.createElement(Yt.a,Object.assign({key:e.title},a),r.a.createElement(Jt.a,n,e.title))}))),r.a.createElement("div",null,i===f.length?r.a.createElement("div",null,r.a.createElement(B.a,{className:t.instructions},"All steps completed - you're finished"),r.a.createElement(w.a,{onClick:function(){o(0)},className:t.button},"Reset")):r.a.createElement("div",null,r.a.createElement(B.a,{className:t.instructions},f[i].content),r.a.createElement("div",null,r.a.createElement(w.a,{disabled:0===i,onClick:function(){o((function(e){return e-1}))},className:t.button},"Back"),d(i)&&r.a.createElement(w.a,{variant:"contained",onClick:function(){if(!d(i))throw new Error("You can't skip a step that isn't optional.");o((function(e){return e+1})),u((function(e){var t=new Set(e.values());return t.add(i),t}))},className:t.button},"Skip"),r.a.createElement(w.a,{variant:"contained",onClick:g,className:t.button},i===f.length-1?"Go to overview":"Next"))))))}var ca=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(x.a,{container:!0,spacing:2},r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(la,{config:e.config})))},sa=a(290),ma=Object(Fe.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0}}})),ua=function(e){Object(_.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(O.a)(this,a),(n=t.call(this,e)).onSelectionChange=function(e){n.setState({filename:e.target.value}),n.getConfig(e.target.value)},n.getCodeFlaskRef=function(e){n.codeFlask=e},n.onTextChange=function(e){n.setState({code:e})},n.handleSnackbarClose=function(){n.setState({openSnackbar:!1})},n.state={code:"",openSnackbar:!1,filename:"config.ini",snackbarMsg:"",isRunning:!1,availableConfigs:[{name:"shared config.ini",filename:"config.ini"}]},n.saveCurrentCode=n.saveCurrentCode.bind(Object(j.a)(n)),n.deleteConfig=n.deleteConfig.bind(Object(j.a)(n)),n}return Object(S.a)(a,[{key:"getConfig",value:function(){var e=Object(s.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_config/"+t).then((function(e){return e.text()})).then((function(e){a.setState({code:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getListOfConfigFiles",value:function(){var e=Object(s.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_configs").then((function(e){return e.json()})).then((function(e){a.setState((function(t){return{availableConfigs:[].concat(Object(he.a)(t.availableConfigs),Object(he.a)(e.filter((function(e){return"config.ini"!==e})).map((function(e){return{name:e,filename:e}}))))}}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveCurrentCode",value:function(){var e=this;this.setState({isRunning:!0}),fetch("/save_new_config",{method:"POST",body:JSON.stringify({code:this.state.code,filename:this.state.filename}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?e.setState({snackbarMsg:e.state.filename+" saved and synced."}):e.setState({snackbarMsg:"Hm. Something when wrong saving or syncing..."}),e.setState({openSnackbar:!0,isRunning:!1})}))}},{key:"deleteConfig",value:function(){var e=this;fetch("/delete_config",{method:"POST",body:JSON.stringify({filename:this.state.filename}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?e.setState({snackbarMsg:e.state.filename+" deleted."}):e.setState({snackbarMsg:"Hm. Something when wrong deleting..."}),e.setState({openSnackbar:!0}),setTimeout((function(){window.location.reload()}),750)}))}},{key:"componentDidMount",value:function(){this.getConfig(this.state.filename),this.getListOfConfigFiles()}},{key:"render",value:function(){var e=this.state.isRunning?r.a.createElement(He.a,{color:"inherit",size:24}):"Save";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(Ue.a,{style:{margin:"10px 10px 10px 10px"},native:!0,value:this.state.filename,onChange:this.onSelectionChange,inputProps:{name:"config",id:"config"}},this.state.availableConfigs.map((function(e){return r.a.createElement("option",{key:e.filename,value:e.filename},e.name)})))),r.a.createElement("div",{style:{letterSpacing:"0em",margin:"10px auto 10px auto",position:"relative",width:"98%",height:"300px",border:"1px solid #ccc"}},r.a.createElement(sa.CodeFlaskReact,{code:this.state.code,onChange:this.onTextChange,editorRef:this.getCodeFlaskRef,language:"python"})),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(w.a,{style:{margin:"5px 12px 5px 12px"},color:"primary",variant:"contained",onClick:this.saveCurrentCode},e),r.a.createElement(w.a,{style:{margin:"5px 10px 5px 10px"},color:"secondary",onClick:this.deleteConfig,disabled:"config.ini"===this.state.filename},"Delete config file")),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:this.state.openSnackbar,onClose:this.handleSnackbarClose,message:this.state.snackbarMsg,autoHideDuration:2e3,key:"edit-config-snackbar"}))}}]),a}(r.a.Component);function da(){var e=ma();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(B.a,{variant:"h5",component:"h2"},r.a.createElement(F.a,{fontWeight:"fontWeightBold"},"Configuration")))),r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement("p",null,"Update the ",r.a.createElement("code",null,"config.ini")," files. The shared ",r.a.createElement("code",null,"config.ini")," will be deployed to ",r.a.createElement("em",null,"all")," Pioreactors, but configuration can be overwritten by editing specific Pioreactor's ",r.a.createElement("code",null,"config.ini"),". ",r.a.createElement("a",{href:"https://pioreactor.com/pages/Configuration-via-config-ini",target:"_blank",rel:"noopener noreferrer"},"Learn more about Pioreactor configuration"),"."),r.a.createElement(ua,null))))}var pa=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(x.a,{container:!0,spacing:2},r.a.createElement(x.a,{item:!0,md:12,xs:12},r.a.createElement(da,null)))},ga=a(549),fa=a(141),ha=a.n(fa),Ea=a(291),ba=a.n(Ea),va=a(180),ya=a.n(va),xa=Object(Fe.a)((function(e){return{title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"}}}));function wa(){var e=xa(),t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),l=Object(m.a)(o,2),c=l[0],s=l[1],u=function(){i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{onClick:function(){i(!0)},style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(ha.a,{className:e.textIcon})," Update to latest release"),r.a.createElement(le.a,{open:n,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(oe.a,{id:"alert-dialog-title"},"Confirm update to latest release"),r.a.createElement(ce.a,null,r.a.createElement(me.a,{id:"alert-dialog-description"},"Updating will not stop or change currently running activities or experiments.")),r.a.createElement(se.a,null,r.a.createElement(w.a,{onClick:function(){i(!1),s(!0),fetch("/update_app",{method:"POST"}).then((function(e){if(e.ok)return window.location.reload(),!1}))},color:"primary"},"Update now"),r.a.createElement(w.a,{onClick:u,color:"secondary",autoFocus:!0},"Cancel"))),r.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:c,message:"Updating in the background - you may leave this page",autoHideDuration:2e4,key:"snackbar-update"}))}function Ca(e){var t=xa(),a=r.a.useState(""),n=Object(m.a)(a,2),i=n[0],o=n[1],l=r.a.useState(""),u=Object(m.a)(l,2),d=u[0],p=u[1];return r.a.useEffect((function(){function e(){return(e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_app_version").then((function(e){return e.text()})).then((function(e){o(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/repos/pioreactor/pioreactor/releases/latest").then((function(e){return e.json()})).then((function(e){p(e.name)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement(B.a,{variant:"h5",component:"h1"},r.a.createElement(F.a,{fontWeight:"fontWeightBold"},"Updates")),r.a.createElement("div",null,r.a.createElement(wa,null),r.a.createElement(ga.a,{color:"inherit",underline:"none",href:"https://github.com/Pioreactor/pioreactor/releases",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(w.a,{style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(ya.a,{className:t.textIcon})," View latest release")))),r.a.createElement($.a,null),r.a.createElement(B.a,{variant:"subtitle2"},r.a.createElement(F.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(ba.a,{style:{fontSize:14,verticalAlign:"middle"}})," Version installed:"),r.a.createElement(F.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},i),r.a.createElement(F.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(ha.a,{style:{fontSize:14,verticalAlign:"middle"}})," Latest version available:"),r.a.createElement(F.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},d))))}function Oa(){var e=xa(),t=r.a.useState(""),a=Object(m.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){function e(){return(e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_changelog").then((function(e){return e.text()})).then((function(e){i(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement(B.a,{variant:"h6",component:"h6"},"Change log"),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:n}}))))}var Sa=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(x.a,{container:!0,spacing:2},r.a.createElement(x.a,{item:!0,md:12,xs:12},r.a.createElement(Ca,null),r.a.createElement(Oa,null)))},ja=a(578),_a=a(541),ka=a(550),Na=a(553),Ta=a(551),Da=a(552),Aa=a(294),Pa=a.n(Aa),La=a(460),Ba=a(293),Fa=a.n(Ba),Ma=a(292),za=a.n(Ma),Ra=a(210),Ia=a.n(Ra),Wa=a(555),Ua=a(554),Ha=a(567),Ya=Object(Fe.a)((function(e){return{root:{display:"flex"},drawer:Object(C.a)({},e.breakpoints.up("sm"),{width:240,flexShrink:0}),menuButton:Object(C.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),drawerPaper:{width:240},appBar:{zIndex:e.zIndex.drawer+1},title:{flexGrow:1},appBarRoot:{flexGrow:1},hiddenIconContainer:{"&:hover $hiddenIcon":{color:"rgba(0, 0, 0, 0.54)"}},hiddenIcon:{color:"rgba(0, 0, 0, 0)",fontSize:"18px"}}}));function Ja(){var e=Ya(),t=r.a.useState(!1),a=Object(m.a)(t,2),n=a[0],i=a[1],o=function(){i(!n)};function l(e){return window.location.pathname===e}var c=function(){return r.a.createElement("div",{className:e.drawerContainer},r.a.createElement(_a.a,null,r.a.createElement(ka.a,{href:"/overview",component:"a",button:!0,key:"overview",selected:l("/")||l("/overview")},r.a.createElement(Ta.a,null,r.a.createElement(za.a,{color:l("/")||l("/overview")?"primary":"inherit"})," "),r.a.createElement(Da.a,{primaryTypographyProps:{color:l("/")||l("/overview")?"primary":"inherit"},primary:"Overview"})),r.a.createElement(ka.a,{button:!0,href:"/pioreactors",component:"a",key:"pioreactors",selected:l("/pioreactors")},r.a.createElement(Ta.a,null," ",r.a.createElement(Ae,{color:l("/pioreactors")?"primary":"inherit"})," "),r.a.createElement(Da.a,{primaryTypographyProps:{color:l("/pioreactors")?"primary":"inherit"},primary:"Pioreactors"}))),r.a.createElement($.a,null),r.a.createElement(_a.a,null,r.a.createElement(ka.a,{button:!0,href:"/config",component:"a",key:"config",selected:l("/config")},r.a.createElement(Ta.a,null," ",r.a.createElement(ot.a,{color:l("/config")?"primary":"inherit"})," "),r.a.createElement(Da.a,{primaryTypographyProps:{color:l("/config")?"primary":"inherit"},primary:"Configuration"})),r.a.createElement(ka.a,{href:"/export-data",component:"a",button:!0,key:"export_data",selected:l("/export-data")},r.a.createElement(Ta.a,null,r.a.createElement(Fa.a,{color:l("/export-data")?"primary":"inherit"})," "),r.a.createElement(Da.a,{primaryTypographyProps:{color:l("/export-data")?"primary":"inherit"},primary:"Export data"}))),r.a.createElement($.a,null),r.a.createElement(_a.a,null,r.a.createElement(ka.a,{href:"/updates",component:"a",button:!0,key:"updates",selected:l("/updates")},r.a.createElement(Ta.a,null,r.a.createElement(ha.a,{color:l("/updates")?"primary":"inherit"})," "),r.a.createElement(Da.a,{primaryTypographyProps:{color:l("/updates")?"primary":"inherit"},primary:"Updates"})),r.a.createElement("div",{className:e.hiddenIconContainer},r.a.createElement(ka.a,{target:"_blank",rel:"noopener noreferrer",href:"https://pioreactor.com/pages/documentation",component:"a",button:!0,key:"help"},r.a.createElement(Ta.a,null,r.a.createElement(Ia.a,null)," "),r.a.createElement(Da.a,{primary:"Help"}),r.a.createElement(Na.a,null,r.a.createElement(ya.a,{className:e.hiddenIcon}))))))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.appBarRoot},r.a.createElement(Ua.a,{position:"fixed",className:e.appBar},r.a.createElement(Wa.a,{variant:"dense"},r.a.createElement(La.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:o,className:e.menuButton},r.a.createElement(Pa.a,null)),r.a.createElement(B.a,{variant:"h6",className:e.title},r.a.createElement(ga.a,{color:"inherit",underline:"none",href:"/",className:e.title}," ",r.a.createElement("img",{alt:"pioreactor logo",src:"white_colour.png",style:{width:"120px",height:"29px"}})," ")),r.a.createElement(ga.a,{color:"inherit",underline:"none",href:"https://pioreactor.com/pages/documentation",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(w.a,{color:"inherit",style:{textTransform:"none"}},"Help ",r.a.createElement(Ia.a,{style:{fontSize:18,verticalAlign:"middle",marginLeft:5}})))))),r.a.createElement(Ha.a,{smUp:!0,implementation:"css"},r.a.createElement(ja.a,{variant:"temporary",anchor:"left",open:n,onClose:o,classes:{paper:e.drawerPaper},ModalProps:{keepMounted:!0}},c())),r.a.createElement(Ha.a,{xsDown:!0,implementation:"css"},r.a.createElement(ja.a,{classes:{paper:e.drawerPaper},variant:"permanent",open:!0,className:e.drawer},r.a.createElement(Wa.a,null),c())))}a(451),a(452),a(453),a(454),a(265);var Va=Object(p.a)({palette:{background:{default:"#f6f6f7"},primary:{main:"#5331CA"}}});var $a=function(){var e=r.a.useState({}),t=Object(m.a)(e,2),a=t[0],n=t[1];return r.a.useEffect((function(){function e(){return(e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_config/config.ini").then((function(e){if(e.ok)return e.text();throw new Error("Something went wrong")})).then((function(e){n(st(e))})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(g.a,{theme:Va},r.a.createElement(f.a,null),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Ja,null),r.a.createElement("main",{style:{flexGrow:1,paddingTop:Va.spacing(9),paddingLeft:Va.spacing(4),paddingRight:Va.spacing(4)}},r.a.createElement(u.a,null,r.a.createElement("div",{className:"pageContainer"},r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/export-data"},r.a.createElement(qe,{config:a,title:"Pioreactor ~ Export data"}),r.a.createElement(y,{config:a})),r.a.createElement(d.a,{path:"/start-new-experiment"},r.a.createElement(ca,{config:a,title:"Pioreactor ~ Start new experiment"}),r.a.createElement(y,{config:a})),r.a.createElement(d.a,{path:"/overview"},r.a.createElement(Be,{config:a,title:"Pioreactor ~ Overview"})),r.a.createElement(d.a,{path:"/config"},r.a.createElement(pa,{config:a,title:"Pioreactor ~ Configuration"}),r.a.createElement(y,{config:a})),"f",r.a.createElement(d.a,{path:"/pioreactors"},r.a.createElement(Ut,{config:a,title:"Pioreactor ~ Pioreactors"})),r.a.createElement(d.a,{path:"/Updates"},r.a.createElement(Sa,{config:a,title:"Pioreactor ~ Updates"}),r.a.createElement(y,{config:a})),r.a.createElement(d.a,{path:"/"},r.a.createElement(Be,{config:a,title:"Pioreactor ~ Pioreactor"}))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($a,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[326,1,2]]]);
//# sourceMappingURL=main.4d9f4dff.chunk.js.map