{"version":3,"sources":["components/TactileButtonNotification.jsx","components/PioreactorIcon.jsx","components/Drawer.jsx","components/Header.jsx","components/LogTable.jsx","components/ExperimentSummary.jsx","components/Chart.jsx","components/MediaCard.jsx","components/ClearChartButton.jsx","components/ClearLogButton.jsx","utilities.js","ExperimentOverview.jsx","DownloadData.jsx","components/ButtonChangeDosingDialog.jsx","components/ActionPumpForm.jsx","Pioreactors.jsx","components/CleaningScript.jsx","components/StartSensors.jsx","components/StartCalculations.jsx","StartNewExperiment.jsx","EditConfig.jsx","App.jsx","serviceWorker.js","index.js"],"names":["TactileButtonNotification","props","React","useState","unit","setUnit","renamedUnit","setRenamedUnit","open","setOpen","useEffect","config","client","remote","Client","ws_url","Math","random","connect","onSuccess","subscribe","join","qos","onMessageArrived","msg","payloadString","topic","split","Snackbar","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","key","Alert","severity","variant","icon","AlertTitle","style","fontSize","PioreactorIcon","SvgIcon","id","stroke","strokeWidth","fill","fillRule","transform","primary","disabled","black","color","d","cx","cy","r","SideDrawer","isOpen","setIsOpen","isSelected","path","window","location","pathname","toggleDrawer","event","type","Fragment","IconButton","aria-label","edge","onClick","Drawer","anchor","onOpen","role","onKeyDown","alt","src","width","marginLeft","marginTop","List","ListItem","href","component","button","selected","ListItemIcon","ListItemText","Divider","useStyles","makeStyles","theme","root","flexGrow","title","Header","classes","className","AppBar","position","Toolbar","Typography","Link","underline","height","target","rel","Button","textTransform","verticalAlign","LogTable","state","listOfLogs","onConnect","bind","fetch","then","response","json","data","setState","this","getData","message","length","pop","payload","unshift","timestamp","moment","format","is_error","includes","string","slice","name","Card","CardContent","Box","fontWeight","TableContainer","overflowY","Table","stickyHeader","size","TableHead","TableRow","TableCell","clsx","headerCell","TableBody","map","log","i","tightCell","smallText","errorLog","renameUnit","Component","withStyles","padding","backgroundColor","tightRight","textAlign","cardContent","pos","marginBottom","textIcon","margin","EditableDescription","handleChange","evt","desc","value","onBlur","originalDesc","method","body","JSON","stringify","experiment","description","headers","res","status","openSnackBar","handleSnackbarClose","e","reason","render","innerRef","contentEditable","html","onChange","tagName","createRef","prevProps","ExperimentSummary","experimentMetadata","startedAt","display","justifyContent","marginRight","float","diff","colors","Chart","createToolTip","datum","x","renameAndFormatSeries","childName","round","y","seriesMap","maxTimestamp","parseInt","hiddenSeries","Set","lastMsgRecievedAt","names","legendEvents","minTimestamp","subtract","selectLegendData","selectVictoryLines","dataFile","initialSeriesMap","entries","v","filter","filterDataPoints","Object","keys","mts","min","values","s","createLegendEvents","idx","eventKey","String","eventHandlers","mutation","delete","add","retained","currentTime","isODReading","push","parseFloat","newSeriesMap","error","console","match","results","index","sensor","breakString","totalLength","delta_ts","startValue","stopValue","cardinality","arr","step","linspace","startOf","mt","line","item","symbol","has","interpolation","labels","parent","border","VictoryVoronoiContainer","createContainer","axis_display_ts_format","ts","createXTickValues","maxHeight","domainPadding","left","right","bottom","top","events","responsive","VictoryTheme","material","containerComponent","voronoiBlacklist","labelComponent","cornerRadius","flyoutStyle","text","textAnchor","fontFamily","tickFormat","formatTs","tickValues","tickLabels","offsetY","orientation","crossAxis","dependentAxis","domain","label","yAxisLabel","axisLabelComponent","dy","symbolSpacer","itemsPerRow","borderPadding","cursor","gutter","MediaCard","mediaThroughputPerUnit","altMediaThroughputPerUnit","mediaThroughput","altMediaThroughput","rates","all","mediaRate","altMediaRate","prevState","getRecentRates","hash","object","hasOwnProperty","topicParts","destinationName","objectRef","totalRef","addOrUpdate","total","reduce","a","b","align","scope","ClearChartButton","jobName","Message","publish","reload","ClearLogButton","parseINIString","regex","section","param","comment","lines","forEach","test","Overview","setExperimentMetadata","getLatestExperiment","Grid","container","spacing","justify","xs","paddingRight","md","paddingLeft","formControl","ExperimentSelection","experiments","setExperiments","FormControl","FormLabel","Select","native","inputProps","CheckboxesGroup","FormGroup","FormControlLabel","control","Checkbox","checked","isChecked","growth_rates","io_events","od_readings_raw","od_readings_filtered","logs","alt_media_fraction","io_algorithm_settings","DownloadDataFormContainer","isRunning","setIsRunning","isError","setIsError","errorMsg","setErrorMsg","experimentSelection","datasetCheckbox","runningFeedback","CircularProgress","errorFeedbackOrDefault","preventDefault","some","link","document","createElement","setAttribute","appendChild","click","remove","catch","DownloadData","textFieldCompact","unitTitle","unitTitleDialog","suptitle","SilentForm","defaults","duration","updateParent","TextField","defaultValue","InputProps","endAdornment","InputAdornment","PIDTurbidostatForm","volume","target_od","onSettingsChange","PIDMorbidostatForm","target_growth_rate","ButtonChangeDosingDialog","io_algorithm","algoSettings","setAlgoSettings","isClicked","setIsClicked","setClient","updateFromChild","setting","currentDosingAlgorithm","Dialog","aria-labelledby","PaperProps","DialogTitle","DialogContent","gutterBottom","mode","maxWidth","switchToForm","actionTextField","actionForm","actionToAct","ActionPumpForm","mL","setML","setDuration","isMLDisabled","setIsMLDisabled","isDurationDisabled","setIsDurationDisabled","openSnackbar","setOpenSnackbar","action","params","ml","source_of_event","unitNumber","URLSearchParams","replace","pioreactorCard","disabledText","textbox","textboxLabel","footnote","textField","textFieldWide","slider","divider","TabPanel","children","other","hidden","UnitSettingDisplay","stateDisplay","default","MQTTConnect","passChildData","parsedFloat","isNaN","isStateSetting","isUnitActive","displaySettings","toFixed","precision","measurementUnit","ButtonConfirmStopProcessDialog","handleClose","aria-describedby","DialogContentText","DialogActions","autoFocus","PioreactorHeader","Summary","PatientButton","buttonText","setButtonText","disableElevation","SettingsActionsDialog","defaultStirring","setDefaultStirring","snackbarOpen","setSnackbarOpen","tabValue","setTabValue","setPioreactorJobState","job","sendMessage","setTimeout","startPioreactorJob","job_attr","setPioreactorJobAttr","setPioreactorJobAttrOnEnter","ok","Error","fetchData","createUserButtonsBasedOnState","jobState","parentJob","odButtons","ODReadingJobState","grButtons","growthRateJobState","ioButtons","IOEventsJobState","stirringButtons","stirringJobState","Tabs","newValue","indicatorColor","textColor","Tab","isPlural","Slider","stirringDCState","valueLabelDisplay","onChangeCommitted","marks","volumeState","onKeyPress","targetODState","durationState","targetGrowthRateState","dosingAlgorithm","SettingsActionsDialogAll","jobButton","ActiveUnits","units","PioreactorCard","setStirringDCState","setStirringJobState","setODReadingJobState","setGrowthRateJobState","setIOEventsJobState","temperatureControllingJobState","setTemperatureControllingJobState","setTargetODState","setDurationState","setTargetGrowthRateState","setVolumeState","setDosingAlgorithm","temperature","setTemperature","alignRight","InactiveUnits","Pioreactors","actionsContainer","resetContainer","divInstructions","CycleLiquid","liquid","additionalMsg","duty_cycle","MediaFlush","isAlt","altMedia","AddFinalVolumeOfMedia","VerticalLinearStepper","activeStep","setActiveStep","steps","handleNext","prevActiveStep","handleBack","Stepper","Step","StepLabel","StepContent","getStepContent","Paper","square","elevation","StartStirringButton","StartODReading","StartSensors","direction","alignItems","fontScale","StartGrowthRate","snackbarMessage","setSnackbarMessage","StartCalculations","setExperiment","instructions","halfTextField","ExperimentSummaryForm","formError","setFormError","expName","setExpName","setTimestamp","setDescription","required","InputLabelProps","shrink","rowsMax","placeholder","multiline","fullWidth","publishExpNameToMQTT","StartNewExperimentContainer","skipped","setSkipped","content","optional","isStepOptional","isStepSkipped","stepProps","labelProps","completed","prevSkipped","newSkipped","scrollTo","StartNewExperiment","EditableCodeDiv","onSelectionChange","filename","getConfig","getCodeFlaskRef","codeFlask","onTextChange","code","snackbarMsg","availableConfigs","saveCurrentCode","getListOfConfigFiles","letterSpacing","editorRef","language","EditConfigContainer","EditConfig","createMuiTheme","palette","background","main","App","setConfig","CssBaseline","ExperimentOverview","Boolean","hostname","ReactDOM","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9699bb9d.chunk.js","sourcesContent":["import React from \"react\";\nimport { Client } from \"paho-mqtt\";\nimport { Alert, AlertTitle } from '@material-ui/lab';\n\nimport Snackbar from '@material-ui/core/Snackbar';\n\nfunction TactileButtonNotification(props) {\n  var [unit, setUnit] = React.useState(\"\")\n  var [renamedUnit, setRenamedUnit] = React.useState(\"\")\n  var [open, setOpen] = React.useState(false)\n\n  React.useEffect(() => {\n    if (!props.config['network.topology']){\n      return\n    }\n\n    const onMessageArrived = (msg) => {\n      if (msg.payloadString === \"1\"){\n        var unit = msg.topic.split(\"/\")[1]\n        setUnit(unit)\n        try {\n          setRenamedUnit(props.config['ui.overview.rename'][unit])\n        }\n        catch {}\n        setOpen(true)\n      }\n      else {\n        setOpen(false)\n      }\n    }\n\n    const onSuccess = () => {\n      client.subscribe(\n      [\n        \"pioreactor\",\n        \"+\",\n        \"+\",\n        \"monitor\",\n        \"button_down\"\n      ].join(\"/\"),\n      { qos: 1 }\n      )\n    }\n\n    var client = null\n    if (props.config.remote) {\n      client = new Client(\n        `ws://${props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    client.connect({onSuccess: onSuccess});\n    client.onMessageArrived = onMessageArrived;\n\n  },[props.config])\n\n\n  return (\n    <Snackbar\n      open={open}\n      autoHideDuration={null}\n      onClose={() => {}}\n      anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n      key={\"button-tactile-snackbar\"}\n    >\n    <Alert severity=\"info\" variant=\"filled\" icon={false}>\n      <AlertTitle style={{fontSize: 25}}>{unit + (renamedUnit ? \" / \" + renamedUnit : \"\")}</AlertTitle>\n      Holding <b>{unit}</b>'s button down\n    </Alert>\n    </Snackbar>\n)}\n\nexport default TactileButtonNotification;\n","import React from 'react'\n\nimport SvgIcon from '@material-ui/core/SvgIcon';\n\n\nfunction PioreactorIcon(props) {\n  const colors = {\n    primary: \"#5331CA\",\n    disabled: \"rgba(0, 0, 0, 0.38)\",\n    black: \"rgba(0, 0, 0, 0.87)\"\n  }\n  return (\n    <SvgIcon {...props}>\n        <g id=\"Page-1\" stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n            <g id=\"Experiment-Page-1\" transform=\"translate(-728.000000, -1502.000000)\" stroke={colors[props.color] || \"rgba(0, 0, 0, 0.54)\"} strokeWidth=\"1.8\">\n                <g id=\"pioreactor\" transform=\"translate(729.000000, 1503.000000)\">\n                    <path d=\"M1.4,18.9 L1.4,14.7 L0,14.7 L0,11.2 L2.799,11.2 L2.8,0 L14,0 L13.999,11.2 L16.8,11.2 L16.8,14.7 L15.399,14.7 L15.4,18.9 L1.4,18.9 Z\" id=\"Combined-Shape\"></path>\n                    <circle id=\"Oval\" cx=\"8.4\" cy=\"13.3\" r=\"2.1\"></circle>\n                </g>\n            </g>\n        </g>\n    </SvgIcon>\n  );\n}\n\nexport default PioreactorIcon;\n","import React from 'react';\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport IconButton from '@material-ui/core/IconButton';\nimport EditIcon from '@material-ui/icons/Edit';\nimport SaveAltIcon from '@material-ui/icons/SaveAlt';\nimport DashboardIcon from '@material-ui/icons/Dashboard';\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\nimport PioreactorIcon from './PioreactorIcon';\n\nexport default function SideDrawer() {\n  const [isOpen, setIsOpen] = React.useState(false)\n\n  function isSelected(path) {\n    return (window.location.pathname === path)\n  }\n\n\n\n  const toggleDrawer = (open) => (event) => {\n    if (event && event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\n      return;\n    }\n    setIsOpen(open);\n  };\n\n  const list = () => (\n    <div\n      role=\"presentation\"\n      onClick={toggleDrawer(false)}\n      onKeyDown={toggleDrawer(false)}\n    >\n      <img alt=\"pioreactor logo\" src=\"grey_color.png\" width=\"40%\" style={{marginLeft: \"70px\", marginTop: \"5px\"}}/>\n      <List>\n\n        <ListItem href=\"/\" component=\"a\" button key={\"overview\"} selected={isSelected(\"/\") || isSelected(\"/overview\")}>\n          <ListItemIcon><DashboardIcon color={(isSelected(\"/\") || isSelected(\"/overview\")) ? \"primary\" : \"inherit\"}/> </ListItemIcon>\n          <ListItemText primary={\"Experiment Overview\"} />\n        </ListItem>\n        <ListItem button href=\"/pioreactors\"  component=\"a\" key={\"pioreactors\"} selected={isSelected(\"/pioreactors\")}>\n          <ListItemIcon> <PioreactorIcon color={isSelected(\"/pioreactors\") ? \"primary\" : \"inherit\"}/> </ListItemIcon>\n          <ListItemText primary={\"Pioreactors\"} />\n        </ListItem>\n\n\n      </List>\n      <Divider />\n      <List>\n        <ListItem button href=\"/edit-config\"  component=\"a\" key={\"edit_config\"} selected={isSelected(\"/edit-config\")}>\n          <ListItemIcon> <EditIcon color={isSelected(\"/edit-config\") ? \"primary\" : \"inherit\"}/> </ListItemIcon>\n          <ListItemText primary={\"Edit config.ini\"} />\n        </ListItem>\n        <ListItem href=\"/download-data\" component=\"a\" button key={\"download_data\"} selected={isSelected(\"/download-data\")}>\n          <ListItemIcon><SaveAltIcon color={isSelected(\"/download-data\") ? \"primary\" : \"inherit\"}/> </ListItemIcon>\n          <ListItemText primary={\"Download experiment data\"} />\n        </ListItem>\n\n      </List>\n      <Divider />\n      <List>\n        <ListItem href=\"https://github.com/Pioreactor/pioreactor/wiki\" component=\"a\" button key=\"help\">\n          <ListItemIcon><HelpOutlineIcon/> </ListItemIcon>\n          <ListItemText primary={\"Documentation and help\"} />\n        </ListItem>\n      </List>\n    </div>\n  );\n\n  return (\n      <React.Fragment key={\"leftDrawer\"}>\n        <IconButton\n          color=\"inherit\"\n          aria-label=\"open drawer\"\n          edge=\"start\"\n          onClick={toggleDrawer(true)}\n        >\n          <MenuIcon />\n        </IconButton>\n\n        <Drawer\n          anchor={\"left\"}\n          open={isOpen}\n          onClose={toggleDrawer(false)}\n          onOpen={toggleDrawer(true)}\n        >\n          {list()}\n        </Drawer>\n      </React.Fragment>\n  );\n}\n","import React from 'react'\nimport {AppBar, Toolbar, Typography, Link, Button} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/styles';\nimport SideDrawer from './Drawer'\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  title: {\n    flexGrow: 1,\n  },\n}));\n\n\nconst Header = () => {\n    const classes = useStyles();\n    return (\n    <div className={classes.root}>\n      <AppBar position=\"static\">\n        <Toolbar variant=\"dense\">\n          <SideDrawer />\n          <Typography variant=\"h6\" className={classes.title}>\n            <Link color=\"inherit\" underline=\"none\" href=\"/\" className={classes.title}> <img alt=\"pioreactor logo\" src=\"white_colour.png\" style={{width: \"120px\", height: \"29px\"}}/> </Link>\n          </Typography>\n          <Link color=\"inherit\" underline=\"none\" href=\"https://github.com/Pioreactor/pioreactor/wiki\" target=\"_blank\" rel=\"noopener\">\n            <Button color=\"inherit\" style={{textTransform: \"none\"}}>Help <HelpOutlineIcon style={{ fontSize: 18, verticalAlign: \"middle\", marginLeft: 5 }}/></Button>\n          </Link>\n        </Toolbar>\n      </AppBar>\n    </div>\n    )\n}\n\nexport default Header;\n","import React from 'react'\n\nimport clsx from 'clsx';\nimport {Client} from 'paho-mqtt';\nimport moment from 'moment';\n\n\nimport {withStyles} from '@material-ui/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\n\nconst useStyles = theme => ({\n  tightCell: {\n    padding: \"8px 2px 6px 4px\",\n    fontSize: 13,\n  },\n  smallText: {\n    fontSize: 12,\n  },\n  headerCell: {\n    backgroundColor: \"white\",\n    padding: \"8px 6px 6px 6px\",\n  },\n  tightRight: {\n    textAlign: \"right\"\n  },\n  errorLog: {\n    backgroundColor: \"#ff7961\"\n  }\n});\n\nclass LogTable extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {listOfLogs: []};\n    this.onConnect = this.onConnect.bind(this);\n    this.onMessageArrived = this.onMessageArrived.bind(this);\n  }\n\n  async getData() {\n    await fetch(\"./data/all_pioreactor.log.json\")\n      .then(response => {\n        return response.json();\n      })\n      .then(data => {\n        this.setState({listOfLogs: data});\n      });\n  }\n\n  componentDidMount() {\n    this.getData()\n    if (this.props.config.remote) {\n      this.client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      this.client = new Client(\n        `${this.props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    this.client.connect({'onSuccess': this.onConnect});\n    this.client.onMessageArrived = this.onMessageArrived;\n  }\n\n  onConnect() {\n      this.client.subscribe([\"pioreactor\", \"+\", \"+\", \"log\"].join(\"/\"))\n  }\n\n  onMessageArrived(message) {\n    if (this.state.listOfLogs.length > 50){\n      this.state.listOfLogs.pop()\n    }\n    const unit = message.topic.split(\"/\")[1]\n    const payload = message.payloadString\n    this.state.listOfLogs.unshift(\n      {timestamp: moment().format(\"x\"), unit: unit, message: payload, is_error: (payload.includes(\"error\") ||  payload.includes(\"failed\"))}\n    )\n    this.setState({\n      listOfLogs: this.state.listOfLogs\n    });\n  }\n\n  breakString(string){\n    if (string.length > 5){\n      return string.slice(0, 4) + \"...\"\n    }\n    return string\n  }\n\n  renameUnit(name){\n    if (!this.props.config['ui.overview.rename']){\n      return name\n    }\n    return (this.props.config['ui.overview.rename'][name]) || name\n  }\n\n  render(){\n    const { classes } = this.props;\n    return (\n      <Card>\n        <CardContent>\n          <Typography variant=\"h6\" component=\"h2\">\n            <Box fontWeight=\"fontWeightRegular\">\n              Event Logs\n            </Box>\n          </Typography>\n          <TableContainer style={{ height: \"700px\", width: \"100%\", overflowY: \"scroll\"}}>\n            <Table stickyHeader size=\"small\" aria-label=\"log table\">\n               <TableHead>\n                <TableRow>\n                  <TableCell className={clsx(classes.headerCell)}>Timestamp</TableCell>\n                  <TableCell className={clsx(classes.headerCell)}>Message</TableCell>\n                  <TableCell className={clsx(classes.headerCell)}>Pioreactor</TableCell>\n                </TableRow>\n              </TableHead>\n\n              <TableBody>\n                {this.state.listOfLogs.map((log, i) => (\n                  <TableRow key={i}>\n                    <TableCell className={clsx(classes.tightCell, classes.smallText, {[classes.errorLog]: log.is_error})}> {moment(log.timestamp, 'x').format('HH:mm:ss')} </TableCell>\n                    <TableCell className={clsx(classes.tightCell, classes.smallText, {[classes.errorLog]: log.is_error})}> {log.message} </TableCell>\n                    <TableCell className={clsx(classes.tightCell, classes.smallText, {[classes.errorLog]: log.is_error})}> {this.renameUnit(log.unit)}</TableCell>\n                  </TableRow>\n                  ))\n                }\n              </TableBody>\n            </Table>\n          </TableContainer>\n        </CardContent>\n      </Card>\n  )}\n}\n\n\n\nexport default withStyles(useStyles)(LogTable);\n","import React from 'react'\nimport {makeStyles} from '@material-ui/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/Card';\nimport {Typography} from '@material-ui/core';\nimport moment from \"moment\";\nimport Box from '@material-ui/core/Box';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Divider from '@material-ui/core/Divider';\nimport Button from '@material-ui/core/Button';\nimport ContentEditable from 'react-contenteditable'\nimport CalendarTodayIcon from '@material-ui/icons/CalendarToday';\nimport TimelapseIcon from '@material-ui/icons/Timelapse';\nimport GetAppIcon from '@material-ui/icons/GetApp';\nimport AddIcon from '@material-ui/icons/Add';\n\nconst useStyles = makeStyles({\n  title: {\n    fontSize: 14,\n  },\n  cardContent: {\n    padding: \"10px\"\n  },\n  pos: {\n    marginBottom: 0,\n  },\n  textIcon: {\n    fontSize: 15,\n    verticalAlign: \"middle\",\n    margin: \"0px 3px\"\n  },\n});\n\n\n\nclass EditableDescription extends React.Component {\n  constructor(props) {\n    super(props)\n    this.contentEditable = React.createRef();\n    this.state = {desc: \"\", openSnackBar: false, originalDesc: \"\"};\n  };\n\n  componentDidUpdate(prevProps) {\n    if (this.props.description !== prevProps.description) {\n      this.setState({desc: `${this.props.description}`, originalDesc: `${this.props.description}`})\n    }\n  }\n\n  handleChange = evt => {\n    this.setState({desc: evt.target.value});\n  };\n\n  onBlur = evt => {\n    if (this.state.desc !== this.state.originalDesc) {\n      this.setState({originalDesc: this.state.desc})\n      return fetch('update_experiment_desc', {\n          method: \"POST\",\n          body: JSON.stringify({experiment : this.props.experiment, description: this.state.desc}),\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          }\n        }).then(res => {\n          if (res.status === 200){\n            this.setState({openSnackBar: true});\n          }\n        })\n    }\n  };\n\n  handleSnackbarClose = (e, reason) => {\n    if (reason !== \"clickaway\"){\n      this.setState({openSnackBar: false});\n    }\n  };\n\n  render = () => {\n    return (\n      <div style={{\"padding\": \"0px 5px 0px 5px\"}}>\n        <Box fontWeight=\"fontWeightBold\">\n          Description:\n        </Box>\n        <ContentEditable\n            innerRef={this.contentEditable}\n            html={this.state.desc} // innerHTML of the editable div\n            disabled={false}       // use true to disable editing\n            onChange={this.handleChange} // handle innerHTML change\n            onBlur={this.onBlur}\n            tagName=\"p\"\n            style={{\"padding\": \"3px 3px 3px 2px\"}}\n          />\n          <Snackbar\n            anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n            open={this.state.openSnackBar}\n            onClose={this.handleSnackbarClose}\n            message={\"Updated description\"}\n            autoHideDuration={2500}\n            key={\"snackbarEditDesc\"}\n          />\n      </div>\n    )\n  };\n};\n\n\nfunction ExperimentSummary(props){\n  const classes = useStyles();\n  const experiment = props.experimentMetadata.experiment || \"\"\n  const startedAt = props.experimentMetadata.timestamp || moment()\n  const desc = props.experimentMetadata.description || \"\"\n\n  return(\n    <React.Fragment>\n      <div>\n        <div style={{display: \"flex\", justifyContent: \"space-between\", marginBottom: \"5px\"}}>\n          <Typography variant=\"h5\" component=\"h1\">\n            <Box fontWeight=\"fontWeightBold\">\n              {experiment}\n            </Box>\n          </Typography>\n          <div >\n            <Button href=\"/download-data\" style={{textTransform: 'none', marginRight: \"0px\", float: \"right\"}} color=\"primary\">\n              <GetAppIcon className={classes.textIcon}/> Download experiment data\n            </Button>\n            <Button href=\"/start-new-experiment\" style={{textTransform: 'none', float: \"right\", marginRight: \"10px\"}} color=\"primary\">\n              <AddIcon className={classes.textIcon}/> New experiment\n            </Button>\n          </div>\n        </div>\n\n        <Divider/>\n        <Typography variant=\"subtitle2\">\n          <Box fontWeight=\"fontWeightBold\" style={{margin: \"10px 2px 10px 2px\", display:\"inline-block\"}}>\n            <CalendarTodayIcon style={{ fontSize: 12, verticalAlign: \"middle\" }}/> Experiment Started:\n          </Box>\n          <Box fontWeight=\"fontWeightRegular\" style={{marginRight: \"20px\", display:\"inline-block\"}}>\n            <span title={moment(startedAt).format(\"YYYY-MM-DD HH:mm:ss\")}>{moment(startedAt).format(\"dddd, MMMM D YYYY\")}</span>\n          </Box>\n          <Box fontWeight=\"fontWeightBold\" style={{display:\"inline-block\", margin: \"10px 2px 10px 0px\"}}>\n            <TimelapseIcon style={{ fontSize: 12, verticalAlign: \"middle\"  }}/>Time Elapsed:\n          </Box>\n          <Box fontWeight=\"fontWeightRegular\" style={{display:\"inline-block\"}}>\n           {(moment().diff(moment(startedAt), 'H'))}h\n          </Box>\n        </Typography>\n      </div>\n      <Card className={classes.root}>\n        <CardContent className={classes.cardContent}>\n          <EditableDescription experiment={experiment} description={desc} />\n        </CardContent>\n      </Card>\n    </React.Fragment>\n  )\n}\n\n\nexport default ExperimentSummary;\n","import React from \"react\";\nimport { Client } from \"paho-mqtt\";\nimport {\n  VictoryChart,\n  VictoryLabel,\n  VictoryAxis,\n  VictoryTheme,\n  VictoryLine,\n  VictoryLegend,\n  createContainer,\n  VictoryTooltip,\n} from \"victory\";\nimport moment from \"moment\";\nimport Card from \"@material-ui/core/Card\";\n\nconst colors = {\n  \"pioreactor1\": \"#9C6ADE\",\n  \"pioreactor1-A\": \"#9C6ADE\",\n  \"pioreactor1-D\": \"#E3D0FF\",\n  \"pioreactor1-C\": \"#50248F\",\n  \"pioreactor1-B\": \"#230051\",\n\n  \"pioreactor2\": \"#47C1BF\",\n  \"pioreactor2-A\": \"#47C1BF\",\n  \"pioreactor2-D\": \"#B7ECEC\",\n  \"pioreactor2-C\": \"#00848E\",\n  \"pioreactor2-B\": \"#003135\",\n\n\n  \"pioreactor3\": \"#F49342\",\n  \"pioreactor3-A\": \"#F49342\",\n  \"pioreactor3-D\": \"#FFC58B\",\n  \"pioreactor3-C\": \"#C05717\",\n  \"pioreactor3-B\": \"#4A1504\",\n\n  \"pioreactor4\": \"#50B83C\",\n  \"pioreactor4-A\": \"#50B83C\",\n  \"pioreactor4-B\": \"#173630\",\n  \"pioreactor4-C\": \"#108043\",\n  \"pioreactor4-D\": \"#BBE5B3\",\n\n};\n\nfunction linspace(startValue, stopValue, cardinality) {\n  var arr = [];\n  var step = (stopValue - startValue) / (cardinality - 1);\n  for (var i = 0; i < cardinality; i++) {\n    arr.push(startValue + step * i);\n  }\n  return arr;\n}\n\nclass Chart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      seriesMap: {},\n      maxTimestamp: parseInt(moment().format(\"x\")),\n      hiddenSeries: new Set(),\n      lastMsgRecievedAt: parseInt(moment().format(\"x\")),\n      names: [],\n      legendEvents: [],\n      minTimestamp: parseInt(moment().subtract(30, 'seconds').format(\"x\")),\n    };\n    this.onConnect = this.onConnect.bind(this);\n    this.onMessageArrived = this.onMessageArrived.bind(this);\n    this.selectLegendData = this.selectLegendData.bind(this);\n    this.selectVictoryLines = this.selectVictoryLines.bind(this);\n\n  }\n\n  onConnect() {\n    this.client.subscribe(\n      [\"pioreactor\", \"+\", this.props.experiment, this.props.topic].join(\"/\")\n    );\n  }\n\n  componentDidMount() {\n    this.getData();\n\n    if (this.props.config.remote) {\n      this.client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      this.client = new Client(\n        `${this.props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n\n\n    this.client.connect({ onSuccess: this.onConnect });\n    this.client.onMessageArrived = this.onMessageArrived;\n  }\n\n  async getData() {\n    await fetch(this.props.dataFile)\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        let initialSeriesMap = {};\n        for (const [i, v] of data[\"series\"].entries()) {\n          if (data[\"data\"][i].length > 0) {\n            initialSeriesMap[v] = {\n              data: (data[\"data\"][i]).filter(this.filterDataPoints(data[\"data\"][i].length)),\n              name: v,\n              color: colors[v],\n            };\n          }\n        }\n        let names = Object.keys(initialSeriesMap);\n        let mts = Math.min(\n          ...Object.values(initialSeriesMap).map((s) => parseInt(s.data[0].x))\n        );\n        this.setState({\n          seriesMap: initialSeriesMap,\n          legendEvents: this.createLegendEvents(names),\n          names: names,\n          minTimestamp: mts,\n        });\n      });\n  }\n\n  createLegendEvents(names) {\n    return names.map((name, idx) => {\n      return {\n        childName: [\"legend\"],\n        target: \"data\",\n        eventKey: String(idx),\n        eventHandlers: {\n          onClick: () => {\n            return [\n              {\n                childName: [\"line-\" + name],\n                target: \"data\",\n                mutation: () => {\n                  if (!this.state.hiddenSeries.delete(name)) {\n                    // Was not already hidden => add to set\n                    this.state.hiddenSeries.add(name);\n                  }\n                  this.setState({\n                    hiddenSeries: new Set(this.state.hiddenSeries),\n                  });\n                  return null;\n                },\n              },\n            ];\n          },\n        },\n      };\n    });\n  }\n\n  onMessageArrived(message) {\n    if (message.retained){\n      return\n    }\n    const currentTime = parseInt(moment().format(\"x\"));\n\n    var key = this.props.isODReading\n      ? message.topic.split(\"/\")[1] + \"-\" + message.topic.split(\"/\")[5]\n      : message.topic.split(\"/\")[1];\n\n    try {\n      if (!(key in this.state.seriesMap)){\n        const newSeriesMap = {...this.state.seriesMap, [key]:  {\n          data: [{x: currentTime, y: parseFloat(message.payloadString)}],\n          name: key,\n          color: colors[key]\n        }}\n\n        this.setState({ seriesMap: newSeriesMap })\n        this.setState({\n          names: [...this.state.names, key]\n        })\n      } else {\n        // .push seems like bad state management, and maybe a hit to performance...\n        this.state.seriesMap[key].data.push({\n          x: currentTime,\n          y: parseFloat(message.payloadString),\n        });\n        this.setState({ seriesMap: this.state.seriesMap })\n      }\n\n      this.setState({\n        maxTimestamp: currentTime,\n        lastMsgRecievedAt: currentTime,\n      });\n    }\n    catch (error) {\n      console.log(error)\n    }\n    return;\n  }\n\n  breakString(string){\n    if (string.length > 7){\n      return string.slice(0, 5) + \"...\" + string.slice(string.length-2, string.length)\n    }\n    return string\n  }\n\n  renameAndFormatSeries(name){\n    if (!this.props.config['ui.overview.rename']){\n      return name\n    }\n\n    if (name.match(/(.*)-([ABCD])/g)){\n      const results = name.match(/(.*)-([ABCD])/);\n      const index = results[1];\n      const sensor = results[2];\n      return this.breakString(this.props.config['ui.overview.rename'][index] || index) + sensor\n    }\n    else {\n      return this.breakString(this.props.config['ui.overview.rename'][name] || name)\n    }\n  }\n\n\n  filterDataPoints(totalLength){\n    return function(value, index){\n      if (totalLength < 500){\n        return true\n      }\n      if ((index === 0) || (index === (totalLength - 1))){\n        return true\n      }\n      else if (index % Math.round(totalLength/500) === 0){\n        return true\n      } else {\n        return false\n      }\n    }\n  }\n\n  createXTickValues(minTimestamp, maxTimestamp){\n    const delta_ts = moment(maxTimestamp, \"x\").diff(\n      moment(minTimestamp, \"x\"),\n      \"hours\"\n    );\n    const v = linspace(\n      minTimestamp,\n      maxTimestamp + 100000,\n      7\n    ).map((x) =>\n      moment(Math.round(x), \"x\").startOf(delta_ts >= 16 ? \"hour\" : \"minute\")\n    );\n    return v\n\n  }\n\n  createToolTip = (d) => {\n      return `${moment(d.datum.x, 'x').format(\"dd HH:mm\")}\n${this.renameAndFormatSeries(d.datum.childName)}: ${Math.round(d.datum.y * 1000) / 1000}`\n  }\n\n  formatTs(format){\n    return function(mt){\n      return mt.format(format)\n  }}\n\n  selectLegendData(name){\n    if (!this.state.seriesMap) {\n      return {}\n    }\n    const line = this.state.seriesMap[name];\n    const item = {\n      name: this.renameAndFormatSeries(line.name),\n      symbol: { fill: line.color },\n    };\n    if (this.state.hiddenSeries.has(name)) {\n      return { ...item, symbol: { fill: \"white\" } };\n    }\n    return item;\n  }\n\n  selectVictoryLines(name) {\n    if (this.state.hiddenSeries.has(name)) {\n      return undefined;\n    }\n    return (\n      <VictoryLine\n        interpolation={this.props.interpolation}\n        key={\"line-\" + name + this.props.title}\n        name={name}\n        style={{\n          labels: {fill: this.state.seriesMap[name].color},\n          data: {\n            stroke: this.state.seriesMap[name].color,\n            strokeWidth: 2,\n          },\n          parent: { border: \"1px solid #ccc\" },\n        }}\n        data={this.state.seriesMap[name].data}\n        x=\"x\"\n        y=\"y\"\n      />\n    );\n  }\n\n  render() {\n    const delta_ts = moment(this.state.maxTimestamp, \"x\").diff(\n      moment(this.state.minTimestamp, \"x\"),\n      \"hours\"\n    );\n    const VictoryVoronoiContainer = createContainer(\"voronoi\");\n    const axis_display_ts_format =\n      delta_ts >= 16 ? (delta_ts >= 5 * 24 ? \"MMM DD\" : \"dd HH:mm\") : \"H:mm\";\n    const ts = this.createXTickValues(this.state.minTimestamp, this.state.maxTimestamp)\n    return (\n      <Card style={{ maxHeight: \"100%\"}}>\n        <VictoryChart\n          title={this.props.title}\n          domainPadding={10}\n          padding={{ left: 70, right: 50, bottom: 80, top: 50 }}\n          events={this.state.legendEvents}\n          responsive={true}\n          width={600}\n          height={315}\n          theme={VictoryTheme.material}\n          containerComponent={\n            <VictoryVoronoiContainer\n              voronoiBlacklist={['parent']}\n              labels={this.createToolTip}\n              labelComponent={\n                <VictoryTooltip\n                  cornerRadius={0}\n                  flyoutStyle={{\n                    fill: \"white\",\n                    stroke: \"#90a4ae\",\n                    strokeWidth: 1.5,\n                  }}\n                />\n              }\n            />\n          }\n        >\n          <VictoryLabel\n            text={this.props.title}\n            x={300}\n            y={30}\n            textAnchor=\"middle\"\n            style={{\n              fontSize: 15,\n              fontFamily: \"inherit\",\n            }}\n          />\n          <VictoryAxis\n            tickFormat={this.formatTs(axis_display_ts_format)}\n            tickValues={ts}\n            style={{\n              tickLabels: {\n                fontSize: 13,\n                padding: 5,\n                fontFamily: \"inherit\",\n              },\n            }}\n            offsetY={80}\n            orientation=\"bottom\"\n          />\n          <VictoryAxis\n            crossAxis={false}\n            dependentAxis\n            domain={this.props.domain}\n            label={this.props.yAxisLabel}\n            axisLabelComponent={\n              <VictoryLabel\n                dy={-40}\n                style={{\n                  fontSize: 15,\n                  padding: 10,\n                  fontFamily: \"inherit\",\n                }}\n              />\n            }\n            style={{\n              tickLabels: {\n                fontSize: 13,\n                padding: 5,\n                fontFamily: \"inherit\",\n              },\n            }}\n          />\n          <VictoryLegend\n            x={60}\n            y={267}\n            symbolSpacer={10}\n            itemsPerRow={6}\n            name={\"legend\"}\n            borderPadding={{ right: 8 }}\n            orientation=\"horizontal\"\n            cursor={\"pointer\"}\n            gutter={15}\n            style={{\n              labels: { fontSize: 12 },\n              data: { stroke: \"#485157\", strokeWidth: 1, size: 6 },\n            }}\n            data={this.state.names.map(this.selectLegendData)}\n          />\n          {Object.keys(this.state.seriesMap).map(this.selectVictoryLines)}\n        </VictoryChart>\n      </Card>\n    );\n  }\n}\n\nexport default Chart;\n","import React from 'react'\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport {Client} from 'paho-mqtt';\nimport Typography from \"@material-ui/core/Typography\";\nimport Box from \"@material-ui/core/Box\";\nimport {withStyles} from '@material-ui/styles';\n\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\n\nimport PioreactorIcon from \"./PioreactorIcon\"\n\n\n\nconst useStyles = theme => ({\n  tightCell: {\n    padding: \"8px 2px 6px 4px\",\n    fontSize: 13,\n  },\n  smallText: {\n    fontSize: 12,\n  },\n  headerCell: {\n    backgroundColor: \"white\",\n    padding: \"8px 6px 6px 6px\",\n  },\n  tightRight: {\n    textAlign: \"right\"\n  },\n});\n\n\n\nclass MediaCard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n        mediaThroughputPerUnit: {},\n        altMediaThroughputPerUnit: {},\n        mediaThroughput: 0,\n        altMediaThroughput: 0,\n        rates: {all: {mediaRate: 0, altMediaRate: 0}},\n      };\n    this.onConnect = this.onConnect.bind(this);\n    this.onMessageArrived = this.onMessageArrived.bind(this);\n  }\n\n  async getRecentRates() {\n     await fetch(\"/recent_media_rates/\" + this.props.experiment)\n    .then((response) => {\n      return response.json();\n    })\n    .then((data) => {\n      this.setState(prevState => ({...prevState, rates: data}))\n    });\n  }\n\n  componentDidMount() {\n    if (this.props.config.remote) {\n      this.client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      this.client = new Client(\n        `${this.props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n\n    this.client.connect({'onSuccess': this.onConnect});\n    this.client.onMessageArrived = this.onMessageArrived;\n  }\n\n  componentDidUpdate(prevProps) {\n     if (prevProps.experiment !== this.props.experiment) {\n      this.getRecentRates()\n     }\n  }\n\n  onConnect() {\n      this.client.subscribe([\"pioreactor\", \"+\", this.props.experiment, \"throughput_calculating\", \"alt_media_throughput\"].join(\"/\"))\n      this.client.subscribe([\"pioreactor\", \"+\", this.props.experiment, \"throughput_calculating\", \"media_throughput\"].join(\"/\"))\n  }\n\n  addOrUpdate(hash, object, value) {\n      if (Object.hasOwnProperty(hash)){\n        object[hash] = value + object[hash]\n      }\n      else{\n        object[hash] = value\n      }\n      return object\n  }\n\n  onMessageArrived(message) {\n    const topic = message.destinationName\n    const topicParts = topic.split(\"/\")\n    const payload = parseFloat(message.payloadString)\n    const unit = topicParts[1]\n    const objectRef = (topicParts.slice(-1)[0] === \"alt_media_throughput\")  ? \"altMediaThroughputPerUnit\"  : \"mediaThroughputPerUnit\"\n    const totalRef = (topicParts.slice(-1)[0] === \"alt_media_throughput\")  ? \"altMediaThroughput\"  : \"mediaThroughput\"\n\n    this.setState({\n      [objectRef]: this.addOrUpdate(unit, this.state[objectRef], payload)\n    });\n\n    var total = Object.values(this.state[objectRef]).reduce((a, b) => a + b, 0)\n\n    this.setState({\n      [totalRef]: total\n    })\n\n  }\n  render(){\n    return (\n    <Card>\n      <CardContent>\n        <Typography variant=\"h6\" component=\"h2\">\n          <Box fontWeight=\"fontWeightRegular\">\n            Dosing\n          </Box>\n        </Typography>\n       <TableContainer style={{ width: \"100%\"}}>\n          <Table size=\"small\" aria-label=\"media throughput\">\n            <TableHead>\n              <TableRow>\n                <TableCell style={{padding: \"6px 0px\"}}></TableCell>\n                <TableCell style={{padding: \"6px 0px\"}} align=\"right\">Media</TableCell>\n                <TableCell style={{padding: \"6px 0px\"}} align=\"right\">Alt. Media</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              <TableRow key=\"all\">\n                <TableCell style={{padding: \"6px 0px\"}} component=\"th\" scope=\"row\">\n                  All Pioreactors\n                </TableCell>\n                <TableCell align=\"right\" style={{fontFamily: \"courier\", fontSize: 14, padding: \"6px 0px\"}}>{this.state.mediaThroughput}mL (~{this.state.rates.all.mediaRate}mL/h)</TableCell>\n                <TableCell align=\"right\" style={{fontFamily: \"courier\", fontSize: 14, padding: \"6px 0px\"}}>{this.state.altMediaThroughput}mL (~{this.state.rates.all.altMediaRate}mL/h)</TableCell>\n              </TableRow>\n\n              {Object.keys(this.state.mediaThroughputPerUnit).map((unit) => (\n                <TableRow key={unit}>\n                  <TableCell style={{padding: \"6px 0px\"}} component=\"th\" scope=\"row\">\n                      <PioreactorIcon style={{ fontSize: 14, verticalAlign: \"middle\" }} color=\"black\"/> {(this.props.config['ui.overview.rename'] &&  this.props.config['ui.overview.rename'][unit]) ? this.props.config['ui.overview.rename'][unit] : unit}\n                  </TableCell>\n                  <TableCell align=\"right\" style={{fontFamily: \"courier\", fontSize: 14, padding: \"6px 0px\"}}>{this.state.mediaThroughputPerUnit[unit]}mL (~{this.state.rates[unit] ? this.state.rates[unit].mediaRate : 0}mL/h)</TableCell>\n                  <TableCell align=\"right\" style={{fontFamily: \"courier\", fontSize: 14, padding: \"6px 0px\"}}>{this.state.altMediaThroughputPerUnit[unit]}mL (~{this.state.rates[unit] ? this.state.rates[unit].altMediaRate: 0}mL/h)</TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      </CardContent>\n    </Card>\n  )}\n}\n\nexport default  withStyles(useStyles)(MediaCard);\n","import React from \"react\";\nimport { Client, Message } from \"paho-mqtt\";\nimport ClearIcon from '@material-ui/icons/Clear';\nimport Button from \"@material-ui/core/Button\";\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles((theme) => ({\n  textIcon: {\n    fontSize: 15,\n    verticalAlign: \"middle\",\n    margin: \"0px 3px\"\n  },\n}))\n\n\nfunction ClearChartButton(props){\n  const classes = useStyles();\n\n\n  function onClick() {\n    if (props.config.remote) {\n      var client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      var client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    client.connect({onSuccess: () => {\n      for (var jobName of ['od_raw', 'od_filtered', 'growth_rate', 'alt_media_fraction']) {\n        var message = new Message(\"\");\n\n        message.destinationName = [\n          \"pioreactor\",\n          \"leader\",\n          \"$experiment\",\n          `${jobName}_time_series_aggregating`,\n          \"aggregated_time_series\",\n          \"set\",\n        ].join(\"/\");\n\n        message.qos = 1;\n        client.publish(message);\n      }\n\n      window.location.reload();\n      return false\n    }});\n  }\n\n  return (\n    <Button color=\"primary\" style={{textTransform: \"none\"}} onClick={onClick}><ClearIcon className={classes.textIcon}/> Clear chart data </Button>\n)}\n\n\nexport default ClearChartButton;\n","import React from \"react\";\nimport { Client, Message } from \"paho-mqtt\";\nimport ClearIcon from '@material-ui/icons/Clear';\nimport Button from \"@material-ui/core/Button\";\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles((theme) => ({\n  textIcon: {\n    fontSize: 15,\n    verticalAlign: \"middle\",\n    margin: \"0px 3px\"\n  },\n}))\n\n\nfunction ClearLogButton(props){\n  const classes = useStyles();\n\n\n  function onClick() {\n    if (props.config.remote) {\n      var client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      var client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    client.connect({onSuccess: () => {\n      var message = new Message(\"\");\n      message.destinationName = [\n        \"pioreactor\",\n        \"leader\",\n        \"$experiment\",\n        \"log_aggregating\",\n        \"aggregated_log_table\",\n        \"set\",\n      ].join(\"/\");\n      message.qos = 2;\n      client.publish(message);\n      window.location.reload();\n      return false\n    }});\n  }\n\n  return (\n    <Button color=\"primary\" style={{textTransform: \"none\"}} onClick={onClick}> <ClearIcon className={classes.textIcon}/>  Clear log table </Button>\n)}\n\n\nexport default ClearLogButton;\n","\nexport function parseINIString(data){\n    var regex = {\n        section: /^\\s*\\[\\s*([^\\]]*)\\s*\\]\\s*$/,\n        param: /^\\s*([^=]+?)\\s*=\\s*(.*?)\\s*$/,\n        comment: /^\\s*;.*$/\n    };\n    var value = {};\n    var lines = data.split(/[\\r\\n]+/);\n    var section = null;\n    lines.forEach(function(line){\n        if(regex.comment.test(line)){\n            return;\n        }else if(regex.param.test(line)){\n            var match = line.match(regex.param);\n            if(section){\n                value[section][match[1]] = match[2];\n            }else{\n                value[match[1]] = match[2];\n            }\n        }else if(regex.section.test(line)){\n            var match = line.match(regex.section);\n            value[match[1]] = {};\n            section = match[1];\n        }else if(line.length === 0 && section){\n            section = null;\n        };\n    });\n    return value;\n}","import React from \"react\";\n\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Header from \"./components/Header\";\nimport LogTable from \"./components/LogTable\";\nimport ExperimentSummary from \"./components/ExperimentSummary\";\nimport Chart from \"./components/Chart\";\nimport MediaCard from \"./components/MediaCard\";\nimport ClearChartButton from \"./components/ClearChartButton\";\nimport ClearLogButton from \"./components/ClearLogButton\";\nimport PioreactorIcon from './components/PioreactorIcon';\nimport TactileButtonNotification from \"./components/TactileButtonNotification\";\nimport {parseINIString} from \"./utilities\"\n\n\nfunction Overview(props) {\n\n  const [experimentMetadata, setExperimentMetadata] = React.useState({})\n\n  React.useEffect(() => {\n    async function getLatestExperiment() {\n         await fetch(\"/get_latest_experiment\")\n        .then((response) => {\n          return response.json();\n        })\n        .then((data) => {\n          setExperimentMetadata(data)\n        });\n      }\n    getLatestExperiment()\n  }, [])\n\n  return (\n      <React.Fragment>\n        <Grid container spacing={2} justify=\"space-between\">\n          <Grid item xs={12} style={{paddingRight: \"0px\"}}>\n            <Header />\n          </Grid>\n          <Grid item xs={1} md={12}/>\n          <Grid item xs={1} md={12}/>\n\n\n          <Grid item xs={12} md={1}/>\n          <Grid item xs={12} md={10}>\n            <ExperimentSummary experimentMetadata={experimentMetadata}/>\n          </Grid>\n          <Grid item xs={12} md={1}/>\n\n\n          <Grid item xs={12} md={1}/>\n          <Grid item xs={12} md={6} container spacing={2} justify=\"flex-start\" style={{paddingLeft: 0, height: \"100%\"}}>\n\n\n            {( props.config['ui.overview.charts'] && (props.config['ui.overview.charts']['implied_growth_rate'] === \"1\")) &&\n            <Grid item xs={12}>\n              <Chart\n                config={props.config}\n                dataFile={\"./data/growth_rate_time_series_aggregating.json\"}\n                title=\"Implied growth rate\"\n                topic=\"growth_rate\"\n                yAxisLabel=\"Growth rate, h⁻¹\"\n                experiment={experimentMetadata.experiment}\n                interpolation=\"stepAfter\"\n              />\n            </Grid>\n            }\n\n            {( props.config['ui.overview.charts'] && (props.config['ui.overview.charts']['fraction_of_volume_that_is_alternative_media'] === \"1\")) &&\n            <Grid item xs={12}>\n              <Chart\n                config={props.config}\n                domain={[0, 1]}\n                dataFile={\"./data/alt_media_fraction_time_series_aggregating.json\"}\n                interpolation=\"stepAfter\"\n                title=\"Fraction of volume that is alternative media\"\n                topic=\"alt_media_calculating/alt_media_fraction\"\n                yAxisLabel=\"Fraction\"\n                experiment={experimentMetadata.experiment}\n              />\n            </Grid>\n            }\n\n            {( props.config['ui.overview.charts'] && (props.config['ui.overview.charts']['normalized_135_optical_density'] === \"1\")) &&\n            <Grid item xs={12}>\n              <Chart\n                config={props.config}\n                isODReading={true}\n                dataFile={\"./data/od_filtered_time_series_aggregating.json\"}\n                title=\"Normalized 135° optical density\"\n                topic=\"od_filtered/135/+\"\n                yAxisLabel=\"Current OD / initial OD\"\n                experiment={experimentMetadata.experiment}\n                interpolation=\"stepAfter\"\n              />\n            </Grid>\n            }\n\n            {( props.config['ui.overview.charts'] && (props.config['ui.overview.charts']['raw_135_optical_density'] === \"1\")) &&\n            <Grid item xs={12}>\n              <Chart\n                config={props.config}\n                isODReading={true}\n                dataFile={\"./data/od_raw_time_series_aggregating.json\"}\n                title=\"Raw 135° optical density\"\n                topic=\"od_raw/135/+\"\n                yAxisLabel=\"Voltage\"\n                experiment=\"+\"\n                interpolation=\"stepAfter\"\n              />\n            </Grid>\n           }\n            <Grid item xs={12}> <ClearChartButton experiment={experimentMetadata.experiment}/> </Grid>\n          </Grid>\n\n          <Grid item xs={12} md={4} container spacing={2} justify=\"flex-end\" style={{height: \"100%\"}}>\n\n\n            {( props.config['ui.overview.cards'] && (props.config['ui.overview.cards']['dosings'] === \"1\")) &&\n              <Grid item xs={12} style={{padding: \"10px 0px\"}}>\n                <MediaCard experiment={experimentMetadata.experiment} config={props.config}/>\n              </Grid>\n            }\n            <Grid item xs={12}>\n              <Button href=\"/pioreactors\" color=\"primary\" style={{textTransform: \"none\", verticalAlign: \"middle\", margin: \"0px 3px\"}}> <PioreactorIcon style={{ fontSize: 17 }} color=\"primary\"/> See all Pioreactor details </Button>\n            </Grid>\n\n            {( props.config['ui.overview.cards'] && (props.config['ui.overview.cards']['event_logs'] === \"1\")) &&\n              <Grid item xs={12} style={{padding: \"10px 0px\"}}>\n                <LogTable config={props.config}/>\n                <ClearLogButton />\n              </Grid>\n            }\n\n\n          </Grid>\n\n          <Grid item xs={1} md={1}/>\n        </Grid>\n        {props.config['ui.overview.rename'] ? <TactileButtonNotification config={props.config}/> : null}\n      </React.Fragment>\n  );\n}\nexport default Overview;\n","import React from \"react\";\nimport moment from \"moment\";\n\nimport Grid from '@material-ui/core/Grid';\nimport Header from \"./components/Header\"\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/Card';\nimport {Typography} from '@material-ui/core';\nimport Select from '@material-ui/core/Select';\nimport Box from '@material-ui/core/Box';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Button from \"@material-ui/core/Button\";\n\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    marginTop: \"15px\"\n  },\n  formControl: {\n    margin: theme.spacing(3),\n  },\n  title: {\n    fontSize: 14,\n  },\n  cardContent: {\n    padding: \"10px\"\n  },\n  pos: {\n    marginBottom: 0,\n  },\n}));\n\n\n\nfunction ExperimentSelection(props) {\n  const classes = useStyles();\n\n  const [experiments, setExperiments] = React.useState([])\n\n  React.useEffect(() => {\n    async function getData() {\n         await fetch(\"/get_experiments\")\n        .then((response) => {\n          return response.json();\n        })\n        .then((data) => {\n          setExperiments(data)\n          props.handleChange(data[0].experiment)\n        });\n      }\n      getData()\n  }, [])\n\n  const handleExperimentSelectionChange = (e) => {\n    props.handleChange(e.target.value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <FormControl component=\"fieldset\" className={classes.formControl}>\n\n      <FormLabel component=\"legend\">Experiment</FormLabel>\n        <Select\n          native\n          value={props.ExperimentSelection}\n          onChange={handleExperimentSelectionChange}\n          inputProps={{\n            name: 'experiment',\n            id: 'experiment',\n          }}\n        >\n          {experiments.map((v) => {\n            return <option value={v.experiment}>{v.experiment +  ` (started ${moment(v.timestamp).format(\"MMMM D, YYYY\")})`}</option>\n            }\n          )}\n        </Select>\n      </FormControl>\n\n    </div>\n  )\n}\n\n\n\nconst CheckboxesGroup = (props) => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <FormControl component=\"fieldset\" className={classes.formControl}>\n        <FormLabel component=\"legend\">Datasets</FormLabel>\n        <FormGroup>\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.growth_rates} onChange={props.handleChange} name=\"growth_rates\" />}\n            label=\"Implied growth rate\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.io_events} onChange={props.handleChange} name=\"io_events\" />}\n            label=\"Dosing events log\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.experiments} onChange={props.handleChange} name=\"experiments\" />}\n            label=\"Experiment description\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.od_readings_raw} onChange={props.handleChange} name=\"od_readings_raw\" />}\n            label=\"Raw optical density\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.od_readings_filtered} onChange={props.handleChange} name=\"od_readings_filtered\" />}\n            label=\"Normalized optical density\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.logs} onChange={props.handleChange} name=\"logs\" />}\n            label=\"Event logs\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.alt_media_fraction} onChange={props.handleChange} name=\"alt_media_fraction\" />}\n            label=\"Alternative media fraction\"\n          />\n          <FormControlLabel\n            control={<Checkbox checked={props.isChecked.io_algorithm_settings} onChange={props.handleChange} name=\"io_algorithm_settings\" />}\n            label=\"Dosing algorithm change log\"\n          />\n        </FormGroup>\n      </FormControl>\n    </div>\n)}\n\n\nfunction DownloadDataFormContainer() {\n  const classes = useStyles();\n  const [isRunning, setIsRunning] = React.useState(false)\n  const [isError, setIsError] = React.useState(false)\n  const [errorMsg, setErrorMsg] = React.useState(\"\")\n  const [state, setState] = React.useState({\n    experimentSelection: \"\",\n    datasetCheckbox: {\n      growth_rates: false,\n      io_events: false,\n      experiments: false,\n      od_readings_raw: false,\n      od_readings_filtered: false,\n      logs: false,\n      alt_media_fraction: false,\n      io_algorithm_settings: false,\n    }\n  });\n\n  const onSubmit = (event) =>{\n    event.preventDefault()\n\n    if (!Object.values(state['datasetCheckbox']).some((e) => e)) {\n      setIsError(true)\n      setErrorMsg(\"At least one dataset must be selected.\")\n      return\n    }\n\n    setIsRunning(true)\n    fetch('query_datasets',{\n        method: \"POST\",\n        body: JSON.stringify(state),\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n    }).then(res => res.json())\n      .then(res => {\n      var link = document.createElement(\"a\");\n      link.setAttribute('download', res['filename']);\n      link.href = \"/static/exports/\" + res['filename'];\n      document.body.appendChild(link);\n      link.click();\n      link.remove();\n      setIsRunning(false)\n    }).catch(e => {\n      setIsRunning(false)\n      setIsError(true)\n      setErrorMsg(\"Server error occurred. Check logs.\")\n    });\n  }\n\n  const handleCheckboxChange = (event) => {\n    setState(prevState => ({\n      ...prevState,\n      datasetCheckbox: {...state.datasetCheckbox, [event.target.name]: event.target.checked }\n    }));\n  };\n\n  function handleExperimentSelectionChange(value) {\n    setState(prevState => ({\n      ...prevState,\n      experimentSelection: value\n    }));\n  };\n\n  const runningFeedback = isRunning ? <CircularProgress color=\"white\" size={20}/> : \"Download\"\n  const errorFeedbackOrDefault = isError ? errorMsg : \"Querying large tables may take up to a minute or so.\"\n  return (\n    <>\n      <div>\n        <div>\n          <Typography variant=\"h5\" component=\"h1\">\n            <Box fontWeight=\"fontWeightBold\">\n              Download Experiment Data\n            </Box>\n          </Typography>\n        </div>\n\n      </div>\n      <Card className={classes.root}>\n        <CardContent className={classes.cardContent}>\n          <form>\n            <Grid container spacing={1}>\n              <Grid item xs={12} md={12}>\n                <ExperimentSelection\n                experimentSelection={state.experimentSelection}\n                handleChange={handleExperimentSelectionChange}\n                />\n              </Grid>\n              <Grid item xs={12} md={12}>\n                <CheckboxesGroup\n                isChecked={state.datasetCheckbox}\n                handleChange={handleCheckboxChange}\n                />\n              </Grid>\n\n              <Grid item xs={0}/>\n              <Grid item xs={12}>\n                <Button\n                  type=\"submit\"\n                  variant=\"contained\"\n                  color=\"primary\"\n                  onClick={onSubmit}\n                  style={{width: \"120px\", marginLeft: 24}}\n                >\n                  {runningFeedback}\n                </Button>\n                <p style={{marginLeft: 24}}>{errorFeedbackOrDefault}</p>\n\n              </Grid>\n              <Grid item xs={12}/>\n            </Grid>\n          </form>\n        </CardContent>\n      </Card>\n  </>\n  )\n}\n\n\nfunction DownloadData() {\n    return (\n        <Grid container spacing={2} >\n          <Grid item xs={12}><Header /></Grid>\n          <Grid item xs={12} />\n          <Grid item xs={12} />\n\n          <Grid item md={1} xs={1}/>\n          <Grid item md={10} xs={12}>\n            <DownloadDataFormContainer/>\n          </Grid>\n          <Grid item md={1} xs={1}/>\n        </Grid>\n    )\n}\n\nexport default DownloadData;\n\n","import React, { useState, useEffect } from \"react\";\n\nimport { Client, Message } from \"paho-mqtt\";\n\nimport { makeStyles } from \"@material-ui/styles\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport TextField from \"@material-ui/core/TextField\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\n\nconst useStyles = makeStyles((theme) => ({\n  textFieldCompact: {\n    marginTop: theme.spacing(3),\n    marginRight: theme.spacing(2),\n    marginBottom: theme.spacing(0),\n    width: \"30ch\",\n  },\n  formControl: {\n    marginTop: theme.spacing(2)\n  },\n  unitTitle: {\n    fontSize: 17,\n    color: \"rgba(0, 0, 0, 0.87)\",\n  },\n  unitTitleDialog :{\n    fontSize: 20,\n    color: \"rgba(0, 0, 0, 0.87)\",\n  },\n  suptitle: {\n    fontSize: \"13px\",\n    color: \"rgba(0, 0, 0, 0.60)\",\n  },\n}));\n\nfunction SilentForm(props){\n  const classes = useStyles();\n  const defaults = {duration: 60}\n\n  useEffect(() => {\n    props.updateParent(defaults)\n  }, [])\n\n\n  const onSettingsChange = (e) => {\n    props.updateParent({[e.target.id]: e.target.value})\n  }\n\n  return (\n      <TextField\n        size=\"small\"\n        id=\"duration\"\n        label=\"Duration between events\"\n        defaultValue={defaults.duration}\n        InputProps={{\n          endAdornment: <InputAdornment position=\"end\">min</InputAdornment>,\n        }}\n        variant=\"outlined\"\n        onChange={onSettingsChange}\n        className={classes.textFieldCompact}\n      />\n)}\n\nfunction PIDTurbidostatForm(props){\n  const classes = useStyles();\n  const defaults = {duration: 30, volume: 0.75, target_od: 1.5}\n\n  useEffect(() => {\n    props.updateParent(defaults)\n  }, [])\n\n\n  const onSettingsChange = (e) => {\n    props.updateParent({[e.target.id]: parseFloat(e.target.value)})\n  }\n\n  return (\n      <div>\n        <TextField\n          size=\"small\"\n          id=\"duration\"\n          defaultValue={defaults.duration}\n          InputProps={{\n            endAdornment: <InputAdornment position=\"end\">min</InputAdornment>,\n          }}\n          variant=\"outlined\"\n          onChange={onSettingsChange}\n          className={classes.textFieldCompact}\n          label=\"Duration between events\"\n        />\n        <TextField\n          size=\"small\"\n          id=\"volume\"\n          label=\"Max volume\"\n          defaultValue={defaults.volume}\n          InputProps={{\n            endAdornment: <InputAdornment position=\"end\">mL</InputAdornment>,\n          }}\n          variant=\"outlined\"\n          onChange={onSettingsChange}\n          className={classes.textFieldCompact}\n        />\n        <TextField\n          size=\"small\"\n          id=\"target_od\"\n          label=\"Target OD\"\n          defaultValue={defaults.target_od}\n          InputProps={{\n            endAdornment: <InputAdornment position=\"end\">AU</InputAdornment>,\n          }}\n          variant=\"outlined\"\n          onChange={onSettingsChange}\n          className={classes.textFieldCompact}\n        />\n    </div>\n)}\n\nfunction PIDMorbidostatForm(props){\n  const classes = useStyles();\n  const defaults = {duration: 60, target_growth_rate: 0.1, target_od: 1.5}\n\n  useEffect(() => {\n    props.updateParent(defaults)\n  }, [])\n\n  const onSettingsChange = (e) => {\n    props.updateParent({[e.target.id]: e.target.value})\n  }\n\n  return (\n      <div>\n        <TextField\n          size=\"small\"\n          id=\"duration\"\n          label=\"Duration between events\"\n          defaultValue={defaults.duration}\n          InputProps={{\n            endAdornment: <InputAdornment position=\"end\">min</InputAdornment>,\n          }}\n          variant=\"outlined\"\n          onChange={onSettingsChange}\n          className={classes.textFieldCompact}\n        />\n        <TextField\n          size=\"small\"\n          id=\"target_od\"\n          label=\"Target OD\"\n          defaultValue={defaults.target_od}\n          InputProps={{\n            endAdornment: <InputAdornment position=\"end\">AU</InputAdornment>,\n          }}\n          variant=\"outlined\"\n          onChange={onSettingsChange}\n          className={classes.textFieldCompact}\n        />\n        <TextField\n          size=\"small\"\n          id=\"target_growth_rate\"\n          label=\"Target growth rate\"\n          defaultValue={defaults.target_growth_rate}\n          InputProps={{\n            endAdornment: <InputAdornment position=\"end\">h⁻¹</InputAdornment>,\n          }}\n          variant=\"outlined\"\n          onChange={onSettingsChange}\n          className={classes.textFieldCompact}\n        />\n    </div>\n)}\n\n\n\nfunction ButtonChangeDosingDialog(props) {\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n  const [algoSettings, setAlgoSettings] = useState({io_algorithm: \"silent\"})\n  const [isClicked, setIsClicked] = useState(false)\n  const [client, setClient] = useState(null)\n\n  const algos = [\n    {name: \"Silent\", key: \"silent\"},\n    {name: \"PID Morbidostat\",  key: \"pid_morbidostat\"},\n    {name: \"PID Turbidostat\",  key: \"pid_turbidostat\"},\n    {name: \"Chemostat\", key: \"chemostat\"},\n  ]\n\n  useEffect(() => {\n    // MQTT - client ids should be unique\n    if (!props.config['network.topology']){\n      return\n    }\n\n    if (props.config.remote) {\n      var client = new Client(\n        `ws://${props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      var client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n\n    client.connect();\n    setClient(client)\n  },[props.config])\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleAlgoSelectionChange = (e) => {\n    setAlgoSettings({io_algorithm: e.target.value})\n  }\n\n  const updateFromChild = (setting) => {\n    setAlgoSettings(prevState => ({...prevState, ...setting}))\n  }\n\n  const switchToForm = () => {\n    switch(algoSettings.io_algorithm) {\n      case \"silent\":\n        return <SilentForm updateParent={updateFromChild}/>\n      case \"pid_turbidostat\":\n        return <PIDTurbidostatForm updateParent={updateFromChild}/>\n      case \"pid_morbidostat\":\n        return <PIDMorbidostatForm updateParent={updateFromChild}/>\n      default:\n        return <div><p>Not implemented</p></div>\n    }\n  }\n\n  const onSubmit = (event) => {\n    event.preventDefault()\n    setIsClicked(true)\n    var message = new Message(JSON.stringify(algoSettings));\n    message.destinationName = [\n      \"pioreactor\",\n      props.unit,\n      props.experiment,\n      \"algorithm_controlling\",\n      \"io_algorithm\",\n      \"set\",\n    ].join(\"/\");\n    message.qos = 2;\n    try{\n      client.publish(message);\n    }\n    catch (e){\n      console.log(e)\n    }\n    setOpen(false);\n  }\n  return (\n    <div>\n    <Button\n      style={{marginTop: \"10px\"}}\n      size=\"small\"\n      color=\"primary\"\n      disabled={!props.currentDosingAlgorithm}\n      onClick={handleClickOpen}\n    >\n      Change dosing algorithm\n    </Button>\n    <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\" PaperProps={{style: {height: \"100%\"}}}>\n      <DialogTitle>\n        <Typography className={classes.suptitle}>\n          {props.title || ((props.config['ui.overview.rename'] && props.config['ui.overview.rename'][props.unit]) ? `${props.config['ui.overview.rename'][props.unit]} (${props.unit})` : `${props.unit}`)}\n        </Typography>\n        <Typography className={classes.unitTitleDialog}>\n          Dosing Algorithm\n        </Typography>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant=\"body2\" component=\"p\" gutterBottom>\n          Dosing algorithms control when and how much media to add to the Pioreactor. The settings below can be changed later. Learn more about <a target=\"_blank\" href=\"https://github.com/Pioreactor/pioreactor/wiki/io-algorithms\">dosing algorithms</a>.\n        </Typography>\n\n        <form>\n          <FormControl component=\"fieldset\" className={classes.formControl}>\n          <FormLabel component=\"legend\">Algorithm</FormLabel>\n            <Select\n              native\n              value={algoSettings.mode}\n              onChange={handleAlgoSelectionChange}\n              style={{maxWidth: \"200px\"}}\n            >\n              {algos.map((v) => {\n                return <option id={v.key} value={v.key} key={\"change-io\" + v.key}>{v.name}</option>\n                }\n              )}\n            </Select>\n            {switchToForm()}\n            <Button\n              type=\"submit\"\n              variant=\"contained\"\n              color={isClicked ? \"default\" : \"primary\" }\n              onClick={onSubmit}\n              style={{width: \"120px\", marginTop: \"20px\"}}\n            >\n              Submit\n            </Button>\n          </FormControl>\n        </form>\n\n\n      </DialogContent>\n    </Dialog>\n    </div>\n)}\n\n\nexport default ButtonChangeDosingDialog;\n","import React, {useState} from 'react'\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport { makeStyles } from \"@material-ui/styles\";\n\nconst useStyles = makeStyles({\n  actionTextField: {\n    padding: \"0px 10px 0px 0px\",\n  },\n  actionForm: {\n    padding: \"20px 0px 0px 0px\",\n  }\n});\n\n\nconst actionToAct = {\n  \"remove_waste\": \"Removing waste\",\n  \"add_media\": \"Adding media\",\n  \"add_alt_media\": \"Adding alt. media\",\n\n}\n\nexport default function ActionPumpForm(props) {\n  const emptyState = \"\";\n  const [mL, setML] = useState(emptyState);\n  const [duration, setDuration] = useState(emptyState);\n  const classes = useStyles();\n  const [isMLDisabled, setIsMLDisabled] = useState(false);\n  const [isDurationDisabled, setIsDurationDisabled] = useState(false);\n  const [openSnackbar, setOpenSnackbar] = useState(false);\n\n  function onSubmit(e) {\n    e.preventDefault();\n    if (mL !== emptyState || duration !== emptyState) {\n      const params = mL !== \"\" ? { ml: mL, source_of_event: \"UI\"} : { duration: duration, source_of_event: \"UI\"};\n      fetch(\n        \"/run/\" +\n          props.action +\n          \"/\" +\n          props.unitNumber +\n          \"?\" +\n          new URLSearchParams(params)\n      );\n      setOpenSnackbar(true);\n    }\n  }\n\n  const handleSnackbarClose = () => {\n    setOpenSnackbar(false );\n  };\n\n  function handleMLChange(e) {\n    setML(e.target.value);\n    setIsDurationDisabled(true);\n    if (e.target.value === emptyState) {\n      setIsDurationDisabled(false);\n    }\n  }\n\n  function handleDurationChange(e) {\n    setDuration(e.target.value);\n    setIsMLDisabled(true);\n    if (e.target.value === emptyState) {\n      setIsMLDisabled(false);\n    }\n  }\n\n  return (\n    <form id={props.action} className={classes.actionForm}>\n      <TextField\n        name=\"mL\"\n        value={mL}\n        size=\"small\"\n        id={props.action + \"_mL\"}\n        label=\"mL\"\n        variant=\"outlined\"\n        disabled={isMLDisabled}\n        onChange={handleMLChange}\n        className={classes.actionTextField}\n      />\n      <TextField\n        name=\"duration\"\n        value={duration}\n        size=\"small\"\n        id={props.action + \"_duration\"}\n        label=\"seconds\"\n        variant=\"outlined\"\n        disabled={isDurationDisabled}\n        onChange={handleDurationChange}\n        className={classes.actionTextField}\n      />\n      <br />\n      <br />\n      <Button\n        type=\"submit\"\n        variant=\"contained\"\n        size=\"small\"\n        color=\"primary\"\n        onClick={onSubmit}\n      >\n        {props.action.replace(/_/g, \" \")}\n      </Button>\n      <Snackbar\n        anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n        open={openSnackbar}\n        onClose={handleSnackbarClose}\n        message={actionToAct[props.action] + \" for \" + (duration !== emptyState ? (duration + \" seconds\") : (mL + \"mL\"))}\n        autoHideDuration={7000}\n        key={\"snackbar\" + props.unitNumber + props.action}\n      />\n    </form>\n  );\n}","import clsx from 'clsx';\nimport { Client, Message } from \"paho-mqtt\";\n\nimport React, {useState, useEffect} from \"react\";\n\nimport Grid from '@material-ui/core/Grid';\nimport Header from \"./components/Header\"\nimport PropTypes from 'prop-types';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/Card';\nimport {Typography} from '@material-ui/core';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport Box from '@material-ui/core/Box';\nimport Divider from '@material-ui/core/Divider';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Slider from '@material-ui/core/Slider';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport TextField from '@material-ui/core/TextField';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Button from \"@material-ui/core/Button\";\nimport AddIcon from '@material-ui/icons/Add';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport EditIcon from '@material-ui/icons/Edit';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport {parseINIString} from \"./utilities\"\nimport ButtonChangeDosingDialog from \"./components/ButtonChangeDosingDialog\"\nimport ActionPumpForm from \"./components/ActionPumpForm\"\nimport PioreactorIcon from \"./components/PioreactorIcon\"\nimport TactileButtonNotification from \"./components/TactileButtonNotification\";\nimport BlinkLED from \"./components/BlinkLED\";\n\n\nconst onlineGreen = \"#4caf50\"\nconst offlineGrey = \"grey\"\nconst errorRed = \"#DE3618\"\n\nconst useStyles = makeStyles((theme) => ({\n  textIcon: {\n    fontSize: 15,\n    verticalAlign: \"middle\",\n    margin: \"0px 3px\"\n  },\n  pioreactorCard: {\n    marginTop: \"0px\",\n    marginBottom: \"20px\",\n  },\n  cardContent: {\n    padding: \"10px 20px 20px 20px\"\n  },\n  unitTitle: {\n    fontSize: 20,\n    color: \"rgba(0, 0, 0, 0.87)\",\n    fontWeight: 500,\n  },\n  unitTitleDialog :{\n    fontSize: 20,\n    color: \"rgba(0, 0, 0, 0.87)\",\n  },\n  suptitle: {\n    fontSize: \"13px\",\n    color: \"rgba(0, 0, 0, 0.60)\",\n  },\n  disabledText: {\n    color: \"rgba(0, 0, 0, 0.38)\",\n  },\n  textbox:{\n    width: \"130px\",\n  },\n  textboxLabel:{\n    width: \"100px\",\n  },\n  footnote: {\n    marginBottom: 0,\n    fontSize: 12,\n  },\n  textField: {\n    marginTop: \"15px\",\n    maxWidth: \"180px\",\n  },\n  textFieldWide: {\n    marginTop: \"15px\",\n    maxWidth: \"220px\",\n  },\n  textFieldCompact: {\n    marginTop: theme.spacing(3),\n    marginRight: theme.spacing(2),\n    marginBottom: theme.spacing(0),\n    width: \"30ch\",\n  },\n  slider: {\n    width: \"70%\",\n    margin: \"40px auto 0px auto\",\n  },\n  divider: {\n    marginTop: 15,\n    marginBottom: 10,\n  },\n}));\n\nfunction TabPanel(props) {\n  // move me\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && (\n          <div>{children}</div>\n      )}\n    </div>\n  );\n}\n\nTabPanel.propTypes = {\n  children: PropTypes.node,\n  index: PropTypes.any.isRequired,\n  value: PropTypes.any.isRequired,\n};\n\n\nclass UnitSettingDisplay extends React.Component {\n  // this class polls the MQTT broker for state\n  constructor(props) {\n    super(props);\n    this.state = { msg: this.props.default };\n    this.onConnect = this.onConnect.bind(this);\n    this.onMessageArrived = this.onMessageArrived.bind(this);\n    this.MQTTConnect();\n  }\n\n  updateParent(data) {\n    try {\n      this.props.passChildData(data);\n    } catch (e) {}\n  }\n\n  MQTTConnect() {\n    // need to have unique clientIds\n    if (this.props.config.remote) {\n      this.client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      this.client = new Client(\n        `${this.props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    this.client.connect({ onSuccess: this.onConnect});\n    this.client.onMessageArrived = this.onMessageArrived;\n  }\n\n  onConnect() {\n    this.client.subscribe(\n      [\n        \"pioreactor\",\n        this.props.unit,\n        this.props.experiment,\n        this.props.topic,\n      ].join(\"/\"),\n      { qos: 1 }\n    );\n  }\n\n  stateDisplay = {\n    \"init\":          {display: \"Starting\", color: onlineGreen},\n    \"ready\":         {display: \"On\", color: onlineGreen},\n    \"sleeping\":      {display: \"Paused\", color: offlineGrey},\n    \"disconnected\":  {display: \"Off\", color: offlineGrey},\n    \"lost\":          {display: \"Lost\", color: errorRed},\n    \"NA\":            {display: \"Not available\", color: offlineGrey},\n    \"—\":             {display: \"—\", color: offlineGrey},\n  }\n\n  onMessageArrived(message) {\n    var parsedFloat = parseFloat(message.payloadString);\n    var payload = isNaN(parsedFloat) ? message.payloadString : parsedFloat\n    this.setState({\n      msg: payload,\n    });\n    this.updateParent(payload);\n  }\n\n  render() {\n    if (this.props.isStateSetting) {\n      if (!this.props.isUnitActive) {\n        return <div style={{ color: offlineGrey}}> Off </div>;\n      } else {\n        var displaySettings = this.stateDisplay[this.state.msg]\n        return (\n          <div style={{ color: displaySettings.color, fontWeight: 500}}>\n            {displaySettings.display}\n          </div>\n      )}\n    } else {\n      if (!this.props.isUnitActive || this.state.msg === \"—\" || this.state.msg === \"\") {\n        return <div style={{ color: offlineGrey}}> {this.props.default} </div>;\n      } else {\n        return (\n          <div style={{ color: \"rgba(0, 0, 0, 0.87)\", fontFamily: \"courier\", fontSize: \"14px\" }}>\n            {(typeof this.state.msg === \"string\"\n              ? this.state.msg\n              : +this.state.msg.toFixed(this.props.precision)) +\n              (this.props.measurementUnit ? this.props.measurementUnit : \"\")}\n          </div>\n        );\n      }\n    }\n  }\n}\n\n\n\nfunction ButtonConfirmStopProcessDialog() {\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const onConfirm = () => {\n    fetch(\"/stop\")\n    handleClose()\n  }\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <React.Fragment>\n      <Button style={{textTransform: 'none', marginRight: \"10px\", float: \"right\"}} color=\"secondary\" onClick={handleClickOpen}>\n        <ClearIcon className={classes.textIcon}/> Stop all activity\n      </Button>\n      <Dialog\n        open={open}\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">{\"Stop all Pioreactor activity?\"}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            This will stop stirring, optical density measuring, and IO events from occurring in <b>all</b> Pioreactor units.\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onConfirm} color=\"primary\">\n            OK\n          </Button>\n          <Button onClick={handleClose} color=\"primary\" autoFocus>\n            Cancel\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </React.Fragment>\n  );\n}\n\n\n\nfunction PioreactorHeader() {\n  const classes = useStyles();\n\n  return (\n    <div>\n      <div style={{display: \"flex\", justifyContent: \"space-between\", marginBottom: \"5px\"}}>\n        <Typography variant=\"h5\" component=\"h1\">\n          <Box fontWeight=\"fontWeightBold\">\n            Pioreactors\n          </Box>\n        </Typography>\n        <div >\n          <Button href=\"/add-new-pioreactor\" style={{textTransform: 'none', float: \"right\", marginRight: \"10px\"}} color=\"primary\">\n            <AddIcon className={classes.textIcon}/> Add New Pioreactor\n          </Button>\n        </div>\n      </div>\n      <Divider/>\n    </div>\n  )\n}\n\nfunction Summary(){\n  return (\n    <div>\n    </div>\n)}\n\n\nfunction PatientButton(props) {\n  const [buttonText, setButtonText] = useState(props.buttonText)\n\n  useEffect(\n    () => {\n      setButtonText(props.buttonText)\n    }\n  , [props.buttonText])\n\n  function wrappingOnClick() {\n    function f() {\n      setButtonText(<CircularProgress color=\"inherit\" size={22}/>)\n      props.onClick()\n    }\n    return f\n  }\n\n  return (\n    <Button\n      disableElevation\n      style={{width: \"70px\", marginTop: \"5px\"}}\n      color={props.color}\n      variant={props.variant}\n      size=\"small\"\n      onClick={wrappingOnClick()}\n    >\n      {buttonText}\n    </Button>\n  )\n}\n\n\n\nfunction SettingsActionsDialog(props) {\n  const classes = useStyles();\n  const [defaultStirring, setDefaultStirring] = useState(0);\n  const [open, setOpen] = useState(false);\n  const [client, setClient] = useState(null);\n  const [snackbarOpen, setSnackbarOpen] = useState(false);\n  const [tabValue, setTabValue] = React.useState(0);\n\n  const handleTabChange = (event, newValue) => {\n    setTabValue(newValue);\n  };\n\n  useEffect(() => {\n    async function fetchData() {\n      await fetch(\"/get_config/config_\" + props.unit + \".ini\")\n        .then((response) => {\n            if (response.ok) {\n              return response.text();\n            } else {\n              throw new Error('Something went wrong');\n            }\n          })\n        .then((config) => {\n          config = parseINIString(config);\n          setDefaultStirring(\n            config[\"stirring\"][\"duty_cycle_\" + props.unit]\n          );\n        })\n        .catch((error) => {})\n    }\n    if (!props.disabled) {\n      fetchData();\n    }\n  }, [props.disabled, props.unit]);\n\n  useEffect(() => {\n    if (!props.config['network.topology']){\n      return\n    }\n\n    if (props.config.remote) {\n      var client = new Client(\n        `ws://${props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      var client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    client.connect();\n    setClient(client)\n  },[props.config])\n\n\n  function setPioreactorJobState(job, state) {\n    return function sendMessage() {\n      var message = new Message(String(state));\n      message.destinationName = [\n        \"pioreactor\",\n        props.unit,\n        props.experiment,\n        job,\n        \"$state\",\n        \"set\",\n      ].join(\"/\");\n      message.qos = 1;\n      try{\n        client.publish(message);\n      }\n      catch (e){\n        console.log(e)\n        setTimeout(function(){sendMessage()}, 750)\n      }\n    };\n  }\n\n  function startPioreactorJob(job_attr){\n    return function() {\n      fetch(\"/run/\" + job_attr + \"/\" + props.unit).then(res => {\n      })\n    }\n  }\n\n  function setPioreactorJobAttr(job_attr, value) {\n    var message = new Message(String(value));\n    message.destinationName = [\n      \"pioreactor\",\n      props.unit,\n      props.experiment,\n      job_attr,\n      \"set\",\n    ].join(\"/\");\n    message.qos = 1;\n    try{\n      client.publish(message);\n    }\n    catch (e) {\n      console.log(e)\n      client.connect({onSuccess: () => setPioreactorJobAttr(job_attr, value)});\n    }\n  }\n\n  function setPioreactorJobAttrOnEnter(e) {\n    if (e.key === \"Enter\") {\n      setPioreactorJobAttr(e.target.id, e.target.value);\n      setSnackbarOpen(true)\n    }\n  }\n\n  function setPioreactorStirring(e, value) {\n    setPioreactorJobAttr(\"stirring/duty_cycle\", value);\n  }\n\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setTabValue(0)\n    setOpen(false);\n  };\n\n  const handleSnackbarClose = () => {\n    setSnackbarOpen(false)\n  }\n\n\n  function createUserButtonsBasedOnState(jobState, job, parentJob=null){\n\n    parentJob = parentJob || job\n    switch (jobState){\n      case \"lost\":\n      case \"disconnected\":\n       return (<div>\n               <PatientButton\n                color=\"primary\"\n                variant=\"contained\"\n                onClick={startPioreactorJob(job)}\n                buttonText=\"Start\"\n               />\n              </div>)\n      case \"init\":\n      case \"ready\":\n        return (<div>\n          <PatientButton\n            color=\"secondary\"\n            variant=\"contained\"\n            onClick={setPioreactorJobState(job, \"sleeping\")}\n            buttonText=\"Pause\"\n          />\n          <PatientButton\n            color=\"secondary\"\n            onClick={setPioreactorJobState(parentJob, \"disconnected\")}\n            buttonText=\"Stop\"\n          />\n        </div>)\n      case \"sleeping\":\n        return (\n          <div>\n            <PatientButton\n              color=\"primary\"\n              variant=\"contained\"\n              onClick={setPioreactorJobState(job, \"ready\")}\n              buttonText=\"Resume\"\n            />\n            <PatientButton\n              color=\"secondary\"\n              onClick={setPioreactorJobState(parentJob, \"disconnected\")}\n              buttonText=\"Stop\"\n            />\n          </div>\n          )\n      default:\n        return(<div></div>)\n    }\n   }\n\n  const odButtons = createUserButtonsBasedOnState(props.ODReadingJobState, \"od_reading\")\n  const grButtons = createUserButtonsBasedOnState(props.growthRateJobState, \"growth_rate_calculating\")\n  const ioButtons = createUserButtonsBasedOnState(props.IOEventsJobState, \"io_controlling\", \"algorithm_controlling\")\n  const stirringButtons = createUserButtonsBasedOnState(props.stirringJobState, \"stirring\")\n\n  return (\n    <div>\n    <IconButton aria-label=\"edit Pioreactor\" onClick={handleClickOpen} disabled={props.disabled} style={{marginTop: \"-8px\"}}>\n      <EditIcon color={props.disabled ? \"disabled\" : \"primary\"}/>\n    </IconButton>\n    <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\n      <DialogTitle>\n        <Typography className={classes.suptitle}>\n          {(props.config['ui.overview.rename'] &&  props.config['ui.overview.rename'][props.unit]) ? `${props.config['ui.overview.rename'][props.unit]} / ${props.unit}` : `${props.unit}`}\n        </Typography>\n      <Tabs variant=\"fullWidth\" value={tabValue} onChange={handleTabChange} indicatorColor=\"primary\" textColor=\"primary\">\n        <Tab label=\"Activities\"/>\n        <Tab label=\"Settings\"/>\n        <Tab label=\"Dosing\"/>\n        <Tab label=\"Calibrate\"/>\n      </Tabs>\n      </DialogTitle>\n      <DialogContent>\n        <TabPanel value={tabValue} index={2}>\n          <Typography  gutterBottom>\n            Add media\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Run the media pump{props.isPlural ? \"s\" : \"\"} for a set duration (seconds), or a set volume (mL).\n          </Typography>\n          <ActionPumpForm action=\"add_media\" unit={props.unit} />\n          <Divider className={classes.divider} />\n          <Typography gutterBottom>\n            Add alternative media\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Run the alternative media pump{props.isPlural ? \"s\" : \"\"} for a set duration (seconds), or a set\n            volume (mL).\n          </Typography>\n          <ActionPumpForm action=\"add_alt_media\" unit={props.unit} />\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Remove waste\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Run the waste pump{props.isPlural ? \"s\" : \"\"} for a set duration (seconds), or a set volume (mL).\n          </Typography>\n          <ActionPumpForm action=\"remove_waste\" unit={props.unit} />\n          <Divider className={classes.divider} />\n        </TabPanel>\n        <TabPanel value={tabValue} index={3}>\n          <Typography  gutterBottom>\n            Pump calibration\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            If any pumps are attached to the Pioreactor, they should be calibrated to often\n            to accurately add a precise amount of media.\n          </Typography>\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Temperature calibration\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            If any pumps are attached to the Pioreactor, they should be calibrated to often\n            to accurately add a precise amount of media.\n          </Typography>\n          <Divider className={classes.divider} />\n        </TabPanel>\n        <TabPanel value={tabValue} index={1}>\n          <Typography  gutterBottom>\n            Stirring\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Modify the stirring speed (arbitrary units). This will effect the\n            optical density reading. Too low and the fan may completely stop.\n          </Typography>\n          <div className={classes.slider}>\n            <Slider\n              defaultValue={parseInt(props.stirringDCState)}\n              aria-labelledby=\"discrete-slider-custom\"\n              step={1}\n              valueLabelDisplay=\"on\"\n              id={\"stirring/duty_cycle_\" + props.unit}\n              key={\"stirring/duty_cycle_\" + props.unit}\n              onChangeCommitted={setPioreactorStirring}\n              marks={[\n                { value: 0, label: \"0\", key: \"slider-0\" },\n                { value: defaultStirring, label: \"Default: \" + defaultStirring, key: \"slider-default\"},\n                { value: 100, label: \"100\", key: \"slider-100\" },\n              ]}\n            />\n          </div>\n          <Divider className={classes.divider} />\n          <Typography gutterBottom>\n            Volume per dilution\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change the volume per dilution. Typical values are between 0.0mL and\n            1.0mL.\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/volume\"\n            label=\"Volume per dilution\"\n            defaultValue={props.volumeState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">mL</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textField}\n          />\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Target optical density\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change the target optical density. Typical values are between 1.0 and\n            2.5 (arbitrary units)\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/target_od\"\n            label=\"Target optical density\"\n            defaultValue={props.targetODState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">AU</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textField}\n          />\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Duration between dilutions\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change how long to wait between dilutions. Typically between 5 and 90 minutes.\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/duration\"\n            label=\"Duration\"\n            defaultValue={props.durationState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">min</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textField}\n          />\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Target growth rate\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change the target hourly growth rate - only applicable in{\" \"}\n            <code>morbidostat</code> mode. Typical values are between 0.05h⁻¹ and\n            0.4h⁻¹.\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/target_growth_rate\"\n            label=\"Target growth rate\"\n            defaultValue={props.targetGrowthRateState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">h⁻¹</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textField}\n          />\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Dosing events\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            {props.IOEventsJobState !== \"disconnected\" &&\n              <React.Fragment>\n              Currently running dosing algorithm <code>{props.dosingAlgorithm}</code>.\n              Learn more about <a target=\"_blank\" href=\"https://github.com/Pioreactor/pioreactor/wiki/dosing-algorithms\">dosing algorithms</a>.\n              </React.Fragment>\n            }\n            {props.IOEventsJobState === \"disconnected\" &&\n\n              <React.Fragment>\n              You can change the Dosing algorthm after starting the job.\n              </React.Fragment>\n            }\n          </Typography>\n\n          <ButtonChangeDosingDialog\n            unit={props.unit}\n            config={props.config}\n            experiment={props.experiment}\n            currentDosingAlgorithm={props.dosingAlgorithm}\n          />\n          <Divider className={classes.divider} />\n        </TabPanel>\n        <TabPanel value={tabValue} index={0}>\n          <Typography gutterBottom>\n            Stirring\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Start, stop or pause the stirring on the Pioreactor. Stirring is needed for homogenous mixing.\n          </Typography>\n\n          {stirringButtons}\n\n          <Divider className={classes.divider} />\n          <Typography gutterBottom>\n            Optical density reading\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Pausing the optical density readings will also pause\n            downstream activities that rely on optical density readings, like growth\n            rates.\n          </Typography>\n\n          {odButtons}\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Growth rate calculating\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Pausing the growth rate calculating will also pause\n            downstream activities that rely on it, like dosing events.\n          </Typography>\n\n          {grButtons}\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Dosing events\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            {props.IOEventsJobState !== \"disconnected\" &&\n              <React.Fragment>\n              Currently running dosing algorithm <code>{props.dosingAlgorithm}</code>.\n              Learn more about <a target=\"_blank\" href=\"https://github.com/Pioreactor/pioreactor/wiki/dosing-algorithms\">dosing algorithms</a>.\n              </React.Fragment>\n            }\n            {props.IOEventsJobState === \"disconnected\" &&\n\n              <React.Fragment>\n              Dosing events will initially start in <span className={\"underlineSpan\"} title=\"silent mode performs no dosing operations.\"><code>silent</code></span> mode, and can be changed after.\n              Learn more about <a target=\"_blank\" href=\"https://github.com/Pioreactor/pioreactor/wiki/dosing-algorithms\">dosing algorithms</a>.\n              </React.Fragment>\n            }\n          </Typography>\n\n            {ioButtons}\n\n          <Divider className={classes.divider} />\n        </TabPanel>\n      </DialogContent>\n    </Dialog>\n    <Snackbar\n      anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n      open={snackbarOpen}\n      onClose={handleSnackbarClose}\n      message={\"Updated\"}\n      autoHideDuration={7000}\n      key={\"snackbar\" + props.unit + \"settings\"}\n    />\n    </div>\n  );\n}\n\n\nfunction SettingsActionsDialogAll(props) {\n\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n  const [client, setClient] = useState(null);\n  const [snackbarOpen, setSnackbarOpen] = useState(false);\n  const [tabValue, setTabValue] = React.useState(0);\n\n  const handleTabChange = (event, newValue) => {\n    setTabValue(newValue);\n  };\n\n  useEffect(() => {\n    if (!props.config['network.topology']){\n      return\n    }\n\n    if (props.config.remote) {\n      var client = new Client(\n        `ws://${props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      var client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    client.connect();\n    setClient(client)\n  },[props.config])\n\n\n  function setPioreactorJobState(job, state) {\n    return function sendMessage() {\n      var message = new Message(String(state));\n      message.destinationName = [\n        \"pioreactor\",\n        props.unit,\n        props.experiment,\n        job,\n        \"$state\",\n        \"set\",\n      ].join(\"/\");\n      message.qos = 1;\n      try{\n        client.publish(message);\n      }\n      catch (e){\n        console.log(e)\n        setTimeout(function(){sendMessage()}, 750)\n      }\n    };\n  }\n\n  function startPioreactorJob(job_attr){\n    return function() {\n      fetch(\"/run/\" + job_attr + \"/\" + props.unit).then(res => {\n      })\n    }\n  }\n\n  function setPioreactorJobAttr(job_attr, value) {\n    var message = new Message(String(value));\n    message.destinationName = [\n      \"pioreactor\",\n      props.unit,\n      props.experiment,\n      job_attr,\n      \"set\",\n    ].join(\"/\");\n    message.qos = 1;\n    try{\n      client.publish(message);\n    }\n    catch (e) {\n      console.log(e)\n      client.connect({onSuccess: () => setPioreactorJobAttr(job_attr, value)});\n    }\n  }\n\n  function setPioreactorJobAttrOnEnter(e) {\n    if (e.key === \"Enter\") {\n      setPioreactorJobAttr(e.target.id, e.target.value);\n      setSnackbarOpen(true)\n    }\n  }\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setTabValue(0)\n    setOpen(false);\n  };\n\n  const handleSnackbarClose = () => {\n    setSnackbarOpen(false)\n  }\n\n\n  function createUserButtonsBasedOnState(job, parentJob=null){\n    parentJob = parentJob || job\n    return (<div>\n        <Button\n          className={classes.jobButton}\n          disableElevation\n          color=\"primary\"\n          onClick={startPioreactorJob(job)}\n        >\n          Start\n        </Button>\n        <Button\n          className={classes.jobButton}\n          disableElevation\n          color=\"primary\"\n          onClick={setPioreactorJobState(job, \"sleeping\")}\n        >\n          Pause\n        </Button>\n        <Button\n          className={classes.jobButton}\n          disableElevation\n          color=\"primary\"\n          onClick={setPioreactorJobState(job, \"ready\")}\n        >\n          Resume\n        </Button>\n        <Button\n          className={classes.jobButton}\n          disableElevation\n          color=\"secondary\"\n          onClick={setPioreactorJobState(parentJob, \"disconnected\")}\n        >\n          Stop\n        </Button>\n      </div>\n  )}\n\n  const odButtons = createUserButtonsBasedOnState(\"od_reading\")\n  const grButtons = createUserButtonsBasedOnState(\"growth_rate_calculating\")\n  const ioButtons = createUserButtonsBasedOnState(\"io_controlling\", \"algorithm_controlling\")\n  const stirringButtons = createUserButtonsBasedOnState(\"stirring\")\n\n  return (\n    <React.Fragment>\n    <Button style={{textTransform: 'none', float: \"right\" }} onClick={handleClickOpen} color=\"primary\">\n      <EditIcon className={classes.textIcon}/> Edit all Pioreactors\n    </Button>\n    <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\n      <DialogTitle>\n        <Typography className={classes.suptitle}>\n          All active Pioreactors\n        </Typography>\n      <Tabs value={tabValue} onChange={handleTabChange} indicatorColor=\"primary\" textColor=\"primary\">\n        <Tab label=\"Activities\"/>\n        <Tab label=\"Settings\"/>\n        <Tab label=\"Dosing\"/>\n      </Tabs>\n      </DialogTitle>\n      <DialogContent>\n        <TabPanel value={tabValue} index={1}>\n          <Typography gutterBottom>\n            Volume per dilution\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change the volume per dilution. Typical values are between 0.0mL and\n            1.0mL.\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/volume\"\n            label=\"Volume per dilution\"\n            defaultValue={props.volumeState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">mL</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textFieldWide}\n          />\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Target optical density\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change the target optical density. Typical values are between 1.0 and\n            2.5 (arbitrary units)\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/target_od\"\n            label=\"Target optical density\"\n            defaultValue={props.targetODState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">AU</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textFieldWide}\n          />\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Duration between dilutions\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change how long to wait between dilutions. Typically between 5 and 90 minutes.\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/duration\"\n            label=\"Duration\"\n            defaultValue={props.durationState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">min</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textFieldWide}\n          />\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Target growth rate\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Change the target hourly growth rate - only applicable in{\" \"}\n            <code>morbidostat</code> mode. Typical values are between 0.05h⁻¹ and\n            0.4h⁻¹.\n          </Typography>\n          <TextField\n            size=\"small\"\n            id=\"io_controlling/target_growth_rate\"\n            label=\"Target growth rate\"\n            defaultValue={props.targetGrowthRateState}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">h⁻¹</InputAdornment>,\n            }}\n            variant=\"outlined\"\n            onKeyPress={setPioreactorJobAttrOnEnter}\n            className={classes.textFieldWide}\n          />\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Dosing events\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n              Learn more about <a target=\"_blank\" href=\"https://github.com/Pioreactor/pioreactor/wiki/dosing-algorithms\">dosing algorithms</a>.\n          </Typography>\n\n          <ButtonChangeDosingDialog\n            unit={props.unit}\n            config={props.config}\n            experiment={props.experiment}\n            currentDosingAlgorithm={true}\n            title=\"All active Pioreactors\"\n          />\n          <Divider className={classes.divider} />\n\n        </TabPanel>\n\n        <TabPanel value={tabValue} index={0}>\n          <Typography gutterBottom>\n            Stirring\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Start, stop or pause the stirring on all the Pioreactors. Stirring is needed for homogenous mixing.\n          </Typography>\n\n          {stirringButtons}\n\n          <Divider className={classes.divider} />\n          <Typography gutterBottom>\n            Optical density reading\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Pausing the optical density readings will also pause\n            downstream activities that rely on optical density readings, like growth\n            rates.\n          </Typography>\n\n          {odButtons}\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Growth rate calculating\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Pausing the growth rate calculating will also pause\n            downstream activities that rely on it, like dosing events.\n          </Typography>\n\n          {grButtons}\n\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Dosing events\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\" gutterBottom>\n            Dosing events will initially start in <span className={\"underlineSpan\"} title=\"silent mode performs no IO operations.\"><code>silent</code></span> mode, and can be changed after.\n            Learn more about <a target=\"_blank\" href=\"https://github.com/Pioreactor/pioreactor/wiki/dosing-algorithms\">dosing algorithms</a>.\n          </Typography>\n\n            {ioButtons}\n          <Divider className={classes.divider} />\n        </TabPanel>\n        <TabPanel value={tabValue} index={2}>\n          <Typography  gutterBottom>\n            Add media\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Run the media pump{props.isPlural ? \"s\" : \"\"} for a set duration (seconds), or a set volume (mL).\n          </Typography>\n          <ActionPumpForm action=\"add_media\" unit={props.unit} />\n          <Divider className={classes.divider} />\n          <Typography gutterBottom>\n            Add alternative media\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Run the alternative media pump{props.isPlural ? \"s\" : \"\"} for a set duration (seconds), or a set\n            volume (mL).\n          </Typography>\n          <ActionPumpForm action=\"add_alt_media\" unit={props.unit} />\n          <Divider className={classes.divider} />\n          <Typography  gutterBottom>\n            Remove waste\n          </Typography>\n          <Typography variant=\"body2\" component=\"p\">\n            Run the waste pump{props.isPlural ? \"s\" : \"\"} for a set duration (seconds), or a set volume (mL).\n          </Typography>\n          <ActionPumpForm action=\"remove_waste\" unit={props.unit} />\n          <Divider className={classes.divider} />\n        </TabPanel>\n      </DialogContent>\n    </Dialog>\n    <Snackbar\n      anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n      open={snackbarOpen}\n      onClose={handleSnackbarClose}\n      message={\"Updated\"}\n      autoHideDuration={7000}\n      key={\"snackbar\" + props.unit + \"settings\"}\n    />\n    </React.Fragment>\n  );\n}\n\n\nfunction ActiveUnits(props){\n  return (\n  <React.Fragment>\n    <div style={{display: \"flex\", justifyContent: \"space-between\", marginBottom: \"5px\", marginTop: \"25px\"}}>\n      <Typography variant=\"h5\" component=\"h2\">\n        <Box fontWeight=\"fontWeightRegular\">\n          Active Pioreactors\n        </Box>\n      </Typography>\n      <div >\n        <SettingsActionsDialogAll config={props.config} unit={'$broadcast'} config={props.config} experiment={props.experiment}/>\n        <ButtonConfirmStopProcessDialog/>\n      </div>\n    </div>\n    {props.units.map(unit =>\n      <PioreactorCard config={props.config} isUnitActive={true} key={unit} unit={unit} config={props.config} experiment={props.experiment}/>\n  )}\n  </React.Fragment>\n)}\n\nfunction PioreactorCard(props){\n  const classes = useStyles();\n  const unit = props.unit\n  const isUnitActive = props.isUnitActive\n  const experiment = props.experiment\n  const [stirringDCState, setStirringDCState] = useState(0);\n  const [stirringJobState, setStirringJobState] = useState(\"disconnected\");\n  const [ODReadingJobState, setODReadingJobState] = useState(\"disconnected\");\n  const [growthRateJobState, setGrowthRateJobState] = useState(\"disconnected\");\n  const [IOEventsJobState, setIOEventsJobState] = useState(\"disconnected\");\n  const [temperatureControllingJobState, setTemperatureControllingJobState] = useState(\"disconnected\");\n  const [targetODState, setTargetODState] = useState(0);\n  const [durationState, setDurationState] = useState(0);\n  const [targetGrowthRateState, setTargetGrowthRateState] = useState(0);\n  const [volumeState, setVolumeState] = useState(0);\n  const [dosingAlgorithm, setDosingAlgorithm] = useState(null);\n  const [temperature, setTemperature] = useState(0);\n  return (\n    <Card className={classes.pioreactorCard} id={unit}>\n\n      <CardContent className={classes.cardContent}>\n        <div className={\"fixme\"}>\n          <Typography className={clsx(classes.suptitle)} color=\"textSecondary\">\n            {(props.config['ui.overview.rename'] && props.config['ui.overview.rename'][unit]) ? unit : \"\"}\n          </Typography>\n          <div style={{display: \"flex\", justifyContent: \"space-between\"}}>\n            <Typography className={clsx(classes.unitTitle, {[classes.disabledText]: !isUnitActive})} gutterBottom>\n              <PioreactorIcon color={isUnitActive ? \"black\" : \"disabled\"} style={{verticalAlign: \"middle\"}}/> {(props.config['ui.overview.rename'] && props.config['ui.overview.rename'][unit]) ? props.config['ui.overview.rename'][unit] : unit }\n            </Typography>\n            <div>\n              <SettingsActionsDialog\n                config={props.config}\n                stirringDCState={stirringDCState}\n                ODReadingJobState={ODReadingJobState}\n                growthRateJobState={growthRateJobState}\n                stirringJobState={stirringJobState}\n                IOEventsJobState={IOEventsJobState}\n                temperatureControllingJobState={temperatureControllingJobState}\n                targetGrowthRateState={targetGrowthRateState}\n                volumeState={volumeState}\n                durationState={durationState}\n                targetODState={targetODState}\n                dosingAlgorithm={dosingAlgorithm}\n                temperature={temperature}\n                experiment={experiment}\n                unit={unit}\n                disabled={!isUnitActive}\n                config={props.config}\n              />\n            </div>\n          </div>\n        </div>\n\n\n      <div style={{display: \"flex\", margin: \"15px 20px 20px 0px\"}}>\n        <div className={classes.textboxLabel}>\n          <Typography variant=\"body2\" component=\"body1\">\n            <Box fontWeight=\"fontWeightBold\" className={clsx({[classes.disabledText]: !isUnitActive})}>\n              Activities:\n            </Box>\n          </Typography>\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Stirring\n          </Typography>\n          <UnitSettingDisplay\n            passChildData={setStirringJobState}\n            experiment={experiment}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            isStateSetting\n            topic=\"stirring/$state\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Optical density\n          </Typography>\n          <UnitSettingDisplay\n            passChildData={setODReadingJobState}\n            experiment={experiment}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            isStateSetting\n            topic=\"od_reading/$state\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Growth rate\n          </Typography>\n          <UnitSettingDisplay\n            passChildData={setGrowthRateJobState}\n            experiment={experiment}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            isStateSetting\n            topic=\"growth_rate_calculating/$state\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            IO control\n          </Typography>\n          <UnitSettingDisplay\n            passChildData={setIOEventsJobState}\n            experiment={experiment}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            isStateSetting\n            topic=\"io_controlling/$state\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Temperature control\n          </Typography>\n          <UnitSettingDisplay\n            passChildData={setTemperatureControllingJobState}\n            experiment={experiment}\n            isUnitActive={isUnitActive}\n            default=\"NA\"\n            isStateSetting\n            topic=\"temperature_controlling/$state\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n      </div>\n      <Divider/>\n\n\n      <div style={{display: \"flex\", margin: \"20px 20px 20px 0px\"}}>\n        <div className={classes.textboxLabel}>\n          <Typography variant=\"body2\" component=\"body1\">\n            <Box fontWeight=\"fontWeightBold\"  className={clsx({[classes.disabledText]: !isUnitActive})}>\n              Settings:\n            </Box>\n          </Typography>\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Stirring speed\n          </Typography>\n          <UnitSettingDisplay\n            passChildData={setStirringDCState}\n            experiment={experiment}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            className={classes.alignRight}\n            topic=\"stirring/duty_cycle\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Target OD\n          </Typography>\n          <UnitSettingDisplay\n            precision={2}\n            experiment={experiment}\n            passChildData={setTargetODState}\n            isUnitActive={isUnitActive}\n            default={\"—\"}\n            className={classes.alignRight}\n            topic=\"io_controlling/target_od\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Target growth rate\n          </Typography>\n          <UnitSettingDisplay\n            precision={2}\n            measurementUnit=\"h⁻¹\"\n            experiment={experiment}\n            passChildData={setTargetGrowthRateState}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            className={classes.alignRight}\n            topic=\"io_controlling/target_growth_rate\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Dosing algorithm\n          </Typography>\n          <UnitSettingDisplay\n            experiment={experiment}\n            passChildData={setDosingAlgorithm}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            className={classes.alignRight}\n            topic=\"algorithm_controlling/io_algorithm\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Volume / dilution\n          </Typography>\n          <UnitSettingDisplay\n            precision={2}\n            measurementUnit=\"mL\"\n            experiment={experiment}\n            passChildData={setVolumeState}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            className={classes.alignRight}\n            topic=\"io_controlling/volume\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Time between dosing events\n          </Typography>\n          <UnitSettingDisplay\n            precision={0}\n            measurementUnit=\"m\"\n            experiment={experiment}\n            passChildData={setDurationState}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            className={classes.alignRight}\n            topic=\"io_controlling/duration\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n        <div className={classes.textbox}>\n          <Typography variant=\"body2\" style={{fontSize: \"0.85rem\"}}>\n            Target temperature\n          </Typography>\n          <UnitSettingDisplay\n            experiment={experiment}\n            passChildData={setTemperature}\n            isUnitActive={isUnitActive}\n            default=\"—\"\n            className={classes.alignRight}\n            topic=\"temperature_controlling/temperature\"\n            unit={unit}\n            config={props.config}\n          />\n        </div>\n      </div>\n\n\n      </CardContent>\n    </Card>\n)}\n\n\nfunction InactiveUnits(props){\n\n  return (\n  <React.Fragment>\n    <div style={{display: \"flex\", justifyContent: \"space-between\", marginBottom: \"5px\", marginTop: \"25px\"}}>\n      <Typography variant=\"h5\" component=\"h2\">\n        <Box fontWeight=\"fontWeightRegular\">\n          Inactive Pioreactors\n        </Box>\n      </Typography>\n    </div>\n    {props.units.map(unit =>\n      <PioreactorCard isUnitActive={false} key={unit} unit={unit} config={props.config} experiment={props.experiment}/>\n  )}\n    </React.Fragment>\n)}\n\nfunction Pioreactors(props) {\n    const [experimentMetadata, setExperimentMetadata] = React.useState({})\n\n    React.useEffect(() => {\n      async function getLatestExperiment() {\n           await fetch(\"/get_latest_experiment\")\n          .then((response) => {\n            return response.json();\n          })\n          .then((data) => {\n            setExperimentMetadata(data)\n          });\n        }\n      getLatestExperiment()\n    }, [])\n\n    const entries = (a) => Object.entries(a)\n\n    return (\n        <Grid container spacing={2} >\n          <Grid item xs={12}><Header /></Grid>\n          <Grid item xs={12} />\n          <Grid item xs={12} />\n\n          <Grid item md={1} xs={1}/>\n          <Grid item md={10} xs={12}>\n            <PioreactorHeader/>\n            <Summary/>\n            <ActiveUnits experiment={experimentMetadata.experiment} config={props.config} units={props.config['inventory'] ? entries(props.config['inventory']).filter((v) => v[1] === \"1\").map((v) => v[0]) : [] }/>\n            <InactiveUnits experiment={experimentMetadata.experiment} config={props.config} units={props.config['inventory'] ? entries(props.config['inventory']).filter((v) => v[1] === \"0\").map((v) => v[0]) : [] }/>\n          </Grid>\n          <Grid item md={1} xs={1}/>\n          {props.config['ui.overview.rename'] ? <TactileButtonNotification config={props.config}/> : null}\n        </Grid>\n    )\n}\n\nexport default Pioreactors;\n\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport StepContent from '@material-ui/core/StepContent';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n  },\n  button: {\n    marginTop: theme.spacing(1),\n    marginRight: theme.spacing(1),\n  },\n  actionsContainer: {\n    marginBottom: theme.spacing(2),\n  },\n  resetContainer: {\n    padding: theme.spacing(3),\n  },\n  divInstructions: {\n    marginBottom: theme.spacing(3),\n  }\n}));\n\n\n\nfunction CycleLiquid(props) {\n  const classes = useStyles();\n  const liquid = props.liquid\n  const [isClicked, setIsClicked] = React.useState(false)\n\n  const onSubmit = () => {\n    fetch(\"/run/remove_waste/$broadcast?\" + new URLSearchParams({duration: 90, duty_cycle: 100}));\n    fetch(\"/run/add_media/$broadcast?\" + new URLSearchParams({duration: 50, duty_cycle: 25}));\n    fetch(\"/run/add_alt_media/$broadcast?\" + new URLSearchParams({duration: 50, duty_cycle: 25}));\n    setIsClicked(true)\n  }\n\n  return (\n    <div className={classes.divInstructions}>\n      <p>{props.additionalMsg}</p>\n      <p>Add <b>{liquid}</b> to the non-waste containers. We will cycle this solution through our system. Click the button below once the {liquid} is in place.</p>\n      <Button className={classes.button} variant=\"contained\" color={isClicked ? \"default\" : \"primary\" } onClick={onSubmit}>Cycle {liquid}</Button>\n    </div>\n    )\n}\n\n\nfunction MediaFlush(props) {\n  const classes = useStyles();\n  const isAlt = props.altMedia\n  const [isClicked, setIsClicked] = React.useState(false)\n\n  const onSubmit = () => {\n    fetch(\"/run/remove_waste/$broadcast?\" + new URLSearchParams({duration: 60, duty_cycle: 100}));\n    if (isAlt){\n      fetch(\"/run/add_alt_media/$broadcast?\" + new URLSearchParams({duration: 15, duty_cycle: 25}));\n    } else {\n      fetch(\"/run/add_media/$broadcast?\" + new URLSearchParams({duration: 15, duty_cycle: 25}));\n    }\n    setIsClicked(true)\n  }\n\n  return (\n    <div className={classes.divInstructions}>\n      <p>Next, we will prime the {isAlt ? \"alt-\" : \"\"}media tubes with our {isAlt ? \"alt-\" : \"\"}media.</p>\n      <p>Replace the container attached to the {isAlt ? \"alt-\" : \"\"}media outflow tubes with the sterlized {isAlt ? \"alt-\" : \"\"}media container. Remember to use proper sanitation techniques!</p>\n      <Button className={classes.button} variant=\"contained\" color={isClicked ? \"default\" : \"primary\" } onClick={onSubmit}>Run {isAlt ? \"alt-\" : \"\"}media and waste pumps</Button>\n    </div>\n    )\n}\n\nfunction AddFinalVolumeOfMedia(props) {\n  const classes = useStyles();\n  const [isClicked, setIsClicked] = React.useState(false)\n\n\n  const onSubmit = () => {\n    fetch(\"/run/add_media/$broadcast?\" + new URLSearchParams({ml: 12}));\n    setIsClicked(true)\n  }\n\n  return (\n    <div className={classes.divInstructions}>\n      <p> Finally, we will add fresh media to our vials </p>\n      <Button className={classes.button} variant=\"contained\" color={isClicked ? \"default\" : \"primary\" } onClick={onSubmit}>Add 12mL of media</Button>\n    </div>\n    )\n}\n\n\nfunction getSteps() {\n  return [\n    'Setup inflow and outflow tubes',\n    '10% bleach cycling',\n    '70% alcohol cycling',\n    'Distilled water cycling',\n    'Media preparation',\n    'Alt media preparation',\n    'Replace vials',\n    'Add initial media to vials'];\n}\n\n\nfunction getStepContent(step) {\n  switch (step) {\n    case 0:\n      return `For each pioreactor unit, connect the media inflow, alt-media inflow, and waste out flow tubes to an empty\n      vial with hat. Connect the all the media outflow tubes to a single empty container, all the alt-media outflow tubes to a single empty container, and\n      all the waste inflow tubes to a single, empty, large container.`;\n    case 1:\n      return <CycleLiquid liquid={\"10% bleach solution\"}/>;\n    case 2:\n      return <CycleLiquid additionalMsg={\"Remove any excess bleach from the containers, and empty the waste container. Bleach and alcohol should not mix.\"} liquid={\"70% alcohol\"}/>;\n    case 3:\n      return <CycleLiquid liquid={\"distilled water\"}/>;\n    case 4:\n      return <MediaFlush />;\n    case 5:\n      return <MediaFlush altMedia={true}/>;\n    case 6:\n      return `Using proper sanitation techniques, replace the pioreactor vials - now full of water and media - with the empty-but-innocculated vials`;\n    case 7:\n      return <AddFinalVolumeOfMedia/>;\n    default:\n      return 'Unknown step';\n  }\n}\n\nexport default function VerticalLinearStepper() {\n  const classes = useStyles();\n  const [activeStep, setActiveStep] = React.useState(0);\n  const steps = getSteps();\n\n  const handleNext = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  const handleReset = () => {\n    setActiveStep(0);\n  };\n\n  return (\n    <div className={classes.root}>\n      <Stepper activeStep={activeStep} orientation=\"vertical\">\n        {steps.map((label, index) => (\n          <Step key={label}>\n            <StepLabel>{label}</StepLabel>\n            <StepContent>\n              <Typography>{getStepContent(index)}</Typography>\n              <div className={classes.actionsContainer}>\n                  <Button\n                    disabled={activeStep === 0}\n                    onClick={handleBack}\n                    className={classes.button}\n                  >\n                    Back\n                  </Button>\n                  <Button\n                    variant=\"contained\"\n                    onClick={handleNext}\n                    className={classes.button}\n                  >\n                    {activeStep === steps.length - 1 ? 'Finish' : 'Next'}\n                  </Button>\n              </div>\n            </StepContent>\n          </Step>\n        ))}\n      </Stepper>\n      {activeStep === steps.length && (\n        <Paper square elevation={0} className={classes.resetContainer}>\n          <Typography>All cleaning and preparation steps completed!</Typography>\n          <Button onClick={handleReset} className={classes.button}>\n            Reset\n          </Button>\n        </Paper>\n      )}\n    </div>\n  );\n}","import React from \"react\";\nimport Grid from '@material-ui/core/Grid';\nimport Button from \"@material-ui/core/Button\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Chart from \"./Chart\";\n\n\n\nfunction StartStirringButton(props){\n\n  const [isClicked, setIsClicked] = React.useState(false)\n  const [openSnackbar, setOpenSnackbar] = React.useState(false);\n\n  const onClick = (e) => {\n    setIsClicked(true)\n    fetch(\"/run/stirring/$broadcast\").then(res => {\n      if (res.status === 200){\n        setOpenSnackbar(true);\n      }\n    })\n  }\n\n  const handleSnackbarClose = () => {\n    setOpenSnackbar(false);\n  };\n\n  return(\n    <div>\n      <p> To get an accurate reading, we need to start start the stirring. This also provides gas transfer and keeps the cells in suspension.</p>\n      <Button variant=\"contained\"  color=\"primary\" disabled={isClicked ? true : false } onClick={onClick}> Start stirring </Button>\n      <Snackbar\n      anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n      open={openSnackbar}\n      onClose={handleSnackbarClose}\n      message={\"Stirring starting\"}\n      autoHideDuration={7000}\n      key={\"snackbarStirring\"}\n    />\n  </div>\n  )\n}\n\n\nfunction StartODReading(props){\n\n  const [isClicked, setIsClicked] = React.useState(false)\n  const [openSnackbar, setOpenSnackbar] = React.useState(false);\n\n  const onClick = (e) => {\n    setIsClicked(true)\n    fetch(\"/run/od_reading/$broadcast\").then(res => {\n      if (res.status === 200){\n        setOpenSnackbar(true);\n      }\n    })\n  }\n\n  const handleSnackbarClose = () => {\n    setOpenSnackbar(false);\n  };\n\n  return(\n    <div>\n      <p> Next, we will turn on the optical density reading. We also call this <em>OD readings</em>. This will provide us with a measure of cell density. After a minute or so, you should see the data in the chart below. </p>\n      <Button variant=\"contained\"  color=\"primary\" disabled={isClicked ? true : false } onClick={onClick}> Start OD readings </Button>\n      <Snackbar\n      anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n      open={openSnackbar}\n      onClose={handleSnackbarClose}\n      message={\"OD reading starting\"}\n      autoHideDuration={7000}\n      key={\"snackbarOD\"}\n    />\n  </div>\n  )\n}\n\n\nfunction StartSensors(props){\n\n\n  return (\n    <Grid\n      container\n      direction=\"column\"\n      justify=\"flex-start\"\n      alignItems=\"center\"\n      spacing={2}\n    >\n      <Grid item xs={2}/>\n      <Grid item xs={10}><StartStirringButton/></Grid>\n      <Grid item xs={10}><StartODReading/></Grid>\n      <Grid item xs={12}>\n        <Chart\n          config={{}}\n          isODReading={true}\n          fontScale={1.0}\n          interpolation=\"stepAfter\"\n          title=\"Raw 135° optical density\"\n          topic=\"od_raw/135/+\"\n          yAxisLabel=\"Voltage\"\n          experiment=\"+\"\n        />\n      </Grid>\n      <Grid item xs={2}/>\n    </Grid>\n)}\n\n\nexport default StartSensors;\n","import { Client } from \"paho-mqtt\";\n\nimport React from \"react\";\nimport Grid from '@material-ui/core/Grid';\nimport Button from \"@material-ui/core/Button\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Chart from \"./Chart\";\n\n\n\nfunction StartGrowthRate(props){\n\n  const [openSnackbar, setOpenSnackbar] = React.useState(false);\n  const [snackbarMessage, setSnackbarMessage] = React.useState(\"\");\n  const [isClicked, setIsClicked] = React.useState(false);\n\n  const onClick = (e) => {\n    fetch(\"/run/growth_rate_calculating/$broadcast\").then(r => {\n      setSnackbarMessage(\"Growth rate calculating starting\")\n      setOpenSnackbar(true)\n      setIsClicked(true)\n    })\n  }\n\n  const handleSnackbarClose = () => {\n    setOpenSnackbar(false);\n  };\n\n  return(\n    <div>\n      <p>Because of the varying strength & quality of the electronics, not all readings look the same - even for the same density of cells. So we compute a baseline measurement from the OD readings, and measure all growth against that baseline. </p>\n      <p>From the (normalized) OD readings, we can calculate the <em>implied hourly growth rate</em>, which is our measure of growth. </p>\n      <p>Let's start the growth rate calculations. This first computes the normalization constants, <b>which can take up to two minutes to complete</b>. After that, the graph below should start to populate.</p>\n      <Button variant=\"contained\"  color=\"primary\" disabled={isClicked ? true : false } onClick={onClick}> Start growth rate calculations </Button>\n      <Snackbar\n      anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n      open={openSnackbar}\n      onClose={handleSnackbarClose}\n      message={snackbarMessage}\n      autoHideDuration={7000}\n      key={\"snackbarGR\"}\n      />\n  </div>\n  )\n}\n\n\n\n\nfunction StartCalculations(props){\n  const [experiment, setExperiment] = React.useState(\"null_exp\")\n\n  React.useEffect(() => {\n    async function getData() {\n         await fetch(\"/get_latest_experiment\")\n        .then((response) => {\n          return response.json();\n        })\n        .then((data) => {\n          setExperiment(data.experiment)\n        });\n      }\n      getData()\n  }, [])\n\n  return (\n    <Grid\n      container\n      direction=\"column\"\n      justify=\"flex-start\"\n      alignItems=\"center\"\n      spacing={2}\n    >\n      <Grid item xs={2}/>\n      <Grid item xs={10}><StartGrowthRate experiment={experiment}/></Grid>\n      <Grid item xs={12}>\n      <Chart\n        config={{}}\n        interpolation=\"stepAfter\"\n        fontScale={1}\n        title=\"Implied growth rate\"\n        topic=\"growth_rate\"\n        yAxisLabel=\"Growth rate, h⁻¹\"\n        experiment={experiment}\n      />\n      </Grid>\n      <Grid item xs={2}/>\n    </Grid>\n)}\n\n\nexport default StartCalculations;\n","import React from \"react\";\nimport moment from \"moment\";\nimport { Client, Message } from \"paho-mqtt\";\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/Card';\nimport {Typography} from '@material-ui/core';\nimport Button from \"@material-ui/core/Button\";\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport TextField from '@material-ui/core/TextField';\nimport Snackbar from '@material-ui/core/Snackbar';\n\nimport Header from \"./components/Header\"\nimport CleaningScript from \"./components/CleaningScript\"\nimport StartSensors from \"./components/StartSensors\"\nimport StartCalculations from \"./components/StartCalculations\"\n\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    marginTop: \"15px\"\n  },\n  cardContent: {\n    padding: \"10px\"\n  },\n  button: {\n    marginRight: theme.spacing(1),\n  },\n  instructions: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(4),\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    width: \"60%\"\n  },\n  textField:{\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  formControl: {\n    margin: theme.spacing(3),\n  },\n  halfTextField: {\n    width: \"95%\"\n  },\n}));\n\n\n\n\nfunction ExperimentSummaryForm(props) {\n  const classes = useStyles();\n  const [openSnackbar, setOpenSnackbar] = React.useState(false);\n  const [formError, setFormError] = React.useState(false);\n  const [expName, setExpName] = React.useState(\"\");\n  const [timestamp, setTimestamp] = React.useState(moment().format(\"YYYY-MM-DDTHH:mm:ss\"));\n  const [description, setDescription] = React.useState(\"\");\n\n\n  function publishExpNameToMQTT(){\n\n    function onConnect() {\n      var message = new Message(expName);\n      message.destinationName = \"pioreactor/latest_experiment\"\n      message.qos = 1;\n      message.retained = true;\n      client.publish(message);\n    }\n\n    if (props.config.remote) {\n      var client = new Client(\n        `ws://${this.props.config.remote.ws_url}/`,\n        \"webui\" + Math.random()\n      )}\n    else {\n      var client = new Client(\n        `${props.config['network.topology']['leader_hostname']}.local`, 9001,\n        \"webui\" + Math.random()\n      );\n    }\n    client.connect({ onSuccess: onConnect });\n\n  }\n\n  function killExistingJobs(){\n     fetch('/stop')\n  }\n\n  function onSubmit(e) {\n    e.preventDefault();\n    if (expName === \"\"){\n      setFormError(true)\n      return\n    }\n    fetch('create_experiment',{\n        method: \"POST\",\n        body: JSON.stringify({experiment : expName, timestamp: timestamp, description: description}),\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      }).then(res => {\n        if (res.status === 200){\n          setFormError(false);\n          setOpenSnackbar(true);\n          killExistingJobs()\n          publishExpNameToMQTT()\n        }\n        else{\n          setFormError(true);\n        }\n      }\n     )\n  }\n\n  const onExpNameChange = (e) => {\n    setExpName(e.target.value)\n  }\n  const onDescChange = (e) => {\n    setDescription(e.target.value)\n  }\n  const onTimestampChange = (e) => {\n    setTimestamp(e.target.value)\n  }\n\n  const handleSnackbarClose = () => {\n    setOpenSnackbar(false);\n  };\n\n  return (\n    <div className={classes.root}>\n        <FormGroup>\n        <Grid container spacing={1}>\n          <Grid item xs={12} md={6}>\n            <TextField\n              error={formError}\n              id=\"expName\"\n              label=\"Experiment name\"\n              required className={`${classes.halfTextField} ${classes.textField}`}\n              onChange={onExpNameChange}\n              />\n          </Grid>\n          <Grid item xs={12} md={6}>\n            <TextField\n              id=\"datetime\"\n              label=\"Start time\"\n              type=\"datetime-local\"\n              defaultValue={timestamp}\n              className={`${classes.halfTextField} ${classes.textField}`}\n              onChange={onTimestampChange}\n              InputLabelProps={{\n                shrink: true,\n              }}\n            />\n          </Grid>\n          <Grid item xs={12} md={12}>\n            <TextField\n              label=\"Description\"\n              rowsMax={4}\n              placeholder={\"Add a description: what microbe are you using? What is the media composition? This description can always be changed later.\"}\n              multiline\n              className={classes.textField}\n              onChange={onDescChange}\n              fullWidth={true}\n            />\n          </Grid>\n          <Grid item xs={12} md={10}/>\n          <Grid item xs={12} md={2}>\n            <Button variant=\"contained\" color=\"primary\" onClick={onSubmit}> Create </Button>\n            <Snackbar\n              anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n              open={openSnackbar}\n              onClose={handleSnackbarClose}\n              message={\"Created new experiment\"}\n              autoHideDuration={7000}\n              key={\"snackbar\" + props.unitNumber + props.action}\n            />\n          </Grid>\n        </Grid>\n        </FormGroup>\n    </div>\n  )\n}\n\n\n\nfunction getSteps(config) {\n  return [\n    {title: 'Experiment summary', content: <ExperimentSummaryForm config={config} />, optional: true},\n    {title: 'Cleaning and preparation', content: <CleaningScript config={config}/>, optional: true},\n    {title: 'Start sensors', content: <StartSensors config={config}/>, optional: true},\n    {title: 'Start calculations', content: <StartCalculations config={config}/>, optional: false},\n  ];\n}\n\n\n\nfunction StartNewExperimentContainer(props) {\n  const classes = useStyles();\n  const [activeStep, setActiveStep] = React.useState(0);\n  const [skipped, setSkipped] = React.useState(new Set());\n  const steps = getSteps(props.config);\n\n  const getStepContent = (index) => {\n    return steps[index].content\n  }\n  const isStepOptional = (index) => {\n    return steps[index].optional\n  };\n\n  const isStepSkipped = (step) => {\n    return skipped.has(step);\n  };\n\n  const handleNext = () => {\n    if (activeStep === steps.length - 1){\n      window.location.href = \"/overview\";\n    } else {\n\n      let newSkipped = skipped;\n      if (isStepSkipped(activeStep)) {\n        newSkipped = new Set(newSkipped.values());\n        newSkipped.delete(activeStep);\n      }\n\n      setActiveStep((prevActiveStep) => prevActiveStep + 1);\n      setSkipped(newSkipped);\n      window.scrollTo({top: 0})\n    }\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  const handleSkip = () => {\n    if (!isStepOptional(activeStep)) {\n      throw new Error(\"You can't skip a step that isn't optional.\");\n    }\n\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    setSkipped((prevSkipped) => {\n      const newSkipped = new Set(prevSkipped.values());\n      newSkipped.add(activeStep);\n      return newSkipped;\n    });\n  };\n\n  const handleReset = () => {\n    setActiveStep(0);\n  };\n\n  return (\n    <Card className={classes.root}>\n      <CardContent className={classes.cardContent}>\n        <Typography variant=\"h5\" component=\"h1\">\n          Start a new experiment\n        </Typography>\n        <Stepper activeStep={activeStep}>\n          {steps.map((step, index) => {\n            const stepProps = {};\n            const labelProps = {};\n            if (step.optional) {\n              labelProps.optional = <Typography variant=\"caption\">Optional</Typography>;\n            }\n            if (isStepSkipped(index)) {\n              stepProps.completed = false;\n            }\n            return (\n              <Step key={step.title} {...stepProps}>\n                <StepLabel {...labelProps}>{step.title}</StepLabel>\n              </Step>\n            );\n          })}\n        </Stepper>\n        <div>\n          {activeStep === steps.length ? (\n            <div>\n              <Typography className={classes.instructions}>\n                All steps completed - you&apos;re finished\n              </Typography>\n              <Button onClick={handleReset} className={classes.button}>\n                Reset\n              </Button>\n            </div>\n          ) : (\n            <div>\n              <Typography className={classes.instructions}>{getStepContent(activeStep)}</Typography>\n              <div>\n                <Button disabled={activeStep === 0} onClick={handleBack} className={classes.button}>\n                  Back\n                </Button>\n                {isStepOptional(activeStep) && (\n                  <Button\n                    variant=\"contained\"\n                    onClick={handleSkip}\n                    className={classes.button}\n                  >\n                    Skip\n                  </Button>\n                )}\n\n                <Button\n                  variant=\"contained\"\n                  onClick={handleNext}\n                  className={classes.button}\n                >\n                  {activeStep === steps.length - 1 ? 'Go to overview' : 'Next'}\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n\n\nfunction StartNewExperiment() {\n    return (\n        <Grid container spacing={2} >\n          <Grid item xs={12}><Header /></Grid>\n\n          <Grid item xs={1}/>\n          <Grid item xs={10}>\n            <div><StartNewExperimentContainer/></div>\n          </Grid>\n          <Grid item xs={1}/>\n        </Grid>\n    )\n}\n\nexport default StartNewExperiment;\n\n","import React from \"react\";\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/Card';\nimport Button from '@material-ui/core/Button';\nimport Box from '@material-ui/core/Box';\nimport {Typography} from '@material-ui/core';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Select from '@material-ui/core/Select';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nimport { CodeFlaskReact } from \"react-codeflask\"\n\nimport Header from \"./components/Header\"\n\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    marginTop: \"15px\"\n  },\n  title: {\n    fontSize: 14,\n  },\n  cardContent: {\n    padding: \"10px\"\n  },\n  pos: {\n    marginBottom: 0,\n  },\n}));\n\n\n\nclass EditableCodeDiv extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      code: \"\",\n      openSnackbar: false,\n      filename: \"config.ini\",\n      snackbarMsg: \"\",\n      isRunning: false,\n      availableConfigs: [\n        {name: \"shared config.ini\", filename: \"config.ini\"},\n      ]\n    };\n    this.saveCurrentCode = this.saveCurrentCode.bind(this);\n  }\n\n  async getConfig(filename) {\n    await fetch(\"/get_config/\" + filename)\n      .then(response => {\n        return response.text();\n      })\n      .then(text => {\n        this.setState({code: text});\n      })\n  }\n\n  async getListOfConfigFiles(filename) {\n    await fetch(\"/get_configs\")\n      .then(response => {\n        return response.json();\n      })\n      .then(json => {\n        this.setState(prevState => ({\n          availableConfigs: [...prevState.availableConfigs, ...json.filter(e => (e !== 'config.ini')).map(e => ({name: e, filename: e}))]\n        }));\n      })\n  }\n\n  saveCurrentCode() {\n    this.setState({isRunning: true})\n    fetch('/save_new_config',{\n        method: \"POST\",\n        body: JSON.stringify({code :this.state.code, filename: this.state.filename}),\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n    .then(res => {\n      if (res.ok) {\n        this.setState({snackbarMsg: this.state.filename + \" saved and synced.\"})\n      } else {\n        this.setState({snackbarMsg: \"Hm. Something when wrong saving or syncing...\"})\n      }\n      this.setState({openSnackbar: true, isRunning: false});\n    })\n  }\n\n  componentDidMount() {\n    this.getConfig(this.state.filename)\n    this.getListOfConfigFiles()\n  }\n\n  onSelectionChange = (e) => {\n    this.setState({filename: e.target.value})\n    this.getConfig(e.target.value)\n  }\n\n  getCodeFlaskRef = (codeFlask) => {\n    this.codeFlask = codeFlask\n  }\n\n  onTextChange = (code) => {\n    this.setState({code: code})\n  }\n\n  handleSnackbarClose = () => {\n    this.setState({openSnackbar: false});\n  };\n\n  render() {\n    const runningFeedback = this.state.isRunning ? <CircularProgress color=\"inherit\" size={25}/> : \"Save\"\n    return (\n      <React.Fragment>\n        <Select\n          style={{margin: \"10px 10px 10px 10px\"}}\n          native\n          value={this.state.filename}\n          onChange={this.onSelectionChange}\n          inputProps={{\n            name: 'config',\n            id: 'config',\n          }}\n        >\n          {this.state.availableConfigs.map((v) => {\n            return <option key={v.filename} value={v.filename}>{v.name}</option>\n            }\n          )}\n        </Select>\n\n        <div style={{letterSpacing: \"0em\", margin: \"10px auto 10px auto\", position: \"relative\", width: \"98%\", height: \"300px\", border: \"1px solid #ccc\"}}>\n          <CodeFlaskReact\n            code={this.state.code}\n            onChange={this.onTextChange}\n            editorRef={this.getCodeFlaskRef}\n            language={\"python\"}\n          />\n        </div>\n        <Button\n          style={{margin: \"5px 10px 5px 10px\"}}\n          color=\"primary\"\n          variant=\"contained\"\n          onClick={this.saveCurrentCode}\n          disabled={false}>\n          {runningFeedback}\n        </Button>\n        <Snackbar\n          anchorOrigin={{vertical: \"bottom\", horizontal: \"center\"}}\n          open={this.state.openSnackbar}\n          onClose={this.handleSnackbarClose}\n          message={this.state.snackbarMsg}\n          autoHideDuration={2000}\n          key={\"edit-config-snackbar\"}\n        />\n      </React.Fragment>\n    )\n  }\n}\n\n\n\n\nfunction EditConfigContainer(){\n  const classes = useStyles();\n\n  return(\n    <React.Fragment>\n      <div>\n        <div>\n          <Typography variant=\"h5\" component=\"h2\">\n            <Box fontWeight=\"fontWeightBold\">\n              Edit config.ini\n            </Box>\n          </Typography>\n        </div>\n      </div>\n      <Card className={classes.root}>\n        <CardContent className={classes.cardContent}>\n          <p>Update the <code>config.ini</code> files. The shared <code>config.ini</code> will be deployed to <em>all</em> Pioreactors, but can be overwritten with a specific Pioreactor's <code>config.ini</code>. <a href=\"https://github.com/Pioreactor/pioreactor/wiki/Configuration-via-config.ini\" target=\"_blank\">Learn more about Pioreactor configuration</a>.</p>\n          <EditableCodeDiv/>\n        </CardContent>\n      </Card>\n    </React.Fragment>\n)}\n\n\nfunction EditConfig() {\n    return (\n        <Grid container spacing={2} >\n          <Grid item xs={12}><Header /></Grid>\n          <Grid item md={12} xs={1}/>\n          <Grid item md={12} xs={1}/>\n\n          <Grid item md={1} xs={1}/>\n          <Grid item md={10} xs={12}>\n             <EditConfigContainer/>\n          </Grid>\n          <Grid item md={1} xs={1}/>\n        </Grid>\n    )\n}\n\nexport default EditConfig;\n\n","import React from \"react\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport { MuiThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Snackbar from '@material-ui/core/Snackbar';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport TactileButtonNotification from \"./components/TactileButtonNotification\";\nimport ExperimentOverview from \"./ExperimentOverview\";\nimport DownloadData from \"./DownloadData\";\nimport Pioreactors from \"./Pioreactors\";\nimport StartNewExperiment from \"./StartNewExperiment\";\nimport EditConfig from \"./EditConfig\";\n\nimport \"fontsource-roboto/300-normal.css\"\nimport \"fontsource-roboto/400-normal.css\"\nimport \"fontsource-roboto/500-normal.css\"\nimport \"fontsource-roboto/700-normal.css\"\nimport './styles.css';\nimport {parseINIString} from \"./utilities\"\n\n\nconst theme = createMuiTheme({\n  palette: {\n    background: {\n      default: \"#f6f6f7\",\n    },\n    primary: {\n      // light: will be calculated from palette.primary.main,\n      main: '#5331CA',\n      // dark: will be calculated from palette.primary.main,\n      // contrastText: will be calculated to contrast with palette.primary.main\n    },\n  },\n});\n\n\n\nfunction App() {\n\n  const [config, setConfig] = React.useState({})\n\n  React.useEffect(() => {\n\n    async function getConfig() {\n      await fetch(\"/get_config/config.ini\")\n        .then((response) => {\n            if (response.ok) {\n              return response.text();\n            } else {\n              throw new Error('Something went wrong');\n            }\n          })\n        .then((config) => {\n          setConfig(parseINIString(config)); // TODO: parse on server side and send a json object\n        })\n        .catch((error) => {})\n    }\n    getConfig();\n  }, [])\n\n  return (\n    <MuiThemeProvider theme={theme}>\n      <CssBaseline />\n      <Router>\n        <div className=\"pageContainer\">\n          <Switch>\n            <Route path=\"/download-data\">\n              <DownloadData config={config}/>\n              <TactileButtonNotification config={config}/>\n            </Route>\n            <Route path=\"/start-new-experiment\">\n              <StartNewExperiment config={config}/>\n              <TactileButtonNotification config={config}/>\n            </Route>\n            <Route path=\"/overview\">\n              <ExperimentOverview config={config}/>\n            </Route>\n            <Route path=\"/edit-config\">\n              <EditConfig config={config}/>\n              <TactileButtonNotification config={config}/>\n            </Route>\n            <Route path=\"/pioreactors\">\n              <Pioreactors config={config}/>\n            </Route>\n            <Route path=\"/\">\n              <ExperimentOverview config={config}/>\n            </Route>\n          </Switch>\n        </div>\n      </Router>\n    </MuiThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport \"./styles.css\";\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}